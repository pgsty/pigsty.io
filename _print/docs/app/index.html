<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><link rel=canonical type=text/html href=https://pigsty.io/docs/app/><link rel=alternate type=application/rss+xml href=https://pigsty.io/docs/app/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Applications | PIGSTY</title><meta name=description content="Software and tools that use PostgreSQL can be managed by the docker daemon"><meta property="og:url" content="https://pigsty.io/docs/app/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="Applications"><meta property="og:description" content="Software and tools that use PostgreSQL can be managed by the docker daemon"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Applications"><meta itemprop=description content="Software and tools that use PostgreSQL can be managed by the docker daemon"><meta itemprop=dateModified content="2026-01-15T00:52:33+08:00"><meta itemprop=wordCount content="407"><meta itemprop=keywords content="Reference,APP"><meta name=twitter:card content="summary"><meta name=twitter:title content="Applications"><meta name=twitter:description content="Software and tools that use PostgreSQL can be managed by the docker daemon"><link rel=preload href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css as=style integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><link href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css rel=stylesheet integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Ver</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.cc>Pigsty 中文网站</a></li><li><a class=dropdown-item href=https://doc.pgsty.com>Pigsty v3.7 Doc</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc>Pigsty v3.4 Doc</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 Doc</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 Doc</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch Language / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d757e151050fd40088751a74721d74f6.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:window.location.href="https://pigsty.cc"+e}</script></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/app/>Return to the regular view of this page</a>.</p></div><h1 class=title>Applications</h1><div class=lead>Software and tools that use PostgreSQL can be managed by the docker daemon</div><ul><li>1: <a href=#pg-dfa04ac62d43a7cc96541f47a4cc9d99>Enterprise Self-Hosted Supabase</a></li><li>2: <a href=#pg-1e18b4f399056e4a9b1713040a804b17>Odoo: Self-Hosted Open Source ERP</a></li><li>3: <a href=#pg-cc85a499c2128f8ef2658df26b2566ad>Dify: AI Workflow Platform</a></li><li>4: <a href=#pg-de0128bd4345697963d59e764c35c90b>Enterprise Software</a></li><li>5: <a href=#pg-b94f778cc05c5fe2e52f126f032753e9>NocoDB: Open-Source Airtable</a></li><li>6: <a href=#pg-a24f4293fdd8dcc354ecc1a0fe74f7da>Teable: AI No-Code Database</a></li><li>7: <a href=#pg-e4d7871bc5c532d89a4e76a28e49ee3b>Gitea: Simple Self-Hosting Git Service</a></li><li>8: <a href=#pg-ab8b5d6530871db26391dfb780764601>Wiki.js: OSS Wiki Software</a></li><li>9: <a href=#pg-b2e9576ebd029b6f66db394de58e3112>Mattermost: Open-Source IM</a></li><li>10: <a href=#pg-b3e8ff513ff4c90114324ee5b19b8015>Maybe: Personal Finance</a></li><li>11: <a href=#pg-170acad42811859443cc55f9cd346b6f>Metabase: BI Analytics Tool</a></li><li>12: <a href=#pg-2226656b7bf317b375be85683acc8130>Kong: the Nginx API Gateway</a></li><li>13: <a href=#pg-fc62b9aad0217ff4dadd76e1e15633b6>Registry: Container Image Mirror</a></li><li>14: <a href=#pg-fa3dc992b76e9f32c26faddd8dccdb15>Database Tools</a></li><li>15: <a href=#pg-9ab8e0a1cc0dd81586d666399930c331>ByteBase: PG Schema Migration</a></li><li>16: <a href=#pg-8736e7e24609593e38bb4af51eacec86>PGAdmin4: PG Admin GUI Tool</a></li><li>17: <a href=#pg-fbdf33ca77e7696092991f27dcf86e32>PGWeb: Browser-based PG Client</a></li><li>18: <a href=#pg-0e8785a96f30f0e01c2bfd365fb63b5a>PostgREST: Generate REST API from Schema</a></li><li>19: <a href=#pg-fa5656811a158b156712d00725b47fea>Electric: PGLite Sync Engine</a></li><li>20: <a href=#pg-34724279579b562c276e6051f843c660>Jupyter: AI Notebook & IDE</a></li><li>21: <a href=#pg-b3405ffde24b58619b4d32980b9155a0>Data Applications</a></li><li>22: <a href=#pg-af33a915aa5ea40ca1b93854fbd8da8e>PGLOG: PostgreSQL Log Analysis Application</a></li><li>23: <a href=#pg-3bf0cdc122adbb3c6315d77456eb4a70>NOAA ISD Global Weather Station Historical Data Query</a></li><li>24: <a href=#pg-f2f527c6f73d059e66947f8c86fd4b49>WHO COVID-19 Pandemic Dashboard</a></li><li>25: <a href=#pg-41257227641757f696b35683a37345dd>StackOverflow Global Developer Survey</a></li><li>26: <a href=#pg-71c4afe134c6d0768ee52d9ca11f5242>DB-Engines Database Popularity Trend Analysis</a></li><li>27: <a href=#pg-90bea0e09fc3821f240f24c4f991c6a8>AWS & Aliyun Server Pricing</a></li></ul><div class=content><p>PostgreSQL is the most popular database in the world, and countless software is built on PostgreSQL, around PostgreSQL, or serves PostgreSQL itself, such as</p><ul><li>&ldquo;<strong>Application software</strong>&rdquo; that uses PostgreSQL as the preferred database</li><li>&ldquo;<strong>Tooling software</strong>&rdquo; that serves PostgreSQL software development and management</li><li>&ldquo;<strong>Database software</strong>&rdquo; that derives, wraps, forks, modifies, or extends PostgreSQL</li></ul><p>And Pigsty just have a series of Docker Compose templates for these software, application and databases:</p><table><thead><tr><th style=text-align:center>Name</th><th style=text-align:center>Website</th><th style=text-align:center>Type</th><th style=text-align:center>State</th><th style=text-align:center>Port</th><th>Domain</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center><a href=/docs/pgsql/kernel/supabase><strong>Supabase</strong></a></td><td style=text-align:center><a href=https://supabase.com/>Supabase</a></td><td style=text-align:center>DB</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8000</td><td>supa.pigsty</td><td style=text-align:left>OSS Firebase Alternative, Backend as Platform</td></tr><tr><td style=text-align:center>PolarDB</td><td style=text-align:center><a href=https://github.com/ApsaraDB/PolarDB-for-PostgreSQL>PolarDB</a></td><td style=text-align:center>DB</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>5532</td><td></td><td style=text-align:left>OSS RAC for PostgreSQL</td></tr><tr><td style=text-align:center>FerretDB</td><td style=text-align:center><a href=https://www.ferretdb.com/>FerretDB</a></td><td style=text-align:center>DB</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>27017</td><td></td><td style=text-align:left>OSS Mongo Alternative base on PostgreSQL</td></tr><tr><td style=text-align:center><a href=minio><strong>MinIO</strong></a></td><td style=text-align:center><a href=https://min.io/>MinIO</a></td><td style=text-align:center>DB</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>9000</td><td>sss.pigsty</td><td style=text-align:left>OSS AWS S3 Alternative, Simple Storage Service</td></tr><tr><td style=text-align:center>EdgeDB</td><td style=text-align:center><a href=https://www.edgedb.com/>EdgeDB</a></td><td style=text-align:center>DB</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS Graph Database base on PostgreSQL</td></tr><tr><td style=text-align:center>NocoDB</td><td style=text-align:center><a href=https://nocodb.com/>NocoDB</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8080</td><td>noco.pigsty</td><td style=text-align:left>OSS Airtable Alternative over PostgreSQL</td></tr><tr><td style=text-align:center><a href=odoo><strong>Odoo</strong></a></td><td style=text-align:center><a href=https://www.odoo.com/>Odoo</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8069</td><td>odoo.pigsty</td><td style=text-align:left>OSS ERP Software base on PostgreSQL</td></tr><tr><td style=text-align:center><a href=dify><strong>Dify</strong></a></td><td style=text-align:center><a href=https://dify.ai/zh>Dify</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8001</td><td>dify.pigsty</td><td style=text-align:left>OSS AI Workflow Orachestration & LLMOps Platform</td></tr><tr><td style=text-align:center><a href=jupyter><strong>Jupyter</strong></a></td><td style=text-align:center><a href=https://jupyter.org/>Jupyter</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center></td><td>lab.pigsty</td><td style=text-align:left>OSS AI Python Notebook & Data Analysis IDE</td></tr><tr><td style=text-align:center><a href=gitea><strong>Gitea</strong></a></td><td style=text-align:center><a href=https://gitea.com/>Gitea</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8889</td><td>git.pigsty</td><td style=text-align:left>OSS DevOps Git Service</td></tr><tr><td style=text-align:center><a href=wiki><strong>Wiki</strong></a></td><td style=text-align:center><a href=https://js.wiki/>Wiki.js</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>9002</td><td>wiki.pigsty</td><td style=text-align:left>OSS Wiki Software</td></tr><tr><td style=text-align:center>GitLab</td><td style=text-align:center><a href=https://gitlab.com/>GitLab</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS GitHub Alternative, Code Management Platform</td></tr><tr><td style=text-align:center>Mastodon</td><td style=text-align:center><a href=https://joinmastodon.org/>Mastodon</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS Decentralized Social Network</td></tr><tr><td style=text-align:center>Keycloak</td><td style=text-align:center><a href=https://www.keycloak.org/>Keycloak</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS Identity & Access Management Component</td></tr><tr><td style=text-align:center>Harbour</td><td style=text-align:center><a href=https://goharbor.io/>Harbour</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS Docker/K8S Image Repository</td></tr><tr><td style=text-align:center>Confluence</td><td style=text-align:center><a href=https://www.atlassian.com/software/confluence>Confluence</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>Enterprise Knowledge Management System</td></tr><tr><td style=text-align:center>Jira</td><td style=text-align:center><a href=https://www.atlassian.com/software/jira>Jira</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>Enterprise Project Management Tools</td></tr><tr><td style=text-align:center>Zabbix</td><td style=text-align:center><a href=https://www.zabbix.com/>Zabbix 7</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>OSS Monitoring Platform for Enterprise</td></tr><tr><td style=text-align:center>Grafana</td><td style=text-align:center><a href=https://grafana.com/>Grafana</a></td><td style=text-align:center>APP</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>Dashboard, Data Visualization & Monitoring Platform</td></tr><tr><td style=text-align:center>Metabase</td><td style=text-align:center><a href=https://www.metabase.com/>Metabase</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>9004</td><td>mtbs.pigsty</td><td style=text-align:left>Fast analysis of data from multiple data sources</td></tr><tr><td style=text-align:center>ByteBase</td><td style=text-align:center><a href=https://www.bytebase.com/>ByteBase</a></td><td style=text-align:center>APP</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8887</td><td>ddl.pigsty</td><td style=text-align:left>Database Migration Tool for PostgreSQL</td></tr><tr><td style=text-align:center><a href=kong><strong>Kong</strong></a></td><td style=text-align:center><a href=https://konghq.com/>Kong</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8000</td><td>api.pigsty</td><td style=text-align:left>OSS API Gateway based on Nginx/OpenResty</td></tr><tr><td style=text-align:center><a href=postgrest><strong>PostgREST</strong></a></td><td style=text-align:center><a href=https://postgrest.org/>PostgREST</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8884</td><td>api.pigsty</td><td style=text-align:left>Generate RESTAPI from PostgreSQL Schemas</td></tr><tr><td style=text-align:center><a href=pgadmin><strong>pgAdmin4</strong></a></td><td style=text-align:center><a href=https://www.pgadmin.org/>pgAdmin4</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8885</td><td>adm.pigsty</td><td style=text-align:left>PostgreSQL GUI Admin Tools</td></tr><tr><td style=text-align:center><a href=pgweb><strong>pgWeb</strong></a></td><td style=text-align:center><a href="https://github.com/sosedoff/pgweb?tab=readme-ov-file">pgWeb</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>8886</td><td>cli.pigsty</td><td style=text-align:left>PostgreSQL Web GUI Client</td></tr><tr><td style=text-align:center>SchemaSpy</td><td style=text-align:center><a href=https://schemaspy.org/>SchemaSpy</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>Dump & Visualize PostgreSQL Schema</td></tr><tr><td style=text-align:center>pgBadger</td><td style=text-align:center><a href=https://github.com/darold/pgbadger>pgBadger</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><em>TBD</em></td><td style=text-align:center></td><td></td><td style=text-align:left>PostgreSQL Log Analysis</td></tr><tr><td style=text-align:center>pg_exporter</td><td style=text-align:center><a href=https://github.com/pgsty/pg_exporter>pg_exporter</a></td><td style=text-align:center>TOOL</td><td style=text-align:center><strong>GA</strong></td><td style=text-align:center>9630</td><td></td><td style=text-align:left>Expose PostgreSQL & Pgbouncer Metrics for Prometheus</td></tr></tbody></table><div class="alert alert-success" role=alert><div class="h4 alert-heading" role=heading>How to prepare Docker?</div><p>To run docker compose templates, you need to install the <a href=/docs/docker><strong><code>DOCKER</code></strong></a> module on the <a href=/docs/node#common-node><strong>node</strong></a>,
If you don&rsquo;t have the Internet access or having firewall issues, you may need to configure a DockerHub proxy, check the <a href=/docs/docker/><strong>tutorial</strong></a>.</p></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-dfa04ac62d43a7cc96541f47a4cc9d99>1 - Enterprise Self-Hosted Supabase</h1><div class=lead>Self-host enterprise-grade Supabase with Pigsty, featuring monitoring, high availability, PITR, IaC, and 440+ PostgreSQL extensions.</div><p>Supabase is great, but having your own Supabase is even better.
Pigsty can help you deploy enterprise-grade Supabase on your own servers (physical, virtual, or cloud) with a single command — more extensions, better performance, deeper control, and more cost-effective.</p><blockquote><p>Pigsty is one of three self-hosting approaches listed on the Supabase official documentation: <a href=https://supabase.com/docs/guides/self-hosting#third-party-guides>Self-hosting: Third-Party Guides</a></p></blockquote><p>This tutorial requires basic Linux knowledge. Otherwise, consider using Supabase cloud or plain Docker Compose self-hosting.</p><hr><h2 id=tldr>TL;DR</h2><p><a href=/docs/deploy/prepare>Prepare</a> a <a href=/docs/deploy/prepare><strong>Linux server</strong></a>, follow the Pigsty <a href=/docs/setup/install><strong>standard single-node installation</strong></a> process with the <code>supabase</code> config template:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./configure -c supabase    <span style=color:#8f5902;font-style:italic># Use supabase config (change credentials in pigsty.yml)</span>
</span></span><span style=display:flex><span>vi pigsty.yml              <span style=color:#8f5902;font-style:italic># Edit domain, passwords, keys...</span>
</span></span><span style=display:flex><span>./deploy.yml               <span style=color:#8f5902;font-style:italic># Standard single-node Pigsty deployment</span>
</span></span><span style=display:flex><span>./docker.yml               <span style=color:#8f5902;font-style:italic># Install Docker module</span>
</span></span><span style=display:flex><span>./app.yml                  <span style=color:#8f5902;font-style:italic># Start Supabase stateless components (may be slow)</span>
</span></span></code></pre></div><p>After installation, access Supa Studio on port <code>8000</code> with username <code>supabase</code> and password <code>pigsty</code>.</p><p><img src=/img/pigsty/supabase.webp alt></p><div id=asciinema-913fe6b5e34ef94a5d10a82176a4fd69 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-913fe6b5e34ef94a5d10a82176a4fd69",o="/demo/supabase.cast",e="solarized-light",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[0,"Check"],[11,"Install"],[43,"Config"],[307,"Docker"],[321,"Domain"],[340,"App"],[350,"Verify"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=checklist>Checklist</h2><ul><li><input disabled type=checkbox> At least one 1C2G server</li><li><input disabled type=checkbox> Static internal IPv4 address</li><li><input disabled type=checkbox> <a href=/docs/ref/linux><strong>Supported Linux distro</strong></a> installed</li><li><input disabled type=checkbox> <a href=/docs/setup/install><strong>Standard Pigsty installation</strong></a></li><li><input disabled type=checkbox> Modified config file: domain, passwords, IP address</li><li><input disabled type=checkbox> <a href=/docs/docker><strong>Docker module installed</strong></a>, ensure proxy/mirror available</li><li><input disabled type=checkbox> Use Pigsty&rsquo;s <a href=/docs/docker/playbook><code>app.yml</code></a> to start Supabase</li></ul><hr><h2 id=table-of-contents>Table of Contents</h2><ul><li><a href=#what-is-supabase>What is Supabase?</a></li><li><a href=#why-self-host>Why Self-Host?</a></li><li><a href=#single-node-quick-start>Single-Node Quick Start</a></li><li><a href=#advanced-security-hardening>Advanced: Security Hardening</a></li><li><a href=#advanced-domain-configuration>Advanced: Domain Configuration</a></li><li><a href=#advanced-external-object-storage>Advanced: External Object Storage</a></li><li><a href=#advanced-using-smtp>Advanced: Using SMTP</a></li><li><a href=#advanced-true-high-availability>Advanced: True High Availability</a></li></ul><hr><h2 id=what-is-supabase>What is Supabase?</h2><p><a href=https://supabase.com/>Supabase</a> is a BaaS (Backend as a Service), an open-source Firebase alternative, and the most popular database + backend solution in the AI Agent era.
Supabase wraps PostgreSQL and provides authentication, messaging, edge functions, object storage, and automatically generates REST and GraphQL APIs based on your database schema.</p><p>Supabase aims to provide developers with a one-stop backend solution, reducing the complexity of developing and maintaining backend infrastructure.
It allows developers to skip most backend development work — <strong>you only need to understand database design and frontend to ship quickly!</strong>
Developers can use vibe coding to create a frontend and database schema to rapidly build complete applications.</p><p>Currently, Supabase is the most popular open-source project in the <a href=https://ossrank.com/cat/368-postgresql-ecosystem>PostgreSQL ecosystem</a>, with over <a href=https://github.com/supabase/supabase/>90,000</a> GitHub stars.
Supabase also offers a &ldquo;generous&rdquo; free tier for small startups — free 500 MB storage, more than enough for storing user tables and analytics data.</p><hr><h2 id=why-self-host>Why Self-Host?</h2><p>If Supabase cloud is so attractive, why self-host?</p><p>The most obvious reason is what we discussed in &ldquo;<a href=https://vonng.com/cloud/rds/>Is Cloud Database an IQ Tax?</a>&rdquo;: when your data/compute scale exceeds the cloud computing sweet spot (Supabase: 4C/8G/500MB free storage), costs can explode.
And nowadays, reliable <a href=https://vonng.com/cloud/bonus/>local enterprise NVMe SSDs</a> have three to four orders of magnitude cost advantage over <a href=https://vonng.com/cloud/ebs/>cloud storage</a>, and self-hosting can better leverage this.</p><p>Another important reason is <strong>functionality</strong> — Supabase cloud features are limited. Many powerful PostgreSQL extensions aren&rsquo;t available in cloud services due to multi-tenant security challenges and licensing.
Despite <a href=https://vonng.com/pg/pg-eat-db-world>extensions being PostgreSQL&rsquo;s core feature</a>, only <strong>64</strong> extensions are available on Supabase cloud.
Self-hosted Supabase with Pigsty provides up to <a href=https://pgext.cloud/list><strong>440</strong></a> ready-to-use PostgreSQL extensions.</p><p>Additionally, self-control and vendor lock-in avoidance are important reasons for self-hosting. Although Supabase aims to provide a vendor-lock-free open-source Google Firebase alternative, self-hosting enterprise-grade Supabase is not trivial.
Supabase includes a series of PostgreSQL extensions they develop and maintain, and plans to replace the native PostgreSQL kernel with <a href=/docs/pgsql/kernel/orioledb><strong>OrioleDB</strong></a> (which they acquired). These kernels and extensions are not available in the official PGDG repository.</p><p>This is implicit vendor lock-in, preventing users from self-hosting in ways other than the supabase/postgres Docker image. Pigsty provides an open, transparent, and universal solution.
We package all 10 missing Supabase extensions into ready-to-use RPM/DEB packages, ensuring they work on all <a href=/docs/ref/linux>major Linux distributions</a>:</p><table><thead><tr><th>Extension</th><th>Description</th></tr></thead><tbody><tr><td><a href=https://pgext.cloud/e/pg_graphql/><code>pg_graphql</code></a></td><td>GraphQL support in PostgreSQL (Rust), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/pg_jsonschema/><code>pg_jsonschema</code></a></td><td>JSON Schema validation (Rust), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/wrappers/><code>wrappers</code></a></td><td>Supabase foreign data wrapper bundle (Rust), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/index_advisor/><code>index_advisor</code></a></td><td>Query index advisor (SQL), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/pg_net/><code>pg_net</code></a></td><td>Async non-blocking HTTP/HTTPS requests (C), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/supabase_vault/><code>vault</code></a></td><td>Store encrypted credentials in Vault (C), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/pgjwt/><code>pgjwt</code></a></td><td>JSON Web Token API implementation (SQL), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/pgsodium/><code>pgsodium</code></a></td><td>Table data encryption TDE, provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/supautils/><code>supautils</code></a></td><td>Security utilities for cloud environments (C), provided by PIGSTY</td></tr><tr><td><a href=https://pgext.cloud/e/plan_filter/><code>pg_plan_filter</code></a></td><td>Filter queries by execution plan cost (C), provided by PIGSTY</td></tr></tbody></table><p>We also <a href=/docs/pgsql/ext/install>install</a> most extensions by default in Supabase deployments. You can <a href=/docs/pgsql/ext/create>enable</a> them as needed.</p><p>Pigsty also handles the underlying <a href=/docs/concept/ha/>highly available</a> <a href=/docs/pgsql/>PostgreSQL</a> cluster, highly available <a href=/docs/minio/>MinIO</a> object storage cluster, and even <a href=/docs/docker/>Docker</a> deployment, <a href=/docs/infra/admin/portal>Nginx</a> reverse proxy, <a href=/docs/infra/admin/domain>domain configuration</a>, and <a href=/docs/infra/admin/cert>HTTPS certificate issuance</a>. You can spin up any number of stateless Supabase container clusters using Docker Compose and store state in external Pigsty-managed database services.</p><p>With this self-hosted architecture, you gain the freedom to use different kernels (PG 15-18, OrioleDB), install <a href=https://pgext.cloud/list/><strong>437</strong></a> extensions, scale Supabase/Postgres/MinIO, freedom from database operations, and freedom from vendor lock-in — running locally forever. Compared to cloud service costs, you only need to prepare servers and run a few commands.</p><hr><h2 id=single-node-quick-start>Single-Node Quick Start</h2><p>Let&rsquo;s start with single-node Supabase deployment. We&rsquo;ll cover multi-node high availability later.</p><p><a href=/docs/deploy/prepare>Prepare</a> a fresh <a href=/docs/deploy/prepare>Linux server</a>, use the Pigsty <a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml><code>supabase</code></a> configuration template for <a href=/docs/setup/install>standard installation</a>,
then run <a href=/docs/docker/playbook#dockeryml><code>docker.yml</code></a> and <code>app.yml</code> to start stateless Supabase containers (default ports <code>8000</code>/<code>8433</code>).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./configure -c supabase    <span style=color:#8f5902;font-style:italic># Use supabase config (change credentials in pigsty.yml)</span>
</span></span><span style=display:flex><span>vi pigsty.yml              <span style=color:#8f5902;font-style:italic># Edit domain, passwords, keys...</span>
</span></span><span style=display:flex><span>./deploy.yml               <span style=color:#8f5902;font-style:italic># Install Pigsty</span>
</span></span><span style=display:flex><span>./docker.yml               <span style=color:#8f5902;font-style:italic># Install Docker module</span>
</span></span><span style=display:flex><span>./app.yml                  <span style=color:#8f5902;font-style:italic># Start Supabase stateless components with Docker</span>
</span></span></code></pre></div><p>Before deploying Supabase, modify the auto-generated <code>pigsty.yml</code> configuration file (domain and passwords) according to your needs.
For local development/testing, you can skip this and customize later.</p><p>If configured correctly, after about ten minutes, you can access the Supabase Studio GUI at <code>http://&lt;your_ip_address>:8000</code> on your local network.
Default username and password are <code>supabase</code> and <code>pigsty</code>.</p><p><img src=/img/docs/supabase-home.png alt></p><p><strong>Notes:</strong></p><ul><li>In mainland China, Pigsty uses 1Panel and 1ms DockerHub mirrors by default, which may be slow.</li><li>You can configure your own <a href=/docs/docker/usage#proxy>proxy</a> and <a href=/docs/docker/usage#registry-mirror>registry mirror</a>, then manually pull images with <code>cd /opt/supabase; docker compose pull</code>. We also offer expert consulting services including complete offline installation packages.</li><li>If you need object storage functionality, you must access Supabase via domain and HTTPS, otherwise errors will occur.</li><li>For serious production deployments, <strong>always</strong> change all default passwords!</li></ul><hr><h2 id=key-technical-decisions>Key Technical Decisions</h2><p>Here are some key technical decisions for self-hosting Supabase:</p><p><strong>Single-node deployment</strong> doesn&rsquo;t provide PostgreSQL/MinIO high availability.
However, single-node deployment still has significant advantages over the official pure Docker Compose approach: out-of-the-box monitoring, freedom to install extensions, component scaling capabilities, and point-in-time recovery as a safety net.</p><p>If you only have one server or choose to self-host on cloud servers, Pigsty recommends using external S3 instead of local MinIO for object storage to hold PostgreSQL backups and Supabase Storage.
This deployment provides a minimum safety net RTO (hour-level recovery time) / RPO (MB-level data loss) disaster recovery in single-node conditions.</p><p>For serious production deployments, Pigsty recommends at least 3-4 nodes, ensuring both MinIO and PostgreSQL use enterprise-grade multi-node high availability deployments.
You&rsquo;ll need more nodes and disks, adjusting cluster configuration in <code>pigsty.yml</code> and Supabase cluster configuration to use high availability endpoints.</p><p>Some Supabase features require sending emails, so SMTP service is needed. Unless purely for internal use, production deployments should use SMTP cloud services. Self-hosted mail servers&rsquo; emails are often marked as spam.</p><p>If your service is directly exposed to the public internet, we strongly recommend using real domain names and HTTPS certificates via <a href=/docs/infra/admin/portal>Nginx Portal</a>.</p><p>Next, we&rsquo;ll discuss advanced topics for improving Supabase security, availability, and performance beyond single-node deployment.</p><hr><h2 id=advanced-security-hardening>Advanced: Security Hardening</h2><p><strong>Pigsty Components</strong></p><p>For serious production deployments, we strongly recommend changing Pigsty component passwords. These defaults are public and well-known — going to production without changing passwords is like running naked:</p><ul><li><a href=/docs/infra/param/#grafana_admin_password><code>grafana_admin_password</code></a>: <code>pigsty</code>, Grafana admin password</li><li><a href=/docs/pgsql/param/#pg_admin_password><code>pg_admin_password</code></a>: <code>DBUser.DBA</code>, PostgreSQL superuser password</li><li><a href=/docs/pgsql/param/#pg_monitor_password><code>pg_monitor_password</code></a>: <code>DBUser.Monitor</code>, PostgreSQL monitoring user password</li><li><a href=/docs/pgsql/param/#pg_replication_password><code>pg_replication_password</code></a>: <code>DBUser.Replicator</code>, PostgreSQL replication user password</li><li><a href=/docs/pgsql/param/#patroni_password><code>patroni_password</code></a>: <code>Patroni.API</code>, Patroni HA component password</li><li><a href=/docs/node/param/#haproxy_admin_password><code>haproxy_admin_password</code></a>: <code>pigsty</code>, Load balancer admin password</li><li><a href=/docs/minio/param/#minio_secret_key><code>minio_secret_key</code></a>: <code>S3User.MinIO</code>, MinIO root user secret</li><li><a href=/docs/etcd/param/#etcd_root_password><code>etcd_root_password</code></a>: <code>Etcd.Root</code>, ETCD root user password</li><li>Additionally, strongly recommend changing the <a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L72>PostgreSQL business user</a> password for Supabase, default is <code>DBUser.Supa</code></li></ul><p>These are Pigsty component passwords. Strongly recommended to set before installation.</p><p><strong>Supabase Keys</strong></p><p>Besides Pigsty component passwords, you need to <a href=https://supabase.com/docs/guides/self-hosting/docker#securing-your-services>change Supabase keys</a>, including:</p><ul><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L135><code>JWT_SECRET</code></a>: JWT signing key, at least 32 characters</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L136><code>ANON_KEY</code></a>: Anonymous user JWT credential</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L137><code>SERVICE_ROLE_KEY</code></a>: Service role JWT credential</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L138><code>PG_META_CRYPTO_KEY</code></a>: PostgreSQL Meta service encryption key, at least 32 characters</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L140><code>DASHBOARD_USERNAME</code></a>: Supabase Studio web UI default username, default <code>supabase</code></li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L141><code>DASHBOARD_PASSWORD</code></a>: Supabase Studio web UI default password, default <code>pigsty</code></li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L144><code>LOGFLARE_PUBLIC_ACCESS_TOKEN</code></a>: Logflare public access token, 32-64 random characters</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L145><code>LOGFLARE_PRIVATE_ACCESS_TOKEN</code></a>: Logflare private access token, 32-64 random characters</li></ul><p>Please follow the <a href=https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys>Supabase tutorial: Securing your services</a>:</p><ul><li>Generate a <code>JWT_SECRET</code> with at least 40 characters, then use the tutorial tools to issue <code>ANON_KEY</code> and <code>SERVICE_ROLE_KEY</code> JWTs.</li><li>Use the tutorial tools to generate an <code>ANON_KEY</code> JWT based on <code>JWT_SECRET</code> and expiration time — this is the anonymous user credential.</li><li>Use the tutorial tools to generate a <code>SERVICE_ROLE_KEY</code> — this is the higher-privilege service role credential.</li><li>Specify a random string of at least 32 characters for <code>PG_META_CRYPTO_KEY</code> to encrypt Studio UI and meta service interactions.</li><li>If using different PostgreSQL business user passwords, modify <a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L144><code>POSTGRES_PASSWORD</code></a> accordingly.</li><li>If your object storage uses different passwords, modify <a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L154><code>S3_ACCESS_KEY</code></a> and <a href=https://github.com/pgsty/pigsty/blob/main/conf/supabase.yml#L155><code>S3_SECRET_KEY</code></a> accordingly.</li></ul><p>After modifying Supabase credentials, restart Docker Compose to apply:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./app.yml -t app_config,app_launch   <span style=color:#8f5902;font-style:italic># Using playbook</span>
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /opt/supabase<span style=color:#000;font-weight:700>;</span> make up            <span style=color:#8f5902;font-style:italic># Manual execution</span>
</span></span></code></pre></div><hr><h2 id=advanced-domain-configuration>Advanced: Domain Configuration</h2><p>If using Supabase locally or on LAN, you can directly connect to Kong&rsquo;s HTTP port 8000 via IP:Port.</p><p>You can use an internal static-resolved domain, but for serious production deployments, we recommend using a real domain + HTTPS to access Supabase.
In this case, your server should have a public IP, you should own a domain, use cloud/DNS/CDN provider&rsquo;s DNS resolution to point to the node&rsquo;s public IP (optional fallback: local <code>/etc/hosts</code> static resolution).</p><p>The simple approach is to batch-replace the placeholder domain (<code>supa.pigsty</code>) with your actual domain, e.g., <code>supa.pigsty.cc</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -ie <span style=color:#4e9a06>&#39;s/supa.pigsty/supa.pigsty.cc/g&#39;</span> ~/pigsty/pigsty.yml
</span></span></code></pre></div><p>If not configured beforehand, reload Nginx and Supabase configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make cert       <span style=color:#8f5902;font-style:italic># Request certbot free HTTPS certificate</span>
</span></span><span style=display:flex><span>./app.yml       <span style=color:#8f5902;font-style:italic># Reload Supabase configuration</span>
</span></span></code></pre></div><p>The modified configuration should look like:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>certbot_sign</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># Use certbot to sign real certificates</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>i.pigsty.cc              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with your domain!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>supa</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>supa.pigsty.cc       </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with your domain!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:8000&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>certbot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>supa.pigsty.cc      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Certificate name, usually same as domain</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>supabase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>apps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>supabase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                                         </span><span style=color:#8f5902;font-style:italic># Supabase app definition</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                                           </span><span style=color:#8f5902;font-style:italic># Override /opt/supabase/.env</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SITE_URL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://supa.pigsty.cc             </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;------- Change to your external domain name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>API_EXTERNAL_URL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://supa.pigsty.cc     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;------- Otherwise the storage API may not work!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SUPABASE_PUBLIC_URL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://supa.pigsty.cc  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;------- Don&#39;t forget to set this in infra_portal!</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>For complete domain/HTTPS configuration, see <a href=/docs/infra/admin/cert>Certificate Management</a>. You can also use Pigsty&rsquo;s built-in local static resolution and self-signed HTTPS certificates as fallback.</p><hr><h2 id=advanced-external-object-storage>Advanced: External Object Storage</h2><p>You can use S3 or S3-compatible services for PostgreSQL backups and Supabase object storage. Here we use Alibaba Cloud OSS as an example.</p><blockquote><p>Pigsty provides a <a href=https://github.com/pgsty/pigsty/blob/main/terraform/spec/aliyun-s3.tf><code>terraform/spec/aliyun-s3.tf</code></a> template for provisioning a server and OSS bucket on Alibaba Cloud.</p></blockquote><p>First, modify the S3 configuration in <code>all.children.supa.vars.apps.[supabase].conf</code> to point to Alibaba Cloud OSS:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># if using s3/minio as file storage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_BUCKET</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>data                      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_ENDPOINT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://sss.pigsty:9000 </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_ACCESS_KEY</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>s3user_data           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_SECRET_KEY</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.Data           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_FORCE_PATH_STYLE</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_REGION</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>stub                      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>S3_PROTOCOL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with S3-compatible service info</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Reload Supabase configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./app.yml -t app_config,app_launch
</span></span></code></pre></div><p>You can also use S3 as PostgreSQL backup repository. Add an <code>aliyun</code> backup repository definition in <code>all.vars.pgbackrest_repo</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pgbackrest_method: aliyun          # pgbackrest backup method</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>local,minio,[user-defined repos...]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pgbackrest_repo:                   # pgbackrest backup repo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://pgbackrest.org/configuration.html#section-repository</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>aliyun</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                          </span><span style=color:#8f5902;font-style:italic># Define new backup repo &#39;aliyun&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>s3                      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Alibaba Cloud OSS is S3-compatible</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oss-cn-beijing-internal.aliyuncs.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oss-cn-beijing</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_bucket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty-oss</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>xxxxxxxxxxxxxx</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_key_secret</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>xxxxxxxx</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>s3_uri_style</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>host</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/pgbackrest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>bundle</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>y</span><span style=color:#f8f8f8>                         </span><span style=color:#8f5902;font-style:italic># bundle small files into a single file</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>bundle_limit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>20MiB              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Limit for file bundles, 20MiB for object storage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>bundle_size</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>128MiB              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Target size for file bundles, 128MiB for object storage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>cipher_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>aes-256-cbc         </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># enable AES encryption for remote backup repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>cipher_pass</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgBackRest.MyPass   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Set encryption password for pgBackRest backup repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>retention_full_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>time        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># retention full backup by time on minio repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>retention_full</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>14</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># keep full backup for the last 14 days</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then specify <code>aliyun</code> backup repository in <code>all.vars.pgbackrest_method</code> and reset pgBackrest:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -t pgbackrest
</span></span></code></pre></div><p>Pigsty will switch the backup repository to external object storage. For more backup configuration, see <a href=/docs/pgsql/backup>PostgreSQL Backup</a>.</p><hr><h2 id=advanced-using-smtp>Advanced: Using SMTP</h2><p>You can use SMTP for sending emails. Modify the supabase app configuration with SMTP information:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>supabase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># supa group</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>          </span><span style=color:#8f5902;font-style:italic># supa group vars</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>apps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># supa group app list</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>supabase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># the supabase app</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># the supabase app conf entries</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_HOST</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>smtpdm.aliyun.com:80</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_USER</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>no_reply@mail.your.domain.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_PASS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>your_email_user_password</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_SENDER_NAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>MySupabase</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SMTP_ADMIN_EMAIL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>adminxxx@mail.your.domain.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ENABLE_ANONYMOUS_USERS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Don&rsquo;t forget to reload configuration with <code>app.yml</code>.</p><hr><h2 id=advanced-true-high-availability>Advanced: True High Availability</h2><p>After these configurations, you have enterprise-grade Supabase with public domain, HTTPS certificate, SMTP, PITR backup, monitoring, IaC, and 400+ extensions (basic single-node version).
For high availability configuration, see other Pigsty documentation. We offer expert consulting services for hands-on Supabase self-hosting — $400 USD to save you the hassle.</p><p>Single-node RTO/RPO relies on external object storage as a safety net. If your node fails, backups in external S3 storage let you redeploy Supabase on a new node and restore from backup.
This provides minimum safety net RTO (hour-level recovery) / RPO (MB-level data loss) <a href=/docs/pgsql/backup>disaster recovery</a>.</p><p>For RTO &lt; 30s with zero data loss on failover, use <a href=/docs/deploy/install>multi-node</a> high availability deployment:</p><ul><li><a href=/docs/etcd/>ETCD</a>: DCS needs three or more nodes to tolerate one node failure.</li><li><a href=/docs/pgsql/>PGSQL</a>: PostgreSQL synchronous commit (no data loss) mode recommends at least three nodes.</li><li><a href=/docs/infra/>INFRA</a>: Monitoring infrastructure failure has less impact; production recommends dual replicas.</li><li>Supabase stateless containers can also be multi-node replicas for high availability.</li></ul><p>In this case, you also need to modify PostgreSQL and MinIO endpoints to use DNS / L2 VIP / HAProxy <a href=/docs/pgsql/service#access>high availability endpoints</a>.
For these parts, follow the documentation for each Pigsty module.
Reference <a href=https://github.com/pgsty/pigsty/blob/main/conf/ha/trio.yml><code>conf/ha/trio.yml</code></a> and <a href=https://github.com/pgsty/pigsty/blob/main/conf/ha/trio.yml><code>conf/ha/safe.yml</code></a> for upgrading to three or more nodes.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1e18b4f399056e4a9b1713040a804b17>2 - Odoo: Self-Hosted Open Source ERP</h1><div class=lead>How to spin up an out-of-the-box enterprise application suite Odoo and use Pigsty to manage its backend PostgreSQL database.</div><p><a href=https://www.odoo.com/>Odoo</a> is an open-source enterprise resource planning (ERP) software that provides a full suite of business applications, including CRM, sales, purchasing, inventory, production, accounting, and other management functions. Odoo is a typical web application that uses PostgreSQL as its underlying database.</p><blockquote><p>All your business on one platform — Simple, efficient, yet affordable</p></blockquote><p>Public Demo (may not always be available): <a href=http://odoo.pigsty.io>http://odoo.pigsty.io</a>, username: <code>test@pigsty.io</code>, password: <code>pigsty</code></p><hr><h2 id=quick-start>Quick Start</h2><p>On a fresh Linux x86/ARM server running a compatible operating system:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./bootstrap                <span style=color:#8f5902;font-style:italic># Install Ansible</span>
</span></span><span style=display:flex><span>./configure -c app/odoo    <span style=color:#8f5902;font-style:italic># Use Odoo configuration (change credentials in pigsty.yml)</span>
</span></span><span style=display:flex><span>./deploy.yml               <span style=color:#8f5902;font-style:italic># Install Pigsty</span>
</span></span><span style=display:flex><span>./docker.yml               <span style=color:#8f5902;font-style:italic># Install Docker Compose</span>
</span></span><span style=display:flex><span>./app.yml                  <span style=color:#8f5902;font-style:italic># Start Odoo stateless components with Docker</span>
</span></span></code></pre></div><p>Odoo listens on port 8069 by default. Access <code>http://&lt;ip>:8069</code> in your browser. The default username and password are both <code>admin</code>.</p><p>You can add a DNS resolution record <code>odoo.pigsty</code> pointing to your server in the browser host&rsquo;s <code>/etc/hosts</code> file, allowing you to access the Odoo web interface via <code>http://odoo.pigsty</code>.</p><p>If you want to access Odoo via SSL/HTTPS, you need to use a real SSL certificate or trust the self-signed CA certificate automatically generated by Pigsty. (In Chrome, you can also type <code>thisisunsafe</code> to bypass certificate verification)</p><hr><h2 id=configuration-template>Configuration Template</h2><p><a href=https://github.com/pgsty/pigsty/blob/main/conf/app/odoo.yml><code>conf/app/odoo.yml</code></a> defines a template configuration file containing the resources required for a single Odoo instance.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># Odoo application (default username and password: admin/admin)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>odoo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Specify app name to install (in apps)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>apps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>       </span><span style=color:#8f5902;font-style:italic># Define all applications</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>odoo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>     </span><span style=color:#8f5902;font-style:italic># App name, should have corresponding ~/pigsty/app/odoo folder</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Optional directories to create</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>path: /data/odoo         ,state: directory, owner: 100, group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>101</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>path: /data/odoo/webdata ,state: directory, owner: 100, group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>101</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>path: /data/odoo/addons  ,state: directory, owner: 100, group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>101</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Override /opt/&lt;app&gt;/.env config file</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PG_HOST</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># PostgreSQL host</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PG_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5432</span><span style=color:#f8f8f8>                   </span><span style=color:#8f5902;font-style:italic># PostgreSQL port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PG_USERNAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># PostgreSQL user</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PG_PASSWORD</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Odoo       </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># PostgreSQL password</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ODOO_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>8069</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic># Odoo app port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ODOO_DATA</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/data/odoo/webdata  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Odoo webdata</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ODOO_ADDONS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/data/odoo/addons </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Odoo plugins</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ODOO_DBNAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Odoo database name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>ODOO_VERSION</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>19.0</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># Odoo image version</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># Odoo database</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-odoo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-odoo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: odoo    ,password: DBUser.Odoo ,pgbouncer: true ,roles: [ dbrole_admin ] ,createdb: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>admin user for odoo service }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: odoo_ro ,password: DBUser.Odoo ,pgbouncer: true ,roles: [ dbrole_readonly ]  ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read only user for odoo service  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: odoo_rw ,password: DBUser.Odoo ,pgbouncer: true ,roles: [ dbrole_readwrite ] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read write user for odoo service }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: odoo ,owner: odoo ,revokeconn: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo main database  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: all ,db: all ,addr: 172.17.0.0/16  ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow access from local docker network&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Full backup daily at 1am</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>etcd } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#minio: { hosts: { 10.10.10.10: { minio_seq: 1 } }, vars: { minio_cluster: minio } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                               </span><span style=color:#8f5902;font-style:italic># Global variables</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>v4.0.0                  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Pigsty version string</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># Admin node IP address</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region: default                   # Upstream mirror region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default|china|europe</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_tune: oltp                   # Node tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oltp,olap,tiny,crit</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_conf: oltp.yml                 # PGSQL tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#000>oltp,olap,tiny,crit}.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>docker_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># Enable docker on app group</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#docker_registry_mirrors: [&#34;https://docker.1panel.live&#34;,&#34;https://docker.1ms.run&#34;,&#34;https://docker.xuanyuan.me&#34;,&#34;https://registry-1.docker.io&#34;]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>proxy_env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                        </span><span style=color:#8f5902;font-style:italic># Global proxy env for downloading packages &amp; pulling docker images</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>no_proxy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.tsinghua.edu.cn&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#http_proxy:  127.0.0.1:12345   # Add proxy env here for downloading packages or pulling images</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#https_proxy: 127.0.0.1:12345   # Usually format is http://user:pass@proxy.xxx.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#all_proxy:   127.0.0.1:12345</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># Domain names and upstream servers</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home  </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>i.pigsty }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>minio </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m.pigsty ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;${admin_ip}:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>odoo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic># Nginx server config for odoo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo.pigsty           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># REPLACE WITH YOUR OWN DOMAIN!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:8069&#34;</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Odoo service endpoint: IP:PORT</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># Add websocket support</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>certbot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo.pigsty          </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Certbot cert name, apply with `make cert`</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>repo_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,infra,pgsql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>18</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># Credentials: MUST CHANGE THESE!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_view_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Viewer</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.DBA</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_monitor_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Monitor</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_replication_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Replicator</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>patroni_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Patroni.API</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_secret_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.MinIO</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd_root_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Etcd.Root</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=basics>Basics</h2><p>Check the configurable environment variables in the <code>.env</code> file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># https://hub.docker.com/_/odoo#</span>
</span></span><span style=display:flex><span><span style=color:#000>PG_HOST</span><span style=color:#ce5c00;font-weight:700>=</span>10.10.10.10
</span></span><span style=display:flex><span><span style=color:#000>PG_PORT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5432</span>
</span></span><span style=display:flex><span><span style=color:#000>PG_USER</span><span style=color:#ce5c00;font-weight:700>=</span>dbuser_odoo
</span></span><span style=display:flex><span><span style=color:#000>PG_PASS</span><span style=color:#ce5c00;font-weight:700>=</span>DBUser.Odoo
</span></span><span style=display:flex><span><span style=color:#000>ODOO_PORT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>8069</span>
</span></span></code></pre></div><p>Then start Odoo with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up  <span style=color:#8f5902;font-style:italic># docker compose up</span>
</span></span></code></pre></div><p>Access <a href=http://odoo.pigsty/>http://odoo.pigsty</a> or http://10.10.10.10:8069</p><h2 id=makefile>Makefile</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># Start Odoo with docker compose in minimal mode</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># Start Odoo with docker, local data directory and external PostgreSQL</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># Print Odoo access endpoints</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f Odoo logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># Inspect Odoo with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># Stop Odoo container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># Remove Odoo container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># Pull latest Odoo image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># Remove Odoo image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># Save Odoo image to /tmp/docker/odoo.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># Load Odoo image from /tmp/docker/odoo.tgz</span>
</span></span></code></pre></div><hr><h2 id=using-external-postgresql>Using External PostgreSQL</h2><p>You can use external PostgreSQL for Odoo. Odoo will create its own database during setup, so you don&rsquo;t need to do that.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_odoo ,password: DBUser.Odoo ,pgbouncer: true ,roles: [ dbrole_admin ]    ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>admin user for odoo database } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: odoo ,owner: dbuser_odoo ,revokeconn: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>odoo primary database } ]</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Create the business user and database with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-user  pg-meta  dbuser_odoo
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#bin/pgsql-db    pg-meta  odoo     # Odoo will create the database during setup</span>
</span></span></code></pre></div><p>Check connectivity:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql postgres://dbuser_odoo:DBUser.Odoo@10.10.10.10:5432/odoo
</span></span></code></pre></div><hr><h2 id=expose-odoo-service>Expose Odoo Service</h2><p><a href=/docs/infra/admin/portal/>Expose</a> the Odoo web service via Nginx portal:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># Domain names and upstream servers</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home         </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>h.pigsty }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>odoo         </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: odoo.pigsty, endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;127.0.0.1:8069&#34;</span><span style=color:#204a87;font-weight:700>, websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># &lt;------ Add this line</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>./infra.yml -t nginx  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Setup nginx infra portal</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=odoo-addons>Odoo Addons</h2><p>There are many Odoo modules available in the community. You can install them by downloading and placing them in the <code>addons</code> folder.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#000>./addons:/mnt/extra-addons</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>You can mount the <code>./addons</code> directory to <code>/mnt/extra-addons</code> in the container, then download and extract addons to the <code>addons</code> folder.</p><p>To enable addon modules, first enter <a href=https://www.odoo.com/documentation/19.0/applications/general/developer_mode.html>Developer mode</a>:</p><blockquote><p>Settings -> General Settings -> Developer Tools -> Activate the developer mode</p></blockquote><p>Then go to Apps -> Update Apps List, and you&rsquo;ll find the extra addons available to install from the panel.</p><p>Frequently used <a href="https://apps.odoo.com/apps/modules/browse?order=Downloads">free</a> addons: <a href=https://apps.odoo.com/apps/modules/19.0/base_accounting_kit/>Accounting Kit</a></p><hr><h2 id=demo>Demo</h2><p>Check the public demo: <a href=http://odoo.pigsty.io/>http://odoo.pigsty.io</a>, username: <code>test@pigsty.io</code>, password: <code>pigsty</code></p><p>If you want to access Odoo via SSL, you must trust <code>files/pki/ca/ca.crt</code> in your browser (or use the dirty hack <code>thisisunsafe</code> in Chrome).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cc85a499c2128f8ef2658df26b2566ad>3 - Dify: AI Workflow Platform</h1><div class=lead>How to self-host the AI Workflow LLMOps platform — Dify, using external PostgreSQL, PGVector, and Redis for storage with Pigsty?</div><p><a href=https://dify.ai/><strong>Dify</strong></a> is a Generative AI Application Innovation Engine and open-source LLM application development platform. It provides capabilities from Agent building to AI workflow orchestration, RAG retrieval, and model management, helping users easily build and operate generative AI native applications.</p><p>Pigsty provides support for self-hosted Dify, allowing you to deploy Dify with a single command while storing critical state in externally managed PostgreSQL. You can use pgvector as a vector database in the same PostgreSQL instance, further simplifying deployment.</p><ul><li><a href=#quick-start>Quick Start</a></li><li><a href=#why-self-host>Why Self-Host</a></li><li><a href=#installation>Installation</a></li><li><a href=#configuration>Configuration</a></li><li><a href=#checklist>Checklist</a></li><li><a href=#domain-and-ssl>Domain and SSL</a></li><li><a href=#file-backup>File Backup</a></li></ul><blockquote><p>Current Pigsty v4.0 supported Dify version: v1.8.1</p></blockquote><hr><h2 id=quick-start>Quick Start</h2><p>On a fresh Linux x86/ARM server running a <a href=/docs/deploy/prepare><strong>compatible operating system</strong></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./bootstrap                <span style=color:#8f5902;font-style:italic># Install Pigsty dependencies</span>
</span></span><span style=display:flex><span>./configure -c app/dify    <span style=color:#8f5902;font-style:italic># Use Dify configuration template</span>
</span></span><span style=display:flex><span>vi pigsty.yml              <span style=color:#8f5902;font-style:italic># Edit passwords, domains, keys, etc.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./deploy.yml               <span style=color:#8f5902;font-style:italic># Install Pigsty</span>
</span></span><span style=display:flex><span>./docker.yml               <span style=color:#8f5902;font-style:italic># Install Docker and Compose</span>
</span></span><span style=display:flex><span>./app.yml                  <span style=color:#8f5902;font-style:italic># Install Dify</span>
</span></span></code></pre></div><p>Dify listens on port <code>5001</code> by default. Access <code>http://&lt;ip>:5001</code> in your browser and set up your initial user credentials to log in.</p><p>Once Dify starts, you can install various extensions, configure system models, and start using it!</p><hr><h2 id=why-self-host>Why Self-Host</h2><p>There are many reasons to self-host Dify, but the primary motivation is data security. The Docker Compose template provided by Dify uses basic default database images, lacking enterprise features like high availability, disaster recovery, monitoring, IaC, and PITR capabilities.</p><p>Pigsty elegantly solves these issues for Dify, deploying all components with a single command based on configuration files and using mirrors to address China region access challenges. This makes Dify deployment and delivery very smooth. It handles PostgreSQL primary database, PGVector vector database, MinIO object storage, Redis, Prometheus monitoring, Grafana visualization, Nginx reverse proxy, and free HTTPS certificates all at once.</p><p>Pigsty ensures all Dify state is stored in externally managed services, including metadata in PostgreSQL and other data in the file system. Dify instances launched via Docker Compose become stateless applications that can be destroyed and rebuilt at any time, greatly simplifying operations.</p><hr><h2 id=installation>Installation</h2><p>Let&rsquo;s start with single-node Dify deployment. We&rsquo;ll cover production high-availability deployment methods later.</p><p>First, use Pigsty&rsquo;s <a href=/docs/setup/install>standard installation process</a> to install the PostgreSQL instance required by Dify:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./bootstrap               <span style=color:#8f5902;font-style:italic># Prepare Pigsty dependencies</span>
</span></span><span style=display:flex><span>./configure -c app/dify   <span style=color:#8f5902;font-style:italic># Use Dify application template</span>
</span></span><span style=display:flex><span>vi pigsty.yml             <span style=color:#8f5902;font-style:italic># Edit configuration file, modify domains and passwords</span>
</span></span><span style=display:flex><span>./deploy.yml              <span style=color:#8f5902;font-style:italic># Install Pigsty and various databases</span>
</span></span></code></pre></div><p>When you use the <code>./configure -c app/dify</code> command, Pigsty automatically generates a configuration file based on the <a href=https://github.com/pgsty/pigsty/blob/main/conf/app/dify.yml><code>conf/app/dify.yml</code></a> template and your current environment.
You should modify passwords, domains, and other relevant parameters in the generated <code>pigsty.yml</code> configuration file according to your needs, then run <code>./deploy.yml</code> to execute the standard installation process.</p><p>Next, run <a href=https://github.com/pgsty/pigsty/blob/main/docker.yml><code>docker.yml</code></a> to install Docker and Docker Compose, then use <a href=https://github.com/pgsty/pigsty/blob/main/app.yml><code>app.yml</code></a> to complete Dify deployment:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./docker.yml              <span style=color:#8f5902;font-style:italic># Install Docker and Docker Compose</span>
</span></span><span style=display:flex><span>./app.yml                 <span style=color:#8f5902;font-style:italic># Deploy Dify stateless components with Docker</span>
</span></span></code></pre></div><p>You can access the Dify Web admin interface at <code>http://&lt;your_ip_address>:5001</code> on your local network.</p><p>The first login will prompt you to set up default username, email, and password.</p><p>You can also use the locally resolved placeholder domain <code>dify.pigsty</code>, or follow the configuration below to use a real domain with an HTTPS certificate.</p><hr><h2 id=configuration>Configuration</h2><p>When you use the <code>./configure -c app/dify</code> command for configuration, Pigsty automatically generates a configuration file based on the <a href=https://github.com/pgsty/pigsty/blob/main/conf/app/dify.yml><code>conf/app/dify.yml</code></a> template and your current environment. Here&rsquo;s a detailed explanation of the default configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>---</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># File      :   dify.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Desc      :   pigsty config for running 1-node dify app</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Ctime     :   2025-02-24</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Mtime     :   2025-12-12</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Docs      :   https://doc.pgsty.com/app/odoo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># License   :   Apache-2.0 @ https://pigsty.io/docs/about/license/</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Copyright :   2018-2026  Ruohang Feng / Vonng (rh@vonng.com)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Last Verified Dify Version: v1.8.1 on 2025-0908</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># tutorial: https://doc.pgsty.com/app/dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># how to use this template:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#  curl -fsSL https://repo.pigsty.io/get | bash; cd ~/pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./bootstrap               # prepare local repo &amp; ansible</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./configure -c app/dify   # use this dify config template</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># vi pigsty.yml             # IMPORTANT: CHANGE CREDENTIALS!!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./deploy.yml              # install pigsty &amp; pgsql &amp; minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./docker.yml              # install docker &amp; docker-compose</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./app.yml                 # install dify with docker-compose</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># To replace domain name:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#   sed -ie &#39;s/dify.pigsty/dify.pigsty.cc/g&#39; pigsty.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># the dify application</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># specify app name to be installed (in the apps)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>apps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>       </span><span style=color:#8f5902;font-style:italic># define all applications</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>     </span><span style=color:#8f5902;font-style:italic># app name, should have corresponding ~/pigsty/app/dify folder</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># data directory to be created</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>path: /data/dify ,state: directory ,mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>0755</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># override /opt/dify/.env config file</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># change domain, mirror, proxy, secret key</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>NGINX_SERVER_NAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># A secret key for signing and encryption, gen with `openssl rand -base64 42` (CHANGE PASSWORD!)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>SECRET_KEY</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sk-somerandomkey</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># expose DIFY nginx service with port 5001 by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DIFY_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5001</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># where to store dify files? the default is ./volume, we&#39;ll use another volume created above</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DIFY_DATA</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/data/dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># proxy and mirror settings</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>#PIP_MIRROR_URL: https://pypi.tuna.tsinghua.edu.cn/simple</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>#SANDBOX_HTTP_PROXY: http://10.10.10.10:12345</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>#SANDBOX_HTTPS_PROXY: http://10.10.10.10:12345</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># database credentials</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DB_USERNAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DB_PASSWORD</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>difyai123456</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DB_HOST</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DB_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5432</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>DB_DATABASE</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>VECTOR_STORE</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgvector</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_HOST</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5432</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_USER</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_PASSWORD</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>difyai123456</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_DATABASE</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_MIN_CONNECTION</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>PGVECTOR_MAX_CONNECTION</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dify ,password: difyai123456 ,pgbouncer: true ,roles: [ dbrole_admin ] ,superuser: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify superuser }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dify        ,owner: dify ,revokeconn: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify main database  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dify_plugin ,owner: dify ,revokeconn: true ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify plugin_daemon database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: dify ,db: all ,addr: 172.17.0.0/16  ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow dify access from local docker network&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># make a full backup every 1am</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>etcd } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#minio: { hosts: { 10.10.10.10: { minio_seq: 1 } }, vars: { minio_cluster: minio } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                               </span><span style=color:#8f5902;font-style:italic># global variables</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>v4.0.0                  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pigsty version string</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># admin node ip address</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region: default                   # upstream mirror region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default|china|europe</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_tune: oltp                   # node tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oltp,olap,tiny,crit</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_conf: oltp.yml                 # pgsql tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#000>oltp,olap,tiny,crit}.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>docker_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># enable docker on app group</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#docker_registry_mirrors: [&#34;https://docker.1panel.live&#34;,&#34;https://docker.1ms.run&#34;,&#34;https://docker.xuanyuan.me&#34;,&#34;https://registry-1.docker.io&#34;]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>proxy_env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                        </span><span style=color:#8f5902;font-style:italic># global proxy env when downloading packages &amp; pull docker images</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>no_proxy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16,*.pigsty,*.aliyun.com,mirrors.*,*.tsinghua.edu.cn&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#http_proxy:  127.0.0.1:12345 # add your proxy env here for downloading packages or pull images</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#https_proxy: 127.0.0.1:12345 # usually the proxy is format as http://user:pass@proxy.xxx.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#all_proxy:   127.0.0.1:12345</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># domain names and upstream servers</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home   </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>i.pigsty }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>#minio :  { domain: m.pigsty    ,endpoint: &#34;${admin_ip}:9001&#34; ,scheme: https ,websocket: true }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic># nginx server config for dify</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># REPLACE WITH YOUR OWN DOMAIN!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:5001&#34;</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># dify service endpoint: IP:PORT</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># add websocket support</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>certbot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty          </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># certbot cert name, apply with `make cert`</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>repo_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,infra,pgsql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>18</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># PASSWORD : https://doc.pgsty.com/config/security</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_view_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Viewer</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.DBA</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_monitor_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Monitor</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_replication_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Replicator</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>patroni_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Patroni.API</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_secret_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.MinIO</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd_root_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Etcd.Root</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>...</span></span></span></code></pre></div><hr><h2 id=checklist>Checklist</h2><p>Here&rsquo;s a checklist of configuration items you need to pay attention to:</p><ul><li>Hardware/Software: <a href=/docs/deploy/prepare>Prepare required machine resources</a>: Linux <code>x86_64/arm64</code> server, fresh installation of a <a href=/docs/deploy/prepare>mainstream Linux OS</a></li><li>Network/Permissions: <a href=/docs/deploy/prepare#ssh>SSH</a> passwordless login access, user with <a href=/docs/deploy/prepare#user>sudo privileges without password</a></li><li>Ensure the machine has a static IPv4 network address on the internal network and can access the internet</li><li>If accessing via public network, ensure you have a domain pointing to the node&rsquo;s <strong>public IP address</strong></li><li>Ensure you use the <code>app/dify</code> configuration template and modify parameters as needed<ul><li><code>configure -c app/dify</code>, enter the node&rsquo;s internal primary IP address, or specify via <code>-i &lt;primary_ip></code> command line parameter</li></ul></li><li>Have you changed all password-related configuration parameters? [Optional]<ul><li><a href=/docs/infra/param/#grafana_admin_password><code>grafana_admin_password</code></a>: <code>pigsty</code>, Grafana admin password</li><li><a href=/docs/pgsql/param/#pg_admin_password><code>pg_admin_password</code></a>: <code>DBUser.DBA</code>, PG superuser password</li><li><a href=/docs/pgsql/param/#pg_monitor_password><code>pg_monitor_password</code></a>: <code>DBUser.Monitor</code>, PG monitoring user password</li><li><a href=/docs/pgsql/param/#pg_replication_password><code>pg_replication_password</code></a>: <code>DBUser.Replicator</code>, PG replication user password</li><li><a href=/docs/pgsql/param/#patroni_password><code>patroni_password</code></a>: <code>Patroni.API</code>, Patroni HA component password</li><li><a href=/docs/node/param/#haproxy_admin_password><code>haproxy_admin_password</code></a>: <code>pigsty</code>, Load balancer admin password</li></ul></li><li>Have you changed the PostgreSQL cluster business user password and application configurations using these passwords?<ul><li>Default username <code>dify</code> and password <code>difyai123456</code> are generated by Pigsty for Dify; modify according to your needs</li><li>In the Dify configuration block, modify <code>DB_USERNAME</code>, <code>DB_PASSWORD</code>, <code>PGVECTOR_USER</code>, <code>PGVECTOR_PASSWORD</code> accordingly</li></ul></li><li>Have you changed Dify&rsquo;s default encryption key?<ul><li>You can randomly generate a password string with <code>openssl rand -base64 42</code> and fill in the <code>SECRET_KEY</code> parameter</li></ul></li><li>Have you changed the domain used by Dify?<ul><li>Replace placeholder domain <code>dify.pigsty</code> with your actual domain, e.g., <code>dify.pigsty.cc</code></li><li>You can use <code>sed -ie 's/dify.pigsty/dify.pigsty.cc/g' pigsty.yml</code> to modify Dify&rsquo;s domain</li></ul></li></ul><hr><h2 id=domain-and-ssl>Domain and SSL</h2><p>If you want to use a real domain with an HTTPS certificate, you need to modify the <code>pigsty.yml</code> configuration file:</p><ul><li>The <code>dify</code> domain in the <a href=/docs/infra/param/#infra_portal><code>infra_portal</code></a> parameter</li><li>It&rsquo;s best to specify an email address <a href=/docs/infra/param/#certbot_email><code>certbot_email</code></a> for certificate expiration notifications</li><li>Configure Dify&rsquo;s <code>NGINX_SERVER_NAME</code> parameter to specify your actual domain</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic># Cluster definitions</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                              </span><span style=color:#8f5902;font-style:italic># Dify group</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic># Dify group variables</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>apps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                          </span><span style=color:#8f5902;font-style:italic># Application configuration</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                        </span><span style=color:#8f5902;font-style:italic># Dify application definition</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>            </span><span style=color:#204a87;font-weight:700>conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># Dify application configuration</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>              </span><span style=color:#204a87;font-weight:700>NGINX_SERVER_NAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                                </span><span style=color:#8f5902;font-style:italic># Global parameters</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#certbot_sign: true                # Use Certbot for free HTTPS certificate</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>certbot_email</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>your@email.com     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Email for certificate requests, for expiration notifications, optional</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># Configure Nginx servers</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>dify</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic># Dify server definition</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace with your own domain here!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:5001&#34;</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Specify Dify&#39;s IP and port here (auto-configured by default)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># Dify requires websocket enabled</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>certbot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dify.pigsty          </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Specify Certbot certificate name</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Use the following commands to request Nginx certificates:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Request certificate, can also manually run /etc/nginx/sign-cert script</span>
</span></span><span style=display:flex><span>make cert
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The above Makefile shortcut actually runs the following playbook task:</span>
</span></span><span style=display:flex><span>./infra.yml -t nginx_certbot,nginx_reload -e <span style=color:#000>certbot_sign</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><p>Run the <code>app.yml</code> playbook to redeploy Dify service for the <code>NGINX_SERVER_NAME</code> configuration to take effect:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./app.yml
</span></span></code></pre></div><hr><h2 id=file-backup>File Backup</h2><p>You can use <code>restic</code> to backup Dify&rsquo;s file storage (default location <code>/data/dify</code>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>RESTIC_REPOSITORY</span><span style=color:#ce5c00;font-weight:700>=</span>/data/backups/dify   <span style=color:#8f5902;font-style:italic># Specify dify backup directory</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>RESTIC_PASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span>some-strong-password   <span style=color:#8f5902;font-style:italic># Specify backup encryption password</span>
</span></span><span style=display:flex><span>mkdir -p <span style=color:#4e9a06>${</span><span style=color:#000>RESTIC_REPOSITORY</span><span style=color:#4e9a06>}</span>                 <span style=color:#8f5902;font-style:italic># Create dify backup directory</span>
</span></span><span style=display:flex><span>restic init
</span></span></code></pre></div><p>After creating the Restic backup repository, you can backup Dify with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>RESTIC_REPOSITORY</span><span style=color:#ce5c00;font-weight:700>=</span>/data/backups/dify   <span style=color:#8f5902;font-style:italic># Specify dify backup directory</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>RESTIC_PASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span>some-strong-password   <span style=color:#8f5902;font-style:italic># Specify backup encryption password</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>restic backup /data/dify                      <span style=color:#8f5902;font-style:italic># Backup /dify data directory to repository</span>
</span></span><span style=display:flex><span>restic snapshots                              <span style=color:#8f5902;font-style:italic># View backup snapshot list</span>
</span></span><span style=display:flex><span>restic restore -t /data/dify 0b11f778         <span style=color:#8f5902;font-style:italic># Restore snapshot xxxxxx to /data/dify</span>
</span></span><span style=display:flex><span>restic check                                  <span style=color:#8f5902;font-style:italic># Periodically check repository integrity</span>
</span></span></code></pre></div><p>Another more reliable method is using JuiceFS to mount MinIO object storage to the <code>/data/dify</code> directory, allowing you to use MinIO/S3 for file state storage.</p><p>If you want to store all data in PostgreSQL, consider &ldquo;storing file system data in PostgreSQL using JuiceFS&rdquo;.</p><p>For example, you can create another <code>dify_fs</code> database and use it as JuiceFS metadata storage:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>METAURL</span><span style=color:#ce5c00;font-weight:700>=</span>postgres://dify:difyai123456@:5432/dify_fs
</span></span><span style=display:flex><span><span style=color:#000>OPTIONS</span><span style=color:#ce5c00;font-weight:700>=(</span>
</span></span><span style=display:flex><span>  --storage postgres
</span></span><span style=display:flex><span>  --bucket :5432/dify_fs
</span></span><span style=display:flex><span>  --access-key dify
</span></span><span style=display:flex><span>  --secret-key difyai123456
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>${</span><span style=color:#000>METAURL</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>  jfs
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>juicefs format <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>OPTIONS</span><span style=color:#000;font-weight:700>[@]</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>         <span style=color:#8f5902;font-style:italic># Create PG file system</span>
</span></span><span style=display:flex><span>juicefs mount <span style=color:#4e9a06>${</span><span style=color:#000>METAURL</span><span style=color:#4e9a06>}</span> /data/dify -d <span style=color:#8f5902;font-style:italic># Mount to /data/dify directory in background</span>
</span></span><span style=display:flex><span>juicefs bench /data/dify               <span style=color:#8f5902;font-style:italic># Test performance</span>
</span></span><span style=display:flex><span>juicefs umount /data/dify              <span style=color:#8f5902;font-style:italic># Unmount</span>
</span></span></code></pre></div><hr><h2 id=reference>Reference</h2><p><a href=https://docs.dify.ai/learn-more/faq/install-faq>Dify Self-Hosting FAQ</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-de0128bd4345697963d59e764c35c90b>4 - Enterprise Software</h1><p>Enterprise-grade open source software templates</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b94f778cc05c5fe2e52f126f032753e9>5 - NocoDB: Open-Source Airtable</h1><div class=lead>Use NocoDB to transform PostgreSQL databases into smart spreadsheets, a no-code database application platform.</div><p><a href=https://nocodb.com/><strong>NocoDB</strong></a> is an open-source Airtable alternative that turns any database into a smart spreadsheet.</p><p>It provides a rich user interface that allows you to create powerful database applications without writing code. NocoDB supports PostgreSQL, MySQL, SQL Server, and more, making it ideal for building internal tools and data management systems.</p><h2 id=quick-start>Quick Start</h2><p>Pigsty provides a Docker Compose configuration file for NocoDB in the software template directory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/nocodb
</span></span></code></pre></div><p>Review and modify the <code>.env</code> configuration file (adjust database connections as needed).</p><p>Start the service:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up     <span style=color:#8f5902;font-style:italic># Start NocoDB with Docker Compose</span>
</span></span></code></pre></div><p>Access NocoDB:</p><ul><li>Default URL: <a href=http://nocodb.pigsty>http://nocodb.pigsty</a></li><li>Alternate URL: http://10.10.10.10:8080</li><li>First-time access requires creating an administrator account</li></ul><h2 id=management-commands>Management Commands</h2><p>Pigsty provides convenient Makefile commands to manage NocoDB:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up      <span style=color:#8f5902;font-style:italic># Start NocoDB service</span>
</span></span><span style=display:flex><span>make run     <span style=color:#8f5902;font-style:italic># Start with Docker (connect to external PostgreSQL)</span>
</span></span><span style=display:flex><span>make view    <span style=color:#8f5902;font-style:italic># Display NocoDB access URL</span>
</span></span><span style=display:flex><span>make log     <span style=color:#8f5902;font-style:italic># View container logs</span>
</span></span><span style=display:flex><span>make info    <span style=color:#8f5902;font-style:italic># View service details</span>
</span></span><span style=display:flex><span>make stop    <span style=color:#8f5902;font-style:italic># Stop the service</span>
</span></span><span style=display:flex><span>make clean   <span style=color:#8f5902;font-style:italic># Stop and remove containers</span>
</span></span><span style=display:flex><span>make pull    <span style=color:#8f5902;font-style:italic># Pull the latest image</span>
</span></span><span style=display:flex><span>make rmi     <span style=color:#8f5902;font-style:italic># Remove NocoDB image</span>
</span></span><span style=display:flex><span>make save    <span style=color:#8f5902;font-style:italic># Save image to /tmp/nocodb.tgz</span>
</span></span><span style=display:flex><span>make load    <span style=color:#8f5902;font-style:italic># Load image from /tmp/nocodb.tgz</span>
</span></span></code></pre></div><h2 id=connect-to-postgresql>Connect to PostgreSQL</h2><p>NocoDB can connect to PostgreSQL databases managed by Pigsty.</p><p>When adding a new project in the NocoDB interface, select &ldquo;External Database&rdquo; and enter the PostgreSQL connection information:</p><pre tabindex=0><code>Host: 10.10.10.10
Port: 5432
Database Name: your_database
Username: your_username
Password: your_password
SSL: Disabled (or enable as needed)
</code></pre><p>After successful connection, NocoDB will automatically read the database table structure, and you can manage data through the visual interface.</p><h2 id=features>Features</h2><ul><li><strong>Smart Spreadsheet Interface</strong>: Excel/Airtable-like user experience</li><li><strong>Multiple Views</strong>: Grid, form, kanban, calendar, gallery views</li><li><strong>Collaboration Features</strong>: Team collaboration, permission management, comments</li><li><strong>API Support</strong>: Auto-generated REST API</li><li><strong>Integration Capabilities</strong>: Webhooks, Zapier integrations</li><li><strong>Import/Export</strong>: CSV, Excel format support</li><li><strong>Formulas and Validation</strong>: Complex data calculations and validation rules</li></ul><h2 id=configuration>Configuration</h2><p>NocoDB configuration is in the <code>.env</code> file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Database connection (NocoDB metadata storage)</span>
</span></span><span style=display:flex><span><span style=color:#000>NC_DB</span><span style=color:#ce5c00;font-weight:700>=</span>pg://postgres:DBUser.Postgres@10.10.10.10:5432/nocodb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># JWT secret (recommended to change)</span>
</span></span><span style=display:flex><span><span style=color:#000>NC_AUTH_JWT_SECRET</span><span style=color:#ce5c00;font-weight:700>=</span>your-secret-key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Other settings</span>
</span></span><span style=display:flex><span><span style=color:#000>NC_PUBLIC_URL</span><span style=color:#ce5c00;font-weight:700>=</span>http://nocodb.pigsty
</span></span><span style=display:flex><span><span style=color:#000>NC_DISABLE_TELE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><h2 id=data-persistence>Data Persistence</h2><p>NocoDB metadata is stored by default in an external PostgreSQL database, and application data can also be stored in PostgreSQL.</p><p>If using local storage, data is saved in the <code>/data/nocodb</code> directory.</p><h2 id=security-recommendations>Security Recommendations</h2><ol><li><strong>Change Default Secret</strong>: Modify <code>NC_AUTH_JWT_SECRET</code> in the <code>.env</code> file</li><li><strong>Use Strong Passwords</strong>: Set strong passwords for administrator accounts</li><li><strong>Configure HTTPS</strong>: Enable HTTPS for production environments</li><li><strong>Restrict Access</strong>: Limit access through firewall or Nginx</li><li><strong>Regular Backups</strong>: Regularly back up the NocoDB metadata database</li></ol><h2 id=related-links>Related Links</h2><ul><li>NocoDB Website: <a href=https://nocodb.com/>https://nocodb.com/</a></li><li>Documentation: <a href=https://docs.nocodb.com/>https://docs.nocodb.com/</a></li><li>GitHub Repository: <a href=https://github.com/nocodb/nocodb>https://github.com/nocodb/nocodb</a></li><li>Pigsty Software Template: <a href=https://github.com/pgsty/pigsty/tree/main/app/nocodb>https://github.com/pgsty/pigsty/tree/main/app/nocodb</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a24f4293fdd8dcc354ecc1a0fe74f7da>6 - Teable: AI No-Code Database</h1><div class=lead>Build AI-powered no-code database applications with Teable to boost team productivity.</div><p><a href=https://teable.io/><strong>Teable</strong></a> is an AI-powered no-code database platform designed for team collaboration and automation.</p><p>Teable perfectly combines the power of databases with the ease of spreadsheets, integrating AI capabilities to help teams efficiently generate, automate, and collaborate on data.</p><h2 id=quick-start>Quick Start</h2><p>Teable requires a complete Pigsty environment (including PostgreSQL, Redis, MinIO).</p><h3 id=prepare-environment>Prepare Environment</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty
</span></span><span style=display:flex><span>./bootstrap                <span style=color:#8f5902;font-style:italic># Prepare local repo and Ansible</span>
</span></span><span style=display:flex><span>./configure -c app/teable  <span style=color:#8f5902;font-style:italic># Important: modify default credentials!</span>
</span></span><span style=display:flex><span>./deploy.yml               <span style=color:#8f5902;font-style:italic># Install Pigsty, PostgreSQL, MinIO</span>
</span></span><span style=display:flex><span>./redis.yml                <span style=color:#8f5902;font-style:italic># Install Redis instance</span>
</span></span><span style=display:flex><span>./docker.yml               <span style=color:#8f5902;font-style:italic># Install Docker and Docker Compose</span>
</span></span><span style=display:flex><span>./app.yml                  <span style=color:#8f5902;font-style:italic># Install Teable with Docker Compose</span>
</span></span></code></pre></div><h3 id=access-service>Access Service</h3><ul><li>Default URL: <a href=http://teable.pigsty>http://teable.pigsty</a></li><li>Alternate URL: http://10.10.10.10:3000</li><li>First-time access requires registering an administrator account</li></ul><h2 id=management-commands>Management Commands</h2><p>Manage Teable in the Pigsty software template directory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/teable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>make up      <span style=color:#8f5902;font-style:italic># Start Teable service</span>
</span></span><span style=display:flex><span>make down    <span style=color:#8f5902;font-style:italic># Stop Teable service</span>
</span></span><span style=display:flex><span>make log     <span style=color:#8f5902;font-style:italic># View container logs</span>
</span></span><span style=display:flex><span>make clean   <span style=color:#8f5902;font-style:italic># Clean up containers and data</span>
</span></span></code></pre></div><h2 id=architecture>Architecture</h2><p>Teable depends on the following components:</p><ul><li><strong>PostgreSQL</strong>: Stores application data and metadata</li><li><strong>Redis</strong>: Caching and session management</li><li><strong>MinIO</strong>: Object storage (files, images, etc.)</li><li><strong>Docker</strong>: Container runtime environment</li></ul><p>Ensure these services are properly installed before deploying Teable.</p><h2 id=features>Features</h2><ul><li><strong>AI Integration</strong>: Built-in AI assistant for auto-generating data, formulas, and workflows</li><li><strong>Smart Tables</strong>: Powerful table functionality with multiple field types</li><li><strong>Automated Workflows</strong>: No-code automation to boost team efficiency</li><li><strong>Multiple Views</strong>: Grid, form, kanban, calendar, and more</li><li><strong>Team Collaboration</strong>: Real-time collaboration, permission management, comments</li><li><strong>API and Integrations</strong>: Auto-generated API with Webhook support</li><li><strong>Template Library</strong>: Rich application templates for quick project starts</li></ul><h2 id=configuration>Configuration</h2><p>Teable configuration is managed through environment variables in <code>docker-compose.yml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># PostgreSQL connection</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>POSTGRES_HOST=10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>POSTGRES_PORT=5432</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>POSTGRES_DB=teable</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>POSTGRES_USER=dbuser_teable</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>POSTGRES_PASSWORD=DBUser.Teable</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Redis connection</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>REDIS_HOST=10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>REDIS_PORT=6379</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>REDIS_DB=0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MinIO connection</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>MINIO_ENDPOINT=http://10.10.10.10:9000</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>MINIO_ACCESS_KEY=minioadmin</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>MINIO_SECRET_KEY=minioadmin</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Application configuration</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>BACKEND_URL=http://teable.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>PUBLIC_ORIGIN=http://teable.pigsty</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>Important</strong>: In production environments, modify all default passwords and keys!</p><h2 id=data-persistence>Data Persistence</h2><p>Teable data persistence relies on:</p><ul><li><strong>PostgreSQL</strong>: All structured data stored in PostgreSQL</li><li><strong>MinIO</strong>: Files, images, and other unstructured data stored in MinIO</li><li><strong>Redis</strong>: Cache data (optional persistence)</li></ul><p>Regularly back up the PostgreSQL database and MinIO buckets to ensure data safety.</p><h2 id=security-recommendations>Security Recommendations</h2><ol><li><strong>Change Default Credentials</strong>: Modify all default usernames and passwords in configuration files</li><li><strong>Enable HTTPS</strong>: Configure SSL certificates for production environments</li><li><strong>Configure Firewall</strong>: Restrict access to services</li><li><strong>Regular Backups</strong>: Regularly back up PostgreSQL and MinIO data</li><li><strong>Update Components</strong>: Keep Teable and dependent components up to date</li></ol><h2 id=related-links>Related Links</h2><ul><li>Teable Website: <a href=https://teable.io/>https://teable.io/</a></li><li>Documentation: <a href=https://help.teable.io/>https://help.teable.io/</a></li><li>GitHub Repository: <a href=https://github.com/teableio/teable>https://github.com/teableio/teable</a></li><li>Pigsty Software Template: <a href=https://github.com/pgsty/pigsty/tree/main/app/teable>https://github.com/pgsty/pigsty/tree/main/app/teable</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e4d7871bc5c532d89a4e76a28e49ee3b>7 - Gitea: Simple Self-Hosting Git Service</h1><div class=lead>Launch the self-hosting Git service with Gitea and Pigsty managed PostgreSQL</div><p>Public Demo: <a href=http://git.pigsty.cc>http://git.pigsty.cc</a></p><p><img src=/img/docs/app/gitea.jpeg alt></p><h2 id=tldr>TL;DR</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/gitea<span style=color:#000;font-weight:700>;</span> make up
</span></span></code></pre></div><p>Pigsty use <code>8889</code> port for gitea by default</p><p><a href=http://git.pigsty>http://git.pigsty</a> or http://10.10.10.10:8889</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up      <span style=color:#8f5902;font-style:italic># pull up gitea with docker-compose in minimal mode</span>
</span></span><span style=display:flex><span>make run     <span style=color:#8f5902;font-style:italic># launch gitea with docker , local data dir and external PostgreSQL</span>
</span></span><span style=display:flex><span>make view    <span style=color:#8f5902;font-style:italic># print gitea access point</span>
</span></span><span style=display:flex><span>make log     <span style=color:#8f5902;font-style:italic># tail -f gitea logs</span>
</span></span><span style=display:flex><span>make info    <span style=color:#8f5902;font-style:italic># introspect gitea with jq</span>
</span></span><span style=display:flex><span>make stop    <span style=color:#8f5902;font-style:italic># stop gitea container</span>
</span></span><span style=display:flex><span>make clean   <span style=color:#8f5902;font-style:italic># remove gitea container</span>
</span></span><span style=display:flex><span>make pull    <span style=color:#8f5902;font-style:italic># pull latest gitea image</span>
</span></span><span style=display:flex><span>make rmi     <span style=color:#8f5902;font-style:italic># remove gitea image</span>
</span></span><span style=display:flex><span>make save    <span style=color:#8f5902;font-style:italic># save gitea image to /tmp/gitea.tgz</span>
</span></span><span style=display:flex><span>make load    <span style=color:#8f5902;font-style:italic># load gitea image from /tmp</span>
</span></span></code></pre></div><h2 id=postgresql-preparation>PostgreSQL Preparation</h2><p>Gitea use built-in SQLite as default metadata storage, you can let Gitea use external PostgreSQL by setting connection string environment variable</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># postgres://dbuser_gitea:DBUser.gitea@10.10.10.10:5432/gitea</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>db</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: gitea, owner: dbuser_gitea, comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>gitea primary database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_gitea , password: DBUser.gitea, roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-ab8b5d6530871db26391dfb780764601>8 - Wiki.js: OSS Wiki Software</h1><div class=lead>How to self-hosting your own wikipedia with Wiki.js and use Pigsty managed PostgreSQL as the backend database</div><p>Public Demo: <a href=http://wiki.pigsty.cc>http://wiki.pigsty.cc</a></p><p><img src=/img/docs/app/wiki.jpg alt></p><h2 id=tl-dr>TL; DR</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> app/wiki <span style=color:#000;font-weight:700>;</span> docker-compose up -d
</span></span></code></pre></div><h2 id=postgres-preparation>Postgres Preparation</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># postgres://dbuser_wiki:DBUser.Wiki@10.10.10.10:5432/wiki</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: wiki, owner: dbuser_wiki, revokeconn: true , comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>wiki the api gateway database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_wiki, password: DBUser.Wiki , pgbouncer: true , roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-user pg-meta dbuser_wiki
</span></span><span style=display:flex><span>bin/pgsql-db   pg-meta wiki
</span></span></code></pre></div><h2 id=configuration>Configuration</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>wiki</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>container_name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>wiki</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>requarks/wiki:2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_TYPE</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>postgres</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_HOST</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_PORT</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5432</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_USER</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dbuser_wiki</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_PASS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Wiki</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DB_NAME</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>wiki</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>restart</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>unless-stopped</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;9002:3000&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=access>Access</h2><ul><li>Default Port for wiki: 9002</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># add to nginx_upstream</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: wiki  , domain: wiki.pigsty.cc , endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;127.0.0.1:9002&#34;</span><span style=color:#f8f8f8>   </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./infra.yml -t nginx_config
</span></span><span style=display:flex><span>ansible all -b -a <span style=color:#4e9a06>&#39;nginx -s reload&#39;</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b2e9576ebd029b6f66db394de58e3112>9 - Mattermost: Open-Source IM</h1><div class=lead>Build a private team collaboration platform with Mattermost, the open-source Slack alternative.</div><p><a href=https://mattermost.com/><strong>Mattermost</strong></a> is an open-source team collaboration and messaging platform.</p><p>Mattermost provides instant messaging, file sharing, audio/video calls, and more. It&rsquo;s an open-source alternative to Slack and Microsoft Teams, particularly suitable for enterprises requiring self-hosted deployment.</p><h2 id=quick-start>Quick Start</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/mattermost
</span></span><span style=display:flex><span>make up     <span style=color:#8f5902;font-style:italic># Start Mattermost with Docker Compose</span>
</span></span></code></pre></div><p>Access URL: <a href=http://mattermost.pigsty>http://mattermost.pigsty</a> or http://10.10.10.10:8065</p><p>First-time access requires creating an administrator account.</p><h2 id=features>Features</h2><ul><li><strong>Instant Messaging</strong>: Personal and group chat</li><li><strong>Channel Management</strong>: Public and private channels</li><li><strong>File Sharing</strong>: Secure file storage and sharing</li><li><strong>Audio/Video Calls</strong>: Built-in calling functionality</li><li><strong>Integration Capabilities</strong>: Webhooks, Bots, and plugins support</li><li><strong>Mobile Apps</strong>: iOS and Android clients</li><li><strong>Enterprise-grade</strong>: SSO, LDAP, compliance features</li></ul><h2 id=connect-to-postgresql>Connect to PostgreSQL</h2><p>Mattermost uses PostgreSQL for data storage. Configure the connection information:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>MM_SQLSETTINGS_DRIVERNAME</span><span style=color:#ce5c00;font-weight:700>=</span>postgres
</span></span><span style=display:flex><span><span style=color:#000>MM_SQLSETTINGS_DATASOURCE</span><span style=color:#ce5c00;font-weight:700>=</span>postgres://dbuser_mm:DBUser.MM@10.10.10.10:5432/mattermost
</span></span></code></pre></div><h2 id=related-links>Related Links</h2><ul><li>Mattermost Website: <a href=https://mattermost.com/>https://mattermost.com/</a></li><li>Documentation: <a href=https://docs.mattermost.com/>https://docs.mattermost.com/</a></li><li>GitHub Repository: <a href=https://github.com/mattermost/mattermost>https://github.com/mattermost/mattermost</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b3e8ff513ff4c90114324ee5b19b8015>10 - Maybe: Personal Finance</h1><div class=lead>Manage personal finances with Maybe, the open-source Mint/Personal Capital alternative.</div><p><a href=https://github.com/maybe-finance/maybe><strong>Maybe</strong></a> is an open-source personal finance management application.</p><p>Maybe provides financial tracking, budget management, investment analysis, and more. It&rsquo;s an open-source alternative to Mint and Personal Capital, giving you complete control over your financial data.</p><h2 id=quick-start>Quick Start</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/maybe
</span></span><span style=display:flex><span>cp .env.example .env
</span></span><span style=display:flex><span>vim .env                    <span style=color:#8f5902;font-style:italic># Must modify SECRET_KEY_BASE</span>
</span></span><span style=display:flex><span>make up                      <span style=color:#8f5902;font-style:italic># Start Maybe service</span>
</span></span></code></pre></div><p>Access URL: <a href=http://maybe.pigsty>http://maybe.pigsty</a> or http://10.10.10.10:5002</p><h2 id=configuration>Configuration</h2><p>Configure in the <code>.env</code> file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>SECRET_KEY_BASE</span><span style=color:#ce5c00;font-weight:700>=</span>your-secret-key-here    <span style=color:#8f5902;font-style:italic># Must modify!</span>
</span></span><span style=display:flex><span><span style=color:#000>DATABASE_URL</span><span style=color:#ce5c00;font-weight:700>=</span>postgresql://...
</span></span></code></pre></div><p><strong>Important</strong>: You must modify <code>SECRET_KEY_BASE</code> before first deployment!</p><h2 id=features>Features</h2><ul><li><strong>Account Management</strong>: Track multiple bank accounts and credit cards</li><li><strong>Budget Planning</strong>: Set up and track budgets</li><li><strong>Investment Analysis</strong>: Monitor portfolio performance</li><li><strong>Bill Reminders</strong>: Automatic reminders for upcoming bills</li><li><strong>Privacy-first</strong>: Data is completely under your control</li></ul><h2 id=related-links>Related Links</h2><ul><li>GitHub Repository: <a href=https://github.com/maybe-finance/maybe>https://github.com/maybe-finance/maybe</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-170acad42811859443cc55f9cd346b6f>11 - Metabase: BI Analytics Tool</h1><div class=lead>Use Metabase for rapid business intelligence analysis with a user-friendly interface for team self-service data exploration.</div><p><a href=https://metabase.com/><strong>Metabase</strong></a> is a fast, easy-to-use open-source business intelligence tool that lets your team explore and visualize data without SQL knowledge.</p><p>Metabase provides a friendly user interface with rich chart types and supports connecting to various databases, making it an ideal choice for enterprise data analysis.</p><h2 id=quick-start>Quick Start</h2><p>Pigsty provides a Docker Compose configuration file for Metabase in the software template directory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/metabase
</span></span></code></pre></div><p>Review and modify the <code>.env</code> configuration file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim .env    <span style=color:#8f5902;font-style:italic># Check configuration, recommend changing default credentials</span>
</span></span></code></pre></div><p>Start the service:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up     <span style=color:#8f5902;font-style:italic># Start Metabase with Docker Compose</span>
</span></span></code></pre></div><p>Access Metabase:</p><ul><li>Default URL: <a href=http://metabase.pigsty>http://metabase.pigsty</a></li><li>Alternate URL: http://10.10.10.10:3001</li><li>First-time access requires initial setup</li></ul><h2 id=management-commands>Management Commands</h2><p>Pigsty provides convenient Makefile commands to manage Metabase:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up      <span style=color:#8f5902;font-style:italic># Start Metabase service</span>
</span></span><span style=display:flex><span>make run     <span style=color:#8f5902;font-style:italic># Start with Docker (connect to external PostgreSQL)</span>
</span></span><span style=display:flex><span>make view    <span style=color:#8f5902;font-style:italic># Display Metabase access URL</span>
</span></span><span style=display:flex><span>make log     <span style=color:#8f5902;font-style:italic># View container logs</span>
</span></span><span style=display:flex><span>make info    <span style=color:#8f5902;font-style:italic># View service details</span>
</span></span><span style=display:flex><span>make stop    <span style=color:#8f5902;font-style:italic># Stop the service</span>
</span></span><span style=display:flex><span>make clean   <span style=color:#8f5902;font-style:italic># Stop and remove containers</span>
</span></span><span style=display:flex><span>make pull    <span style=color:#8f5902;font-style:italic># Pull the latest image</span>
</span></span><span style=display:flex><span>make rmi     <span style=color:#8f5902;font-style:italic># Remove Metabase image</span>
</span></span><span style=display:flex><span>make save    <span style=color:#8f5902;font-style:italic># Save image to file</span>
</span></span><span style=display:flex><span>make load    <span style=color:#8f5902;font-style:italic># Load image from file</span>
</span></span></code></pre></div><h2 id=connect-to-postgresql>Connect to PostgreSQL</h2><p>Metabase can connect to PostgreSQL databases managed by Pigsty.</p><p>During Metabase initialization or when adding a database, select &ldquo;PostgreSQL&rdquo; and enter the connection information:</p><pre tabindex=0><code>Database Type: PostgreSQL
Name: Custom name (e.g., &#34;Production Database&#34;)
Host: 10.10.10.10
Port: 5432
Database Name: your_database
Username: dbuser_meta
Password: DBUser.Meta
</code></pre><p>After successful connection, Metabase will automatically scan the database schema, and you can start creating questions and dashboards.</p><h2 id=features>Features</h2><ul><li><strong>No SQL Required</strong>: Build queries through visual interface</li><li><strong>Rich Chart Types</strong>: Line, bar, pie, map charts, and more</li><li><strong>Interactive Dashboards</strong>: Create beautiful data dashboards</li><li><strong>Auto Refresh</strong>: Schedule data and dashboard updates</li><li><strong>Permission Management</strong>: Fine-grained user and data access control</li><li><strong>SQL Mode</strong>: Advanced users can write SQL directly</li><li><strong>Embedding</strong>: Embed charts into other applications</li><li><strong>Alerting</strong>: Automatic notifications on data changes</li></ul><h2 id=configuration>Configuration</h2><p>Metabase configuration is in the <code>.env</code> file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Metabase metadata database (PostgreSQL recommended)</span>
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_TYPE</span><span style=color:#ce5c00;font-weight:700>=</span>postgres
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_DBNAME</span><span style=color:#ce5c00;font-weight:700>=</span>metabase
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_PORT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5432</span>
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_USER</span><span style=color:#ce5c00;font-weight:700>=</span>dbuser_metabase
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_PASS</span><span style=color:#ce5c00;font-weight:700>=</span>DBUser.Metabase
</span></span><span style=display:flex><span><span style=color:#000>MB_DB_HOST</span><span style=color:#ce5c00;font-weight:700>=</span>10.10.10.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Application configuration</span>
</span></span><span style=display:flex><span><span style=color:#000>JAVA_OPTS</span><span style=color:#ce5c00;font-weight:700>=</span>-Xmx2g
</span></span></code></pre></div><p><strong>Recommended</strong>: Use a dedicated PostgreSQL database for storing Metabase metadata.</p><h2 id=data-persistence>Data Persistence</h2><p>Metabase metadata (users, questions, dashboards, etc.) is stored in the configured database.</p><p>If using H2 database (default), data is saved in the <code>/data/metabase</code> directory. Using PostgreSQL as the metadata database is strongly recommended for production environments.</p><h2 id=performance-optimization>Performance Optimization</h2><ul><li><strong>Use PostgreSQL</strong>: Replace the default H2 database</li><li><strong>Increase Memory</strong>: Add JVM memory with <code>JAVA_OPTS=-Xmx4g</code></li><li><strong>Database Indexes</strong>: Create indexes for frequently queried fields</li><li><strong>Result Caching</strong>: Enable Metabase query result caching</li><li><strong>Scheduled Updates</strong>: Set reasonable dashboard auto-refresh frequency</li></ul><h2 id=security-recommendations>Security Recommendations</h2><ol><li><strong>Change Default Credentials</strong>: Modify metadata database username and password</li><li><strong>Enable HTTPS</strong>: Configure SSL certificates for production</li><li><strong>Configure Authentication</strong>: Enable SSO or LDAP authentication</li><li><strong>Restrict Access</strong>: Limit access through firewall</li><li><strong>Regular Backups</strong>: Back up the Metabase metadata database</li></ol><h2 id=related-links>Related Links</h2><ul><li>Metabase Website: <a href=https://metabase.com/>https://metabase.com/</a></li><li>Documentation: <a href=https://www.metabase.com/docs/>https://www.metabase.com/docs/</a></li><li>GitHub Repository: <a href=https://github.com/metabase/metabase>https://github.com/metabase/metabase</a></li><li>Pigsty Software Template: <a href=https://github.com/pgsty/pigsty/tree/main/app/metabase>https://github.com/pgsty/pigsty/tree/main/app/metabase</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-2226656b7bf317b375be85683acc8130>12 - Kong: the Nginx API Gateway</h1><div class=lead>Learn how to deploy Kong, the API gateway, with Docker Compose and use external PostgreSQL as the backend database</div><p><img src=/img/docs/app/kong.jpeg alt></p><h2 id=tldr>TL;DR</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> app/kong <span style=color:#000;font-weight:700>;</span> docker-compose up -d
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up kong with docker-compose</span>
</span></span><span style=display:flex><span>make ui         <span style=color:#8f5902;font-style:italic># run swagger ui container</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f kong logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect kong with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop kong container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove kong container</span>
</span></span><span style=display:flex><span>make rmui       <span style=color:#8f5902;font-style:italic># remove swagger ui container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest kong image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove kong image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save kong image to /tmp/kong.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load kong image from /tmp</span>
</span></span></code></pre></div><h2 id=scripts>Scripts</h2><ul><li>Default Port: 8000</li><li>Default SSL Port: 8443</li><li>Default Admin Port: 8001</li><li>Default Postgres Database: <code>postgres://dbuser_kong:DBUser.Kong@10.10.10.10:5432/kong</code></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># postgres://dbuser_kong:DBUser.Kong@10.10.10.10:5432/kong</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: kong, owner: dbuser_kong, revokeconn: true , comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>kong the api gateway database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_kong, password: DBUser.Kong , pgbouncer: true , roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-fc62b9aad0217ff4dadd76e1e15633b6>13 - Registry: Container Image Mirror</h1><div class=lead>Deploy Docker Registry mirror service to accelerate Docker image pulls, especially useful for users in China.</div><p><a href=https://docs.docker.com/registry/><strong>Docker Registry</strong></a> mirror service caches images from Docker Hub and other registries.</p><p>Particularly useful for users in China or regions with slow Docker Hub access, significantly reducing image pull times.</p><h2 id=quick-start>Quick Start</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/registry
</span></span><span style=display:flex><span>make up     <span style=color:#8f5902;font-style:italic># Start Registry mirror service</span>
</span></span></code></pre></div><p>Access URL: <a href=http://registry.pigsty>http://registry.pigsty</a> or http://10.10.10.10:5000</p><h2 id=features>Features</h2><ul><li><strong>Image Caching</strong>: Cache images from Docker Hub and other registries</li><li><strong>Web Interface</strong>: Optional image management UI</li><li><strong>High Performance</strong>: Local caching dramatically improves pull speed</li><li><strong>Storage Management</strong>: Configurable cleanup and management policies</li><li><strong>Health Checks</strong>: Built-in health check endpoints</li></ul><h2 id=configure-docker>Configure Docker</h2><p>Configure Docker to use the local mirror:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Edit /etc/docker/daemon.json</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;registry-mirrors&#34;</span>: <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http://10.10.10.10:5000&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Restart Docker</span>
</span></span><span style=display:flex><span>systemctl restart docker
</span></span></code></pre></div><h2 id=storage-management>Storage Management</h2><p>Image data is stored in the <code>/data/registry</code> directory. Reserve at least 100GB of space.</p><h2 id=related-links>Related Links</h2><ul><li>Docker Registry Documentation: <a href=https://docs.docker.com/registry/>https://docs.docker.com/registry/</a></li><li>GitHub Repository: <a href=https://github.com/distribution/distribution>https://github.com/distribution/distribution</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-fa3dc992b76e9f32c26faddd8dccdb15>14 - Database Tools</h1><p>Database management and development tools</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9ab8e0a1cc0dd81586d666399930c331>15 - ByteBase: PG Schema Migration</h1><div class=lead>Self-hosting bytebase with PostgreSQL managed by Pigsty</div><h2 id=bytebase>ByteBase</h2><p><a href=https://bytebase.com/>ByteBase</a> is a database schema change management tool. The following command will start a ByteBase on the meta node <code>8887</code> port by default.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /data/bytebase/data<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>docker run --init --name bytebase --restart always --detach --publish 8887:8887 --volume /data/bytebase/data:/var/opt/bytebase <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span>    bytebase/bytebase:1.0.4 --data /var/opt/bytebase --host http://ddl.pigsty --port <span style=color:#0000cf;font-weight:700>8887</span>
</span></span></code></pre></div><p>Then visit http://10.10.10.10:8887/ or <a href=http://ddl.pigsty/>http://ddl.pigsty</a> to access bytebase console. You have to &ldquo;Create Project&rdquo;, &ldquo;Env&rdquo;, &ldquo;Instance&rdquo;, &ldquo;Database&rdquo; to perform schema migration.</p><p>Public Demo: <a href=http://ddl.pigsty.cc>http://ddl.pigsty.cc</a></p><p>Default username & password: <code>admin</code> / <code>pigsty</code></p><p><img src=/img/docs/app/bytebase.jpeg alt></p><hr><h2 id=bytebase-overview>Bytebase Overview</h2><p>Schema Migrator for PostgreSQL</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> app/bytebase<span style=color:#000;font-weight:700>;</span> make up
</span></span></code></pre></div><p>Visit <a href=http://ddl.pigsty>http://ddl.pigsty</a> or http://10.10.10.10:8887</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up bytebase with docker-compose in minimal mode</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># launch bytebase with docker , local data dir and external PostgreSQL</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># print bytebase access point</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f bytebase logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect bytebase with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop bytebase container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove bytebase container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest bytebase image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove bytebase image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save bytebase image to /tmp/bytebase.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load bytebase image from /tmp</span>
</span></span></code></pre></div><h2 id=postgresql-preparation>PostgreSQL Preparation</h2><p>Bytebase use its internal PostgreSQL database by default, You can use external PostgreSQL for higher durability.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># postgres://dbuser_bytebase:DBUser.Bytebase@10.10.10.10:5432/bytebase</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>db</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: bytebase, owner: dbuser_bytebase, comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>bytebase primary database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_bytebase , password: DBUser.Bytebase, roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>if you wish to user an external PostgreSQL, drop monitor extensions and views & pg_repack</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>DROP SCHEMA monitor CASCADE<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>DROP EXTENSION pg_repack<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><p>After bytebase initialized, you can create them back with <code>/pg/tmp/pg-init-template.sql</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql bytebase &lt; /pg/tmp/pg-init-template.sql
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8736e7e24609593e38bb4af51eacec86>16 - PGAdmin4: PG Admin GUI Tool</h1><div class=lead>Launch pgAdmin4 with docker, and load Pigsty server list into it</div><p>pgAdmin4 is a useful PostgreSQL management tool. Execute the following command to launch the pgadmin service on the admin node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/pgadmin <span style=color:#000;font-weight:700>;</span> docker-compose up -d
</span></span></code></pre></div><p>The default port for pgadmin is <code>8885</code>, and you can access it through the following address:</p><p><a href=http://adm.pigsty>http://adm.pigsty</a></p><hr><h2 id=demo>Demo</h2><p>Public Demo: <a href=http://adm.pigsty.cc>http://adm.pigsty.cc</a></p><p>Credentials: <code>admin@pigsty.cc</code> / <code>pigsty</code></p><p><img src=/img/docs/app/pgadmin.jpeg alt></p><h2 id=tl-dr>TL; DR</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/pgadmin   <span style=color:#8f5902;font-style:italic># enter docker compose dir</span>
</span></span><span style=display:flex><span>make up                   <span style=color:#8f5902;font-style:italic># launch pgadmin container</span>
</span></span><span style=display:flex><span>make conf view            <span style=color:#8f5902;font-style:italic># load pigsty server list</span>
</span></span></code></pre></div><p>Shortcuts:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up pgadmin with docker-compose</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># launch pgadmin with docker</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># print pgadmin access point</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f pgadmin logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect pgadmin with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop pgadmin container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove pgadmin container</span>
</span></span><span style=display:flex><span>make conf       <span style=color:#8f5902;font-style:italic># provision pgadmin with pigsty pg servers list</span>
</span></span><span style=display:flex><span>make dump       <span style=color:#8f5902;font-style:italic># dump servers.json from pgadmin container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest pgadmin image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove pgadmin image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save pgadmin image to /tmp/pgadmin.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load pgadmin image from /tmp</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-fbdf33ca77e7696092991f27dcf86e32>17 - PGWeb: Browser-based PG Client</h1><div class=lead>Launch pgweb to access PostgreSQL via web browser</div><p>PGWEB: <a href=https://github.com/sosedoff/pgweb>https://github.com/sosedoff/pgweb</a></p><p>Simple web-based and cross-platform PostgreSQL database explorer.</p><p>Public Demo: <a href=http://cli.pigsty.cc>http://cli.pigsty.cc</a></p><p><img src=/img/docs/app/pgweb.jpeg alt></p><h2 id=tl-dr>TL; DR</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/pgweb <span style=color:#000;font-weight:700>;</span> make up
</span></span></code></pre></div><p>Visit <a href=http://cli.pigsty>http://cli.pigsty</a> or http://10.10.10.10:8886</p><p>Try connecting with example URLs:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>postgres://dbuser_meta:DBUser.Meta@10.10.10.10:5432/meta?sslmode<span style=color:#ce5c00;font-weight:700>=</span>disable
</span></span><span style=display:flex><span>postgres://test:test@10.10.10.11:5432/test?sslmode<span style=color:#ce5c00;font-weight:700>=</span>disable
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up pgweb with docker compose</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># launch pgweb with docker</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># print pgweb access point</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f pgweb logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect pgweb with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop pgweb container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove pgweb container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest pgweb image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove pgweb image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save pgweb image to /tmp/docker/pgweb.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load pgweb image from /tmp/docker/pgweb.tgz</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-0e8785a96f30f0e01c2bfd365fb63b5a>18 - PostgREST: Generate REST API from Schema</h1><div class=lead>Launch postgREST to generate REST API from PostgreSQL schema automatically</div><p><a href=https://postgrest.org/en/stable/index.html>PostgREST</a> is a binary component that automatically generates a REST API
based on the PostgreSQL database schema.</p><p>For example, the following command will launch postgrest with docker (local port 8884, using default admin user, and
expose Pigsty CMDB schema):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --init --name postgrest --restart always --detach --publish 8884:8081 postgrest/postgrest
</span></span></code></pre></div><p>Visit <a href=http://10.10.10.10:8884/>http://10.10.10.10:8884</a> will show all auto-generated API definitions and automatically
expose API documentation using <a href=http://home.pigsty.cc:8883>Swagger Editor</a>.</p><p>If you wish to perform CRUD operations and design more fine-grained permission control, please refer
to <a href=https://postgrest.org/en/stable/tutorials/tut1.html>Tutorial 1 - The Golden Key</a> to generate a signed JWT.</p><p><img src=/img/docs/app/postgrest.jpeg alt></p><p>This is an example of creating pigsty cmdb API with PostgREST</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/postgrest <span style=color:#000;font-weight:700>;</span> docker-compose up -d
</span></span></code></pre></div><p>http://10.10.10.10:8884 is the default endpoint for PostgREST</p><p>http://10.10.10.10:8883 is the default api docs for PostgREST</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up postgrest with docker-compose</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># launch postgrest with docker</span>
</span></span><span style=display:flex><span>make ui         <span style=color:#8f5902;font-style:italic># run swagger ui container</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># print postgrest access point</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f postgrest logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect postgrest with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop postgrest container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove postgrest container</span>
</span></span><span style=display:flex><span>make rmui       <span style=color:#8f5902;font-style:italic># remove swagger ui container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest postgrest image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove postgrest image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save postgrest image to /tmp/postgrest.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load postgrest image from /tmp</span>
</span></span></code></pre></div><h2 id=swagger-ui>Swagger UI</h2><p>Launch a swagger OpenAPI UI and visualize PostgREST API on 8883 with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --init --name postgrest --name swagger -p 8883:8080 -e <span style=color:#000>API_URL</span><span style=color:#ce5c00;font-weight:700>=</span>http://10.10.10.10:8884 swaggerapi/swagger-ui
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># docker run -d -e API_URL=http://10.10.10.10:8884 -p 8883:8080 swaggerapi/swagger-editor # swagger editor</span>
</span></span></code></pre></div><p>Check <a href=http://10.10.10.10:8883/>http://10.10.10.10:8883/</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-fa5656811a158b156712d00725b47fea>19 - Electric: PGLite Sync Engine</h1><div class=lead>Use Electric to solve PostgreSQL data synchronization challenges with partial replication and real-time data transfer.</div><p><a href=https://electric-sql.com/><strong>Electric</strong></a> is a PostgreSQL sync engine that solves complex data synchronization problems.</p><p>Electric supports partial replication, fan-out delivery, and efficient data transfer, making it ideal for building real-time and offline-first applications.</p><h2 id=quick-start>Quick Start</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/electric
</span></span><span style=display:flex><span>make up     <span style=color:#8f5902;font-style:italic># Start Electric service</span>
</span></span></code></pre></div><p>Access URL: <a href=http://electric.pigsty>http://electric.pigsty</a> or http://10.10.10.10:3000</p><h2 id=features>Features</h2><ul><li><strong>Partial Replication</strong>: Sync only the data you need</li><li><strong>Real-time Sync</strong>: Millisecond-level data updates</li><li><strong>Offline-first</strong>: Work offline with automatic sync</li><li><strong>Conflict Resolution</strong>: Automatic handling of data conflicts</li><li><strong>Type Safety</strong>: TypeScript support</li></ul><h2 id=related-links>Related Links</h2><ul><li>Electric Website: <a href=https://electric-sql.com/>https://electric-sql.com/</a></li><li>Documentation: <a href=https://electric-sql.com/docs>https://electric-sql.com/docs</a></li><li>GitHub Repository: <a href=https://github.com/electric-sql/electric>https://github.com/electric-sql/electric</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-34724279579b562c276e6051f843c660>20 - Jupyter: AI Notebook & IDE</h1><div class=lead>Run Jupyter Lab in container, and access PostgreSQL database</div><p>Run jupyter notebook with docker, you have to:</p><ul><li><ol><li>change the default password in <a href=.env><code>.env</code></a>: <code>JUPYTER_TOKEN</code></li></ol></li><li><ol start=2><li>create data dir with proper permission: <code>make dir</code>, owned by <code>1000:100</code></li></ol></li><li><ol start=3><li><code>make up</code> to pull up jupyter with docker compose</li></ol></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty/app/jupyter <span style=color:#000;font-weight:700>;</span> make dir up
</span></span></code></pre></div><p>Visit <a href=http://lab.pigsty>http://lab.pigsty</a> or http://10.10.10.10:8888, the default password is <code>pigsty</code></p><ul><li><a href="http://lab.pigsty?token=pigsty"><code>http://lab.pigsty?token=pigsty</code></a></li></ul><h2 id=prepare>Prepare</h2><p>Create a data directory <code>/data/jupyter</code>, with the default uid & gid <code>1000:100</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make dir   <span style=color:#8f5902;font-style:italic># mkdir -p /data/jupyter; chown -R 1000:100 /data/jupyter</span>
</span></span></code></pre></div><h2 id=connect-to-postgres>Connect to Postgres</h2><p>Use the jupyter terminal to install <code>psycopg2-binary</code> & <code>psycopg2</code> package.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install psycopg2-binary psycopg2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># install with a mirror</span>
</span></span><span style=display:flex><span>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple psycopg2-binary psycopg2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pip install --upgrade pip
</span></span><span style=display:flex><span>pip config <span style=color:#204a87>set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
</span></span></code></pre></div><p>Or installation with <code>conda</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
</span></span><span style=display:flex><span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
</span></span><span style=display:flex><span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
</span></span></code></pre></div><p>then use the driver in your notebook</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>psycopg2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>psycopg2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>connect</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;postgres://dbuser_dba:DBUser.DBA@10.10.10.10:5432/meta&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>cursor</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>conn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>cursor</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>cursor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>execute</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;SELECT * FROM pg_stat_activity&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>cursor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fetchall</span><span style=color:#000;font-weight:700>():</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=alias>Alias</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make up         <span style=color:#8f5902;font-style:italic># pull up jupyter with docker compose</span>
</span></span><span style=display:flex><span>make dir        <span style=color:#8f5902;font-style:italic># create required /data/jupyter and set owner</span>
</span></span><span style=display:flex><span>make run        <span style=color:#8f5902;font-style:italic># launch jupyter with docker</span>
</span></span><span style=display:flex><span>make view       <span style=color:#8f5902;font-style:italic># print jupyter access point</span>
</span></span><span style=display:flex><span>make log        <span style=color:#8f5902;font-style:italic># tail -f jupyter logs</span>
</span></span><span style=display:flex><span>make info       <span style=color:#8f5902;font-style:italic># introspect jupyter with jq</span>
</span></span><span style=display:flex><span>make stop       <span style=color:#8f5902;font-style:italic># stop jupyter container</span>
</span></span><span style=display:flex><span>make clean      <span style=color:#8f5902;font-style:italic># remove jupyter container</span>
</span></span><span style=display:flex><span>make pull       <span style=color:#8f5902;font-style:italic># pull latest jupyter image</span>
</span></span><span style=display:flex><span>make rmi        <span style=color:#8f5902;font-style:italic># remove jupyter image</span>
</span></span><span style=display:flex><span>make save       <span style=color:#8f5902;font-style:italic># save jupyter image to /tmp/docker/jupyter.tgz</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load jupyter image from /tmp/docker/jupyter.tgz</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b3405ffde24b58619b4d32980b9155a0>21 - Data Applications</h1><p>PostgreSQL-based data visualization applications</p></div><div class=td-content style=page-break-before:always><h1 id=pg-af33a915aa5ea40ca1b93854fbd8da8e>22 - PGLOG: PostgreSQL Log Analysis Application</h1><div class=lead>A sample Applet included with Pigsty for analyzing PostgreSQL CSV log samples</div><p>PGLOG is a sample application included with Pigsty that uses the <code>pglog.sample</code> table in MetaDB as its data source. You simply need to load logs into this table, then access the related dashboard.</p><p>Pigsty provides convenient commands for pulling CSV logs and loading them into the sample table. On the meta node, the following shortcut commands are available by default:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>catlog  <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>=</span>localhost<span style=color:#ce5c00;font-weight:700>]</span>  <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>date</span><span style=color:#ce5c00;font-weight:700>=</span>today<span style=color:#ce5c00;font-weight:700>]</span>   <span style=color:#8f5902;font-style:italic># Print CSV log to stdout</span>
</span></span><span style=display:flex><span>pglog                                    <span style=color:#8f5902;font-style:italic># Load CSVLOG from stdin</span>
</span></span><span style=display:flex><span>pglog12                                  <span style=color:#8f5902;font-style:italic># Load PG12 format CSVLOG</span>
</span></span><span style=display:flex><span>pglog13                                  <span style=color:#8f5902;font-style:italic># Load PG13 format CSVLOG</span>
</span></span><span style=display:flex><span>pglog14                                  <span style=color:#8f5902;font-style:italic># Load PG14 format CSVLOG (=pglog)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>catlog <span style=color:#000;font-weight:700>|</span> pglog                       <span style=color:#8f5902;font-style:italic># Analyze current node&#39;s log for today</span>
</span></span><span style=display:flex><span>catlog node-1 <span style=color:#4e9a06>&#39;2021-07-15&#39;</span> <span style=color:#000;font-weight:700>|</span> pglog   <span style=color:#8f5902;font-style:italic># Analyze node-1&#39;s csvlog for 2021-07-15</span>
</span></span></code></pre></div><p>Next, you can access the following links to view the sample log analysis interface.</p><ul><li><a href=https://demo.pigsty.io/d/pglog-overview>PGLOG Overview</a>: Present the entire CSV log sample details, aggregated by multiple dimensions.</li></ul><p><a href=https://demo.pigsty.io/d/pglog-overview><img src=/img/dashboard/pglog-overview.jpg alt></a></p><ul><li><a href=https://demo.pigsty.io/d/pglog-session>PGLOG Session</a>: Present detailed information about a specific connection in the log sample.</li></ul><p><a href=https://demo.pigsty.io/d/pglog-session><img src=/img/dashboard/pglog-session.jpg alt></a></p><p>The <code>catlog</code> command pulls CSV database logs from a specific node for a specific date and writes to <code>stdout</code></p><p>By default, <code>catlog</code> pulls logs from the current node for today. You can specify the node and date through parameters.</p><p>Using <code>pglog</code> and <code>catlog</code> together, you can quickly pull database CSV logs for analysis.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>catlog <span style=color:#000;font-weight:700>|</span> pglog                       <span style=color:#8f5902;font-style:italic># Analyze current node&#39;s log for today</span>
</span></span><span style=display:flex><span>catlog node-1 <span style=color:#4e9a06>&#39;2021-07-15&#39;</span> <span style=color:#000;font-weight:700>|</span> pglog   <span style=color:#8f5902;font-style:italic># Analyze node-1&#39;s csvlog for 2021-07-15</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-3bf0cdc122adbb3c6315d77456eb4a70>23 - NOAA ISD Global Weather Station Historical Data Query</h1><div class=lead>Demonstrate how to import data into a database using the ISD dataset as an example</div><p>If you have a database and don&rsquo;t know what to do with it, why not try this open-source project: <a href=https://github.com/Vonng/isd>Vonng/isd</a></p><p>You can directly reuse the monitoring system Grafana to interactively browse sub-hourly meteorological data from nearly 30,000 surface weather stations over the past 120 years.</p><p>This is a fully functional data application that can query meteorological observation records from 30,000 global surface weather stations since 1901.</p><p>Project URL: <a href=https://github.com/Vonng/isd>https://github.com/Vonng/isd</a></p><p>Online Demo: <a href=https://demo.pigsty.io/d/isd-overview>https://demo.pigsty.io/d/isd-overview</a></p><p><a href=https://demo.pigsty.io/d/isd-overview><img src=/img/docs/app/isd-overview.jpg alt=isd-overview.jpg></a></p><h2 id=quick-start>Quick Start</h2><p><strong>Clone this repository</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/Vonng/isd.git<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> isd<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><p><strong>Prepare a PostgreSQL instance</strong></p><p>The PostgreSQL instance should have the PostGIS extension enabled. Use the <code>PGURL</code> environment variable to pass database connection information:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Pigsty uses dbuser_dba as the default admin account with password DBUser.DBA</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>PGURL</span><span style=color:#ce5c00;font-weight:700>=</span>postgres://dbuser_dba:DBUser.DBA@127.0.0.1:5432/meta?sslmode<span style=color:#ce5c00;font-weight:700>=</span>disable
</span></span><span style=display:flex><span>psql <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> -c <span style=color:#4e9a06>&#39;SELECT 1&#39;</span>  <span style=color:#8f5902;font-style:italic># Check if connection is available</span>
</span></span></code></pre></div><p><strong>Fetch and import ISD weather station metadata</strong></p><p>This is a daily-updated weather station metadata file containing station longitude/latitude, elevation, name, country, province, and other information. Use the following command to download and import:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make reload-station   <span style=color:#8f5902;font-style:italic># Equivalent to downloading the latest station data then loading: get-station + load-station</span>
</span></span></code></pre></div><p><strong>Fetch and import the latest <code>isd.daily</code> data</strong></p><p><code>isd.daily</code> is a daily-updated dataset containing daily observation data summaries from global weather stations. Use the following command to download and import.
Note that raw data downloaded directly from the NOAA website needs to be <strong>parsed</strong> before it can be loaded into the database, so you need to download or build an ISD data parser.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make get-parser       <span style=color:#8f5902;font-style:italic># Download the parser binary from Github, or you can build directly with go using make build</span>
</span></span><span style=display:flex><span>make reload-daily     <span style=color:#8f5902;font-style:italic># Download and import the latest isd.daily data for this year into the database</span>
</span></span></code></pre></div><p><strong>Load pre-parsed CSV dataset</strong></p><p>The ISD Daily dataset has some dirty data and <a href=https://github.com/Vonng/isd/blob/master/doc/isd-daily-caveat.md>duplicate data</a>. If you don&rsquo;t want to manually parse and clean it, a stable pre-parsed CSV dataset is also provided here.</p><p>This dataset contains <code>isd.daily</code> data up to 2023-06-24. You can download and import it directly into PostgreSQL without needing a parser.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make get-stable       <span style=color:#8f5902;font-style:italic># Get the stable isd.daily historical dataset from Github</span>
</span></span><span style=display:flex><span>make load-stable      <span style=color:#8f5902;font-style:italic># Load the downloaded stable historical dataset into the PostgreSQL database</span>
</span></span></code></pre></div><h2 id=more-data>More Data</h2><p>Two parts of the ISD dataset are updated daily: weather station metadata and the latest year&rsquo;s <code>isd.daily</code> (e.g., the 2023 tarball).</p><p>You can use the following command to download and refresh these two parts. If the dataset hasn&rsquo;t been updated, these commands won&rsquo;t re-download the same data package:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make reload           <span style=color:#8f5902;font-style:italic># Actually: reload-station + reload-daily</span>
</span></span></code></pre></div><p>You can also use the following commands to download and load <code>isd.daily</code> data for a specific year:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/get-daily  <span style=color:#0000cf;font-weight:700>2022</span>                   <span style=color:#8f5902;font-style:italic># Get daily weather observation summary for 2022 (1900-2023)</span>
</span></span><span style=display:flex><span>bin/load-daily <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#0000cf;font-weight:700>2022</span>        <span style=color:#8f5902;font-style:italic># Load daily weather observation summary for 2022 (1900-2023)</span>
</span></span></code></pre></div><p>In addition to the daily summary <code>isd.daily</code>, ISD also provides more detailed sub-hourly raw observation records <code>isd.hourly</code>. The download and load methods are similar:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/get-hourly  <span style=color:#0000cf;font-weight:700>2022</span>                  <span style=color:#8f5902;font-style:italic># Download hourly observation records for a specific year (e.g., 2022, options 1900-2023)</span>
</span></span><span style=display:flex><span>bin/load-hourly <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#0000cf;font-weight:700>2022</span>       <span style=color:#8f5902;font-style:italic># Load hourly observation records for a specific year</span>
</span></span></code></pre></div><h2 id=data>Data</h2><h3 id=dataset-overview>Dataset Overview</h3><p>ISD provides four datasets: sub-hourly raw observation data, daily statistical summary data, monthly statistical summary, and yearly statistical summary</p><table><thead><tr><th>Dataset</th><th>Notes</th></tr></thead><tbody><tr><td>ISD Hourly</td><td>Sub-hourly observation records</td></tr><tr><td>ISD Daily</td><td>Daily statistical summary</td></tr><tr><td>ISD Monthly</td><td>Not used, can be calculated from <code>isd.daily</code></td></tr><tr><td>ISD Yearly</td><td>Not used, can be calculated from <code>isd.daily</code></td></tr></tbody></table><p><strong>Daily Summary Dataset</strong></p><ul><li>Compressed package size 2.8GB (as of 2023-06-24)</li><li>Table size 24GB, index size 6GB, total size approximately 30GB in PostgreSQL</li><li>If timescaledb compression is enabled, total size can be compressed to 4.5 GB</li></ul><p><strong>Sub-hourly Observation Data</strong></p><ul><li>Total compressed package size 117GB</li><li>After loading into database: table size 1TB+, index size 600GB+, total size 1.6TB</li></ul><h3 id=database-schema>Database Schema</h3><p><strong>Weather Station Metadata Table</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>isd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>station</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>station</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>usaf</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>substring</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>station</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wban</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>substring</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>station</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>name</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>country</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>province</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>icao</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>location</span><span style=color:#f8f8f8>   </span><span style=color:#000>GEOMETRY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>POINT</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>longitude</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Round</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ST_X</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>location</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>latitude</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Round</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ST_Y</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>location</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>elevation</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>period</span><span style=color:#f8f8f8>     </span><span style=color:#000>daterange</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>begin_date</span><span style=color:#f8f8f8> </span><span style=color:#204a87>DATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>lower</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>period</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>end_date</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>DATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>GENERATED</span><span style=color:#f8f8f8> </span><span style=color:#000>ALWAYS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>upper</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>period</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#000>STORED</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>Daily Summary Table</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>isd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>daily</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>station</span><span style=color:#f8f8f8>     </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- station number 6USAF+5WBAN
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>ts</span><span style=color:#f8f8f8>          </span><span style=color:#204a87>DATE</span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- observation date
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Temperature &amp; Dew Point
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_mean</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- mean temperature ℃
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_min</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- min temperature ℃
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_max</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- max temperature ℃
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>dewp_mean</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- mean dew point ℃
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Air Pressure
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>slp_mean</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- sea level pressure (hPa)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>stp_mean</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- station pressure (hPa)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Visibility
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>vis_mean</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- visible distance (m)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Wind Speed
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wdsp_mean</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- average wind speed (m/s)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wdsp_max</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- max wind speed (m/s)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>gust</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- max wind gust (m/s)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Precipitation / Snow Depth
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp_mean</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- precipitation (mm)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- rectified precipitation (mm)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>sndp</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NuMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- snow depth (mm)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- FRSHTT (Fog/Rain/Snow/Hail/Thunder/Tornado)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_foggy</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (F)og
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_rainy</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (R)ain or Drizzle
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_snowy</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (S)now or pellets
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_hail</span><span style=color:#f8f8f8>     </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (H)ail
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_thunder</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (T)hunder
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>is_tornado</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- (T)ornado or Funnel Cloud
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Record counts used for statistical aggregation
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_count</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for temp
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>dewp_count</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for dew point
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>slp_count</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for sea level pressure
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>stp_count</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for station pressure
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wdsp_count</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for wind speed
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>visib_count</span><span style=color:#f8f8f8> </span><span style=color:#204a87>SMALLINT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic>-- record count for visible distance
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- Temperature flags
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_min_f</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- aggregate min temperature
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp_max_f</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>BOOLEAN</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic>-- aggregate max temperature
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp_flag</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>CHAR</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic>-- precipitation flag: ABCDEFGHI
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>station</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>ts</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- PARTITION BY RANGE (ts);
</span></span></span></code></pre></div><p><strong>Sub-hourly Raw Observation Data Table</strong></p><details><summary>ISD Hourly</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>isd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>hourly</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>station</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- station id
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>ts</span><span style=color:#f8f8f8>         </span><span style=color:#204a87;font-weight:700>TIMESTAMP</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- timestamp
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- air
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>temp</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [-93.2,+61.8]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>dewp</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [-98.2,+36.8]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>slp</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [8600,10900]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>stp</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [4500,10900]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>vis</span><span style=color:#f8f8f8>        </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- [0,160000]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- wind
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wd_angle</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- [1,360]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wd_speed</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [0,90]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wd_gust</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- [0,110]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>wd_code</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- code that denotes the character of the WIND-OBSERVATION.
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- cloud
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>cld_height</span><span style=color:#f8f8f8> </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- [0,22000]
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>cld_code</span><span style=color:#f8f8f8>   </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- cloud code
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- water
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>sndp</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- mm snow
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp</span><span style=color:#f8f8f8>       </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- mm precipitation
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp_hour</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- precipitation duration in hour
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>prcp_code</span><span style=color:#f8f8f8>  </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- precipitation type code
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- sky
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>mw_code</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- manual weather observation code
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>aw_code</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- auto weather observation code
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>pw_code</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- weather code of past period of time
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>pw_hour</span><span style=color:#f8f8f8>    </span><span style=color:#204a87>NUMERIC</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic>-- duration of pw_code period
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- misc
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- remark     TEXT,
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>-- eqd        TEXT,
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>data</span><span style=color:#f8f8f8>       </span><span style=color:#000>JSONB</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic>-- extra data
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#000>PARTITION</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8> </span><span style=color:#000>RANGE</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ts</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></details><h2 id=parser>Parser</h2><p>The raw data provided by NOAA ISD is in a highly compressed proprietary format that needs to be processed through a parser before it can be converted into database table format.</p><p>For the Daily and Hourly datasets, two parsers are provided here: <a href=https://github.com/Vonng/isd/blob/master/parser/isdd/isdd.go><code>isdd</code></a> and <a href=https://github.com/Vonng/isd/blob/master/parser/isdh/isdh.go><code>isdh</code></a>.
Both parsers take annual data compressed packages as input, produce CSV results as output, and work in pipeline mode as shown below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>        isd -- Intergrated Surface Dataset Parser
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SYNOPSIS
</span></span><span style=display:flex><span>        isd daily   <span style=color:#ce5c00;font-weight:700>[</span>-i &lt;input<span style=color:#000;font-weight:700>|</span>stdin&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>-o &lt;output<span style=color:#000;font-weight:700>|</span>stout&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>-v<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>        isd hourly  <span style=color:#ce5c00;font-weight:700>[</span>-i &lt;input<span style=color:#000;font-weight:700>|</span>stdin&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>-o &lt;output<span style=color:#000;font-weight:700>|</span>stout&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>-v<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>-d raw<span style=color:#000;font-weight:700>|</span>ts-first<span style=color:#000;font-weight:700>|</span>hour-first<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DESCRIPTION
</span></span><span style=display:flex><span>        The isd program takes noaa isd daily/hourly raw tarball data as input.
</span></span><span style=display:flex><span>        and generate parsed data in csv format as output. Works in pipe mode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        cat data/daily/2023.tar.gz <span style=color:#000;font-weight:700>|</span> bin/isd daily -v <span style=color:#000;font-weight:700>|</span> psql <span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span> -AXtwqc <span style=color:#4e9a06>&#34;COPY isd.daily FROM STDIN CSV;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        isd daily  -v -i data/daily/2023.tar.gz  <span style=color:#000;font-weight:700>|</span> psql <span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span> -AXtwqc <span style=color:#4e9a06>&#34;COPY isd.daily FROM STDIN CSV;&#34;</span>
</span></span><span style=display:flex><span>        isd hourly -v -i data/hourly/2023.tar.gz <span style=color:#000;font-weight:700>|</span> psql <span style=color:#4e9a06>${</span><span style=color:#000>PGURL</span><span style=color:#4e9a06>}</span> -AXtwqc <span style=color:#4e9a06>&#34;COPY isd.hourly FROM STDIN CSV;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OPTIONS
</span></span><span style=display:flex><span>        -i  &lt;input&gt;     input file, stdin by default
</span></span><span style=display:flex><span>        -o  &lt;output&gt;    output file, stdout by default
</span></span><span style=display:flex><span>        -p  &lt;profpath&gt;  pprof file path, <span style=color:#204a87>enable</span> <span style=color:#204a87;font-weight:700>if</span> specified
</span></span><span style=display:flex><span>        -d              de-duplicate rows <span style=color:#204a87;font-weight:700>for</span> hourly dataset <span style=color:#ce5c00;font-weight:700>(</span>raw, ts-first, hour-first<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        -v              verbose mode
</span></span><span style=display:flex><span>        -h              print <span style=color:#204a87>help</span>
</span></span></code></pre></div><hr><h2 id=user-interface>User Interface</h2><p>Several dashboards made with Grafana are provided here for exploring the ISD dataset and querying weather stations and historical meteorological data.</p><hr><p><strong>ISD Overview</strong></p><p>Global overview with overall metrics and weather station navigation.</p><p><img src=/img/docs/app/isd-overview.jpg alt=isd-overview.jpg></p><hr><p><strong>ISD Country</strong></p><p>Display all weather stations within a single country/region.</p><p><img src=/img/docs/app/isd-country.jpg alt=isd-country.jpg></p><hr><p><strong>ISD Station</strong></p><p>Display detailed information for a single weather station, including metadata and daily/monthly/yearly summary metrics.</p><details><summary>ISD Station Dashboard</summary><p><img src=/img/docs/app/isd-station.jpg alt=isd-station.jpg></p></details><hr><p><strong>ISD Detail</strong></p><p>Display raw sub-hourly observation metric data for a weather station, requires the <code>isd.hourly</code> dataset.</p><details><summary>ISD Station Dashboard</summary><p><img src=/img/docs/app/isd-detail.jpg alt=isd-detail.jpg></p></details><br><br><br></div><div class=td-content style=page-break-before:always><h1 id=pg-f2f527c6f73d059e66947f8c86fd4b49>24 - WHO COVID-19 Pandemic Dashboard</h1><div class=lead>A sample Applet included with Pigsty for visualizing World Health Organization official pandemic data</div><p>Covid is a sample Applet included with Pigsty for visualizing the World Health Organization&rsquo;s official pandemic data dashboard.</p><p>You can browse COVID-19 infection and death cases for each country and region, as well as global pandemic trends.</p><hr><h2 id=overview>Overview</h2><p>GitHub Repository: <a href=https://github.com/pgsty/pigsty-app/tree/master/covid>https://github.com/pgsty/pigsty-app/tree/master/covid</a></p><p>Online Demo: <a href=https://demo.pigsty.io/d/covid>https://demo.pigsty.io/d/covid</a></p><p><a href=https://demo.pigsty.io/d/covid><img src=/img/docs/app/covid.jpg alt></a></p><hr><h2 id=installation>Installation</h2><p>Enter the application directory on the admin node and execute <code>make</code> to complete the installation.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make            <span style=color:#8f5902;font-style:italic># Complete all configuration</span>
</span></span></code></pre></div><p>Other sub-tasks:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make reload     <span style=color:#8f5902;font-style:italic># download latest data and pour it again</span>
</span></span><span style=display:flex><span>make ui         <span style=color:#8f5902;font-style:italic># install grafana dashboards</span>
</span></span><span style=display:flex><span>make sql        <span style=color:#8f5902;font-style:italic># install database schemas</span>
</span></span><span style=display:flex><span>make download   <span style=color:#8f5902;font-style:italic># download latest data</span>
</span></span><span style=display:flex><span>make load       <span style=color:#8f5902;font-style:italic># load downloaded data into database</span>
</span></span><span style=display:flex><span>make reload     <span style=color:#8f5902;font-style:italic># download latest data and pour it into database</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-41257227641757f696b35683a37345dd>25 - StackOverflow Global Developer Survey</h1><div class=lead>Analyze database-related data from StackOverflow&rsquo;s global developer survey over the past seven years</div><hr><h2 id=overview>Overview</h2><p>GitHub Repository: <a href=https://github.com/pgsty/pigsty-app/tree/master/db>https://github.com/pgsty/pigsty-app/tree/master/db</a></p><p>Online Demo: <a href=https://demo.pigsty.io/d/sf-survey>https://demo.pigsty.io/d/sf-survey</a></p><p><a href=https://demo.pigsty.io/d/sf-survey><img src=/img/docs/app/sf-survey.jpg alt></a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-71c4afe134c6d0768ee52d9ca11f5242>26 - DB-Engines Database Popularity Trend Analysis</h1><div class=lead>Analyze database management systems on DB-Engines and browse their popularity evolution</div><hr><h2 id=overview>Overview</h2><p>GitHub Repository: <a href=https://github.com/pgsty/pigsty-app/tree/master/db>https://github.com/pgsty/pigsty-app/tree/master/db</a></p><p>Online Demo: <a href=https://demo.pigsty.io/d/db-engine>https://demo.pigsty.io/d/db-engine</a></p><p><a href=https://demo.pigsty.io/d/db-engine><img src=/img/docs/app/db-engine.jpg alt></a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-90bea0e09fc3821f240f24c4f991c6a8>27 - AWS & Aliyun Server Pricing</h1><div class=lead>Analyze compute and storage pricing on Aliyun / AWS (ECS/ESSD)</div><hr><h2 id=overview>Overview</h2><p>GitHub Repository: <a href=https://github.com/pgsty/pigsty-app/tree/master/cloud>https://github.com/pgsty/pigsty-app/tree/master/cloud</a></p><p>Online Demo: <a href=https://demo.pigsty.io/d/ecs>https://demo.pigsty.io/d/ecs</a></p><p>Article: <a href=/blog/cloud/ecs>Analyzing Computing Costs: Has Aliyun Really Reduced Prices?</a></p><h2 id=data-source>Data Source</h2><p>Aliyun ECS pricing can be obtained as raw CSV data from <a href=https://www.aliyun.com/price/product#/commodity/vm>Price Calculator - Pricing Details - Price Download</a>.</p><h2 id=schema>Schema</h2><p>Download Aliyun pricing details and import for analysis</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#000>EXTENSION</span><span style=color:#f8f8f8> </span><span style=color:#000>file_fdw</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#000>SERVER</span><span style=color:#f8f8f8> </span><span style=color:#000>fs</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>DATA</span><span style=color:#f8f8f8> </span><span style=color:#000>WRAPPER</span><span style=color:#f8f8f8> </span><span style=color:#000>file_fdw</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>aliyun_ecs</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>CASCADE</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>aliyun_ecs</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;region&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;system&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;network&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;isIO&#34;</span><span style=color:#f8f8f8> </span><span style=color:#000>bool</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;instanceId&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;hourlyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;weeklyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;standard&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;monthlyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;yearlyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;2yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;3yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;4yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;5yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;instanceLabel&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;familyId&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;serverType&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;cpu&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;localStorage&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;NvmeSupport&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceFamilyLevel&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EniTrunkSupported&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstancePpsRx&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;GPUSpec&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;CpuTurboFrequency&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstancePpsTx&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceTypeId&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;GPUAmount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceTypeFamily&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;SecondaryEniQueueNumber&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EniQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EniPrivateIpAddressQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;DiskQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EniIpv6AddressQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceCategory&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;CpuArchitecture&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EriQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;MemorySize&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;EniTotalQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;PhysicalProcessorModel&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceBandwidthRx&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;Generation&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;CpuSpeedFrequency&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>numeric</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;PrimaryEniQueueNumber&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;LocalStorageCategory&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceBandwidthTx&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;TotalEniQueueQuantity&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>text</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#000>SERVER</span><span style=color:#f8f8f8> </span><span style=color:#000>fs</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>OPTIONS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8> </span><span style=color:#000>filename</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/tmp/aliyun-ecs.csv&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>format</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;csv&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>header</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Similarly for AWS EC2, you can download the price list from Vantage:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>aws_ec2</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>CASCADE</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>aws_ec2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;Memory&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;vCPUs&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;GPUs&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;ClockSpeed&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;InstanceStorage&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;NetworkPerformance&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;ondemand&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;reserve&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#4e9a06>&#34;spot&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#000>SERVER</span><span style=color:#f8f8f8> </span><span style=color:#000>fs</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>OPTIONS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8> </span><span style=color:#000>filename</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/tmp/aws-ec2.csv&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>format</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;csv&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>header</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>VIEW</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>ecs</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>VIEW</span><span style=color:#f8f8f8> </span><span style=color:#000>ecs</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;region&#34;</span><span style=color:#f8f8f8>                                       </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>region</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#f8f8f8>                                           </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;instanceLabel&#34;</span><span style=color:#f8f8f8>                                </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;familyId&#34;</span><span style=color:#f8f8f8>                                     </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>family</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8>                                 </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>cpu</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;MemorySize&#34;</span><span style=color:#f8f8f8>                                   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>mem</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;5yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycm5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;4yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>48</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycm4</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;3yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>36</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycm3</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;2yearPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>24</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycm2</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;yearlyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycm1</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;standard&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>          </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycmm</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;hourlyPrice&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CpuCoreCount&#34;</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>720</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ycmh</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- ¥ / (core·month)
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;CpuSpeedFrequency&#34;</span><span style=color:#000;font-weight:700>::</span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8>                   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>freq</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;CpuTurboFrequency&#34;</span><span style=color:#000;font-weight:700>::</span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8>                   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>freq_turbo</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;Generation&#34;</span><span style=color:#f8f8f8>                                   </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>generation</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>aliyun_ecs</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>WHERE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>system</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;linux&#39;</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>VIEW</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>ec2</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>VIEW</span><span style=color:#f8f8f8> </span><span style=color:#000>ec2</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>split_part</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;.&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>                                                               </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>family</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>split_part</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;.&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>                                                               </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>spec</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>regexp_match</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>split_part</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;.&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;^[a-zA-Z]+(\d)[a-z0-9]*&#39;</span><span style=color:#000;font-weight:700>))[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>                 </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>gen</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>regexp_substr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;vCPUs&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;^[0-9]+&#39;</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>int</span><span style=color:#f8f8f8>                                               </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>cpu</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#000>regexp_substr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Memory&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;^[0-9]+&#39;</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>int</span><span style=color:#f8f8f8>                                              </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>mem</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#204a87;font-weight:700>CASE</span><span style=color:#f8f8f8> </span><span style=color:#000>spot</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>WHEN</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;unavailable&#39;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>THEN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>ELSE</span><span style=color:#f8f8f8> </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>regexp_substr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;spot&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;([0-9]+.[0-9]+)&#39;</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>END</span><span style=color:#f8f8f8>     </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>spot</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#204a87;font-weight:700>CASE</span><span style=color:#f8f8f8> </span><span style=color:#000>ondemand</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>WHEN</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;unavailable&#39;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>THEN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>ELSE</span><span style=color:#f8f8f8> </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>regexp_substr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;ondemand&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;([0-9]+.[0-9]+)&#39;</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>END</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>ondemand</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#204a87;font-weight:700>CASE</span><span style=color:#f8f8f8> </span><span style=color:#000>reserve</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>WHEN</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;unavailable&#39;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>THEN</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>           </span><span style=color:#204a87;font-weight:700>ELSE</span><span style=color:#f8f8f8> </span><span style=color:#000>round</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>regexp_substr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;reserve&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;([0-9]+.[0-9]+)&#39;</span><span style=color:#000;font-weight:700>)::</span><span style=color:#204a87>NUMERIC</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>END</span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>reserve</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>       </span><span style=color:#4e9a06>&#34;ClockSpeed&#34;</span><span style=color:#f8f8f8>                                                                         </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>freq</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>aws_ec2</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=visualization>Visualization</h2><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=79"><img src=/img/blog/cloud/ecs-1.png alt></a></p><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=63"><img src=/img/blog/cloud/ecs-2.png alt></a></p><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=69"><img src=/img/blog/cloud/ecs-3.png alt></a></p><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=79"><img src=/img/blog/cloud/ecs-5.png alt></a></p><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=16"><img src=/img/blog/cloud/ecs-6.png alt></a></p><p><a href="https://demo.pigsty.io/d/ecs?viewPanel=45"><img src=/img/blog/cloud/ecs-7.png alt></a></p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email - Vonng" aria-label="Email - Vonng"><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label="Email - Vonng"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=WeChat aria-label=WeChat><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=WeChat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=Discussion><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Repo aria-label=Repo><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=Repo><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
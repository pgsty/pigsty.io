<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><link rel=canonical type=text/html href=https://pigsty.io/docs/pgsql/kernel/><link rel=alternate type=application/rss+xml href=https://pigsty.io/docs/pgsql/kernel/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>PG Kernels | PIGSTY</title><meta name=description content="How to use other PostgreSQL kernel forks in Pigsty? Such as Citus, Babelfish, IvorySQL, PolarDB, etc."><meta property="og:url" content="https://pigsty.io/docs/pgsql/kernel/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="PG Kernels"><meta property="og:description" content="How to use other PostgreSQL kernel forks in Pigsty? Such as Citus, Babelfish, IvorySQL, PolarDB, etc."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="PG Kernels"><meta itemprop=description content="How to use other PostgreSQL kernel forks in Pigsty? Such as Citus, Babelfish, IvorySQL, PolarDB, etc."><meta itemprop=dateModified content="2026-01-11T12:38:37+08:00"><meta itemprop=wordCount content="139"><meta itemprop=keywords content="Kernel"><meta name=twitter:card content="summary"><meta name=twitter:title content="PG Kernels"><meta name=twitter:description content="How to use other PostgreSQL kernel forks in Pigsty? Such as Citus, Babelfish, IvorySQL, PolarDB, etc."><link rel=preload href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css as=style integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><link href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css rel=stylesheet integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Ver</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.cc>Pigsty 中文网站</a></li><li><a class=dropdown-item href=https://doc.pgsty.com>Pigsty v3.7 Doc</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc>Pigsty v3.4 Doc</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 Doc</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 Doc</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch Language / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d757e151050fd40088751a74721d74f6.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:window.location.href="https://pigsty.cc"+e}</script></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/pgsql/kernel/>Return to the regular view of this page</a>.</p></div><h1 class=title>PG Kernels</h1><div class=lead>How to use other PostgreSQL kernel forks in Pigsty? Such as Citus, Babelfish, IvorySQL, PolarDB, etc.</div><ul><li>1: <a href=#pg-6b647bd80a1130f992c12a77393a87c3>PostgreSQL</a></li><li>2: <a href=#pg-2f9342f89a206383c945315b79c7967f>Supabase</a></li><li>3: <a href=#pg-5e2941fff6b5b682be30d52c9d82b986>Percona</a></li><li>4: <a href=#pg-8b89390bfb5e407f5413ce18cede184b>OpenHalo</a></li><li>5: <a href=#pg-311f723c83095a738bfb441159db0044>OrioleDB</a></li><li>6: <a href=#pg-7200791b1d0ca9c1c30f1e8d7dc9ece2>Citus</a></li><li>7: <a href=#pg-86f570780ad542823d4ed958af36ce0f>Babelfish</a></li><li>8: <a href=#pg-d4592799fc81bf53d57e017444a325f6>IvorySQL</a></li><li>9: <a href=#pg-293b566be2331c0d55a3457bdfb0a860>PolarDB PG</a></li><li>10: <a href=#pg-ffed78d77ebf7627086f9da938f9b9f6>PolarDB Oracle</a></li><li>11: <a href=#pg-e59a81d2edf1c2072f834e4d8ef376db>PostgresML</a></li><li>12: <a href=#pg-227e1bd7e26827efbe4f8ed91ee4c679>Greenplum</a></li><li>13: <a href=#pg-a970dfd99688547f0ffb0bf4d5c4de61>Cloudberry</a></li><li>14: <a href=#pg-2342a2eaca8515e616cb1dfa8c4db39d>Neon</a></li></ul><div class=content><p>In Pigsty, you can replace the &ldquo;native PG kernel&rdquo; with different &ldquo;<strong>flavors</strong>&rdquo; of PostgreSQL forks to achieve special features and effects.</p><p>Pigsty supports various PostgreSQL kernels and compatible forks, enabling you to simulate different database systems while leveraging PostgreSQL&rsquo;s ecosystem. Each kernel provides unique capabilities and compatibility layers.</p><table class=full-width><thead><tr><th style=text-align:left>Kernel</th><th style=text-align:left>Key Feature</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><a href=/docs/pgsql>PostgreSQL</a></td><td style=text-align:left><strong>Original Flavor</strong></td><td style=text-align:left>Vanilla PostgreSQL with 440 extensions</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/citus>Citus</a></td><td style=text-align:left><strong>Horizontal Scaling</strong></td><td style=text-align:left>Distributed PostgreSQL via native extension</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/babelfish>WiltonDB</a></td><td style=text-align:left><strong>SQL Server Compatible</strong></td><td style=text-align:left>SQL Server wire-protocol compatibility</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/ivorysql>IvorySQL</a></td><td style=text-align:left><strong>Oracle Compatible</strong></td><td style=text-align:left>Oracle syntax and PL/SQL compatibility</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/openhalo>OpenHalo</a></td><td style=text-align:left><strong>MySQL Compatible</strong></td><td style=text-align:left>MySQL wire-protocol compatibility</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/percona>Percona</a></td><td style=text-align:left><strong>Transparent Encryption</strong></td><td style=text-align:left>Percona Distribution with pg_tde</td></tr><tr><td style=text-align:left><a href=/docs/ferret>FerretDB</a></td><td style=text-align:left><strong>MongoDB Migration</strong></td><td style=text-align:left>MongoDB wire-protocol compatibility</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/orioledb>OrioleDB</a></td><td style=text-align:left><strong>OLTP Optimization</strong></td><td style=text-align:left>Zheap, No bloat, S3 Storage</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/polardb>PolarDB</a></td><td style=text-align:left><strong>Aurora-style RAC</strong></td><td style=text-align:left>RAC, China domestic compliance</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/supabase>Supabase</a></td><td style=text-align:left><strong>Backend as a Service</strong></td><td style=text-align:left>BaaS based on PostgreSQL, Firebase alternative</td></tr><tr><td style=text-align:left><a href=/docs/pgsql/kernel/cloudberry>Cloudberry</a></td><td style=text-align:left><strong>MPP DW & Analytics</strong></td><td style=text-align:left>Massively parallel processing data warehouse</td></tr></tbody></table></div></div><div class=td-content style=page-break-before:always><h1 id=pg-6b647bd80a1130f992c12a77393a87c3>1 - PostgreSQL</h1><div class=lead>Vanilla PostgreSQL kernel with 440 extensions</div><p><a href=https://www.postgresql.org/>PostgreSQL</a> is the world&rsquo;s most advanced and popular open-source database.</p><p>Pigsty supports PostgreSQL 13 ~ 18 and provides 440 PG extensions.</p><hr><h2 id=quick-start>Quick Start</h2><p><a href=/docs/setup/install><strong>Install</strong></a> Pigsty using the <a href=https://github.com/pgsty/pigsty/blob/main/conf/pgsql.yml><code>pgsql</code></a> configuration template.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure -c pgsql     <span style=color:#8f5902;font-style:italic># Use postgres kernel</span>
</span></span><span style=display:flex><span>./deploy.yml             <span style=color:#8f5902;font-style:italic># Set up everything with pigsty</span>
</span></span></code></pre></div><p>Most <a href=/docs/conf/>configuration templates</a> use PostgreSQL kernel by default, for example:</p><ul><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/meta.yml><code>meta</code></a> : <strong>Default</strong>, postgres with core extensions (vector, postgis, timescale)</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/rich.yml><code>rich</code></a> : postgres with all extensions installed</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/slim.yml><code>slim</code></a> : postgres only, no monitoring infrastructure</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/full.yml><code>full</code></a> : 4-node sandbox for HA demonstration</li><li><a href=https://github.com/pgsty/pigsty/blob/main/conf/pgsql.yml><code>pgsql</code></a> : minimal postgres kernel configuration example</li></ul><hr><h2 id=configuration>Configuration</h2><p>Vanilla PostgreSQL kernel requires no special adjustments:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin   ] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta, baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>vector ]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Full backup at 1 AM daily</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql-main, pgsql-common ]  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pg kernel and common utilities</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#pg_extensions: [ pg18-time ,pg18-gis ,pg18-rag ,pg18-fts ,pg18-olap ,pg18-feat ,pg18-lang ,pg18-type ,pg18-util ,pg18-func ,pg18-admin ,pg18-stat ,pg18-sec ,pg18-fdw ,pg18-sim ,pg18-etl]</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=version-selection>Version Selection</h2><p>To use a different PostgreSQL major version, you can configure it using the <code>-v</code> parameter:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure -c pgsql            <span style=color:#8f5902;font-style:italic># Default is postgresql 18, no need to specify explicitly</span>
</span></span><span style=display:flex><span>./configure -c pgsql -v <span style=color:#0000cf;font-weight:700>17</span>      <span style=color:#8f5902;font-style:italic># Use postgresql 17</span>
</span></span><span style=display:flex><span>./configure -c pgsql -v <span style=color:#0000cf;font-weight:700>16</span>      <span style=color:#8f5902;font-style:italic># Use postgresql 16</span>
</span></span><span style=display:flex><span>./configure -c pgsql -v <span style=color:#0000cf;font-weight:700>15</span>      <span style=color:#8f5902;font-style:italic># Use postgresql 15</span>
</span></span><span style=display:flex><span>./configure -c pgsql -v <span style=color:#0000cf;font-weight:700>14</span>      <span style=color:#8f5902;font-style:italic># Use postgresql 14</span>
</span></span><span style=display:flex><span>./configure -c pgsql -v <span style=color:#0000cf;font-weight:700>13</span>      <span style=color:#8f5902;font-style:italic># Use postgresql 13</span>
</span></span></code></pre></div><p>If a PostgreSQL cluster is already installed, you need to uninstall it before installing a new version:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-rm.yml <span style=color:#8f5902;font-style:italic># -l pg-meta</span>
</span></span></code></pre></div><hr><h2 id=extension-ecosystem>Extension Ecosystem</h2><p>Pigsty provides a rich extension ecosystem for PostgreSQL, including:</p><ul><li><strong>Time-series</strong>: timescaledb, pg_cron, periods</li><li><strong>Geospatial</strong>: postgis, h3, pgrouting</li><li><strong>Vector</strong>: pgvector, pgml, vchord</li><li><strong>Search</strong>: pg_trgm, zhparser, pgroonga</li><li><strong>Analytics</strong>: citus, pg_duckdb, pg_analytics</li><li><strong>Features</strong>: age, pg_graphql, rum</li><li><strong>Languages</strong>: plpython3u, pljava, plv8</li><li><strong>Types</strong>: hstore, ltree, citext</li><li><strong>Utilities</strong>: http, pg_net, pgjwt</li><li><strong>Functions</strong>: pgcrypto, uuid-ossp, pg_uuidv7</li><li><strong>Administration</strong>: pg_repack, pgagent, pg_squeeze</li><li><strong>Statistics</strong>: pg_stat_statements, pg_qualstats, auto_explain</li><li><strong>Security</strong>: pgaudit, pgcrypto, pgsodium</li><li><strong>Foreign</strong>: postgres_fdw, mysql_fdw, oracle_fdw</li><li><strong>Compatibility</strong>: orafce, babelfishpg_tds</li><li><strong>Data</strong>: pglogical, wal2json, decoderbufs</li></ul><p>For details, please refer to <a href=https://pgext.cloud/list>Extension Catalog</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2f9342f89a206383c945315b79c7967f>2 - Supabase</h1><div class=lead>How to self-host Supabase with Pigsty, deploy an open-source Firebase alternative with a complete backend stack in one click.</div><blockquote><p><a href=https://supabase.com/>Supabase</a> — Build in a weekend, Scale to millions</p></blockquote><p>Supabase is an open-source Firebase alternative that wraps PostgreSQL and provides authentication, out-of-the-box APIs, edge functions, real-time subscriptions, object storage, and vector embedding capabilities.
This is a low-code all-in-one backend platform that lets you skip most backend development work, requiring only database design and frontend knowledge to quickly ship products!</p><p>Supabase&rsquo;s motto is: &ldquo;<strong>Build in a weekend, Scale to millions</strong>&rdquo;. Indeed, Supabase is <a href=https://supabase.com/pricing>extremely cost-effective</a> at small to micro scales (4c8g), like a cyber bodhisattva.
— But when you really scale to millions of users — you should seriously consider self-hosting Supabase — whether for functionality, performance, or cost considerations.</p><p>Pigsty provides you with a complete one-click self-hosting solution for Supabase. Self-hosted Supabase enjoys full PostgreSQL monitoring, IaC, PITR, and high availability,
and compared to Supabase cloud services, it provides up to <a href=https://pgext.cloud><strong>440</strong></a> out-of-the-box PostgreSQL extensions and can more fully utilize the performance and cost advantages of modern hardware.</p><p>For the complete self-hosting tutorial, please refer to: <a href=/docs/app/supabase><strong>Supabase Self-Hosting Guide</strong></a></p><p><img src=/img/pigsty/supabase.webp alt></p><hr><h2 id=quick-start>Quick Start</h2><p>Pigsty&rsquo;s default <a href=https://github.com/pgsty/pigsty/blob/main/conf/supa.yml><code>supa.yml</code></a> configuration template defines a single-node Supabase.</p><p>First, use Pigsty&rsquo;s <a href=/docs/setup/install>standard installation process</a> to install the MinIO and PostgreSQL instances required for Supabase:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash
</span></span><span style=display:flex><span>./bootstrap          <span style=color:#8f5902;font-style:italic># Environment check, install dependencies</span>
</span></span><span style=display:flex><span>./configure -c supa  <span style=color:#8f5902;font-style:italic># Important: modify passwords and other key info in config!</span>
</span></span><span style=display:flex><span>./deploy.yml         <span style=color:#8f5902;font-style:italic># Install Pigsty, deploy PGSQL and MINIO!</span>
</span></span></code></pre></div><p>Before deploying Supabase, please modify the <a href=#configuration-details>Supabase parameters</a> in the <code>pigsty.yml</code> config file according to your actual situation (mainly passwords!)</p><p>Then, run <a href=/docs/docker/playbook><code>docker.yml</code></a> and <a href=/docs/docker/playbook><code>app.yml</code></a> to complete the remaining work and deploy Supabase containers:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./docker.yml       <span style=color:#8f5902;font-style:italic># Install Docker module</span>
</span></span><span style=display:flex><span>./app.yml          <span style=color:#8f5902;font-style:italic># Start Supabase stateless components!</span>
</span></span></code></pre></div><p>For users in China, please configure appropriate Docker mirror sites or proxy servers to bypass GFW to pull DockerHub images.
For <a href=/docs/about/service>professional subscriptions</a>, we provide the ability to <a href=/docs/setup/offline>offline install</a> Pigsty and Supabase without internet access.</p><p>Pigsty exposes web services through Nginx on the admin node/INFRA node by default. You can add DNS resolution for <code>supa.pigsty</code> pointing to this node locally,
then access <code>https://supa.pigsty</code> through a browser to enter the Supabase Studio management interface.</p><blockquote><p>Default username and password: supabase / pigsty</p></blockquote><link rel=stylesheet href=/css/asciinema-player.css><script src=/js/asciinema-player.min.js></script><div id=asciinema-913fe6b5e34ef94a5d10a82176a4fd69 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-913fe6b5e34ef94a5d10a82176a4fd69",o="/demo/supabase.cast",e="solarized-light",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[0,"Check"],[11,"Install"],[43,"Config"],[307,"Docker"],[321,"Domain"],[340,"App"],[350,"Verify"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script></div><div class=td-content style=page-break-before:always><h1 id=pg-5e2941fff6b5b682be30d52c9d82b986>3 - Percona</h1><div class=lead>Percona Postgres distribution with TDE transparent encryption support</div><p><a href=https://www.percona.com/postgresql/software/postgresql-distribution>Percona Postgres</a> is a patched Postgres kernel with <a href=https://docs.percona.com/pg-tde/index.html><code>pg_tde</code></a> (Transparent Data Encryption) extension.</p><p>It&rsquo;s compatible with PostgreSQL 18.1 and available on all Pigsty-supported platforms.</p><ul><li><a href=https://andreas.scherbaum.la/post/2025-06-30_performance-test-for-percona-transparent-data-encryption-tde/>Performance Test for Percona Transparent Data Encryption (TDE)</a></li></ul><hr><h2 id=quick-start>Quick Start</h2><p>Use Pigsty&rsquo;s <a href=/docs/setup/install><strong>standard installation process</strong></a> with the <a href=https://github.com/pgsty/pigsty/blob/main/conf/pgtde.yml><code>pgtde</code></a> configuration template.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>./configure -c pgtde     <span style=color:#8f5902;font-style:italic># Use percona postgres kernel</span>
</span></span><span style=display:flex><span>./deploy.yml             <span style=color:#8f5902;font-style:italic># Set up everything with pigsty</span>
</span></span></code></pre></div><hr><h2 id=configuration>Configuration</h2><p>The following parameters need to be adjusted to deploy a Percona cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin   ] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>baseline</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>cmdb.sql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty tde database</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>schemas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>pigsty]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>vector, postgis, pg_tde ,pgaudit, { name: pg_stat_monitor, schema: monitor } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Full backup at 1 AM daily</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># Percona PostgreSQL TDE specific settings</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>percona-main, pgsql-common ] </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Install percona postgres packages</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;pg_tde, pgaudit, pg_stat_statements, pg_stat_monitor, auto_explain&#39;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=extensions>Extensions</h2><p>Percona provides 80 available extensions, including <code>pg_tde</code>, <code>pgvector</code>, <code>postgis</code>, <code>pgaudit</code>, <code>set_user</code>, <code>pg_stat_monitor</code>, and other useful third-party extensions.</p><table><thead><tr><th>Extension</th><th>Version</th><th>Description</th></tr></thead><tbody><tr><td>pg_tde</td><td>2.1</td><td>Percona transparent data encryption access method</td></tr><tr><td>vector</td><td>0.8.1</td><td>Vector data type and ivfflat and hnsw access methods</td></tr><tr><td>postgis</td><td>3.5.4</td><td>PostGIS geometry and geography types and functions</td></tr><tr><td>pgaudit</td><td>18.0</td><td>Provides auditing functionality</td></tr><tr><td>pg_stat_monitor</td><td>2.3</td><td>PostgreSQL query performance monitoring tool</td></tr><tr><td>set_user</td><td>4.2.0</td><td>Similar to SET ROLE but with additional logging</td></tr><tr><td>pg_repack</td><td>1.5.3</td><td>Reorganize tables in PostgreSQL databases with minimal locks</td></tr><tr><td>hstore</td><td>1.8</td><td>Data type for storing sets of (key, value) pairs</td></tr><tr><td>ltree</td><td>1.3</td><td>Data type for hierarchical tree-like structures</td></tr><tr><td>pg_trgm</td><td>1.6</td><td>Text similarity measurement and index searching based on trigrams</td></tr></tbody></table><p>For the complete list of 80 extensions, please refer to the <a href=https://docs.percona.com/postgresql/18/extensions.html>Percona Postgres official documentation</a>.</p><hr><h2 id=key-features>Key Features</h2><ul><li><strong>Transparent Data Encryption</strong>: Provides data-at-rest encryption using the pg_tde extension</li><li><strong>PostgreSQL 18 Compatible</strong>: Based on the latest PostgreSQL 18 version</li><li><strong>Enterprise Extensions</strong>: Includes enterprise-grade features like pgaudit, pg_stat_monitor</li><li><strong>Complete Ecosystem</strong>: Supports popular extensions like pgvector, PostGIS</li></ul><blockquote><p><strong>Note</strong>: Currently in stable stage - thoroughly evaluate before production use.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-8b89390bfb5e407f5413ce18cede184b>4 - OpenHalo</h1><div class=lead>MySQL compatible Postgres 14 fork</div><p><a href=https://www.openhalo.org/>OpenHalo</a> is an open-source PostgreSQL kernel that provides MySQL wire protocol compatibility.</p><p>OpenHalo is based on PostgreSQL 14.10 kernel version and provides wire protocol compatibility with MySQL 5.7.32-log / 8.0 versions.</p><p>Pigsty provides deployment support for OpenHalo on all supported Linux platforms.</p><hr><h2 id=quick-start>Quick Start</h2><p>Use Pigsty&rsquo;s <a href=/docs/setup/install><strong>standard installation process</strong></a> with the <a href=https://github.com/pgsty/pigsty/blob/main/conf/mysql.yml><code>mysql</code></a> configuration template.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>./configure -c mysql    <span style=color:#8f5902;font-style:italic># Use MySQL (openHalo) configuration template</span>
</span></span><span style=display:flex><span>./deploy.yml            <span style=color:#8f5902;font-style:italic># Install, for production deployment please modify passwords in pigsty.yml first</span>
</span></span></code></pre></div><p>For production deployment, ensure you modify the password parameters in the <code>pigsty.yml</code> configuration file before running the install playbook.</p><hr><h2 id=configuration>Configuration</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin]    ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer for meta database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: postgres, extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>aux_mysql]}</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># mysql compatible database</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: meta ,baseline: cmdb.sql ,comment: pigsty meta database ,schemas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>pigsty]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Full backup at 1 AM daily</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># OpenHalo specific settings</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mysql                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># HaloDB&#39;s MySQL compatibility mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>14</span><span style=color:#f8f8f8>                    </span><span style=color:#8f5902;font-style:italic># Current HaloDB compatible PG major version 14</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>openhalodb, pgsql-common ] </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Install openhalodb instead of postgresql kernel</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=usage>Usage</h2><p>When accessing MySQL, the actual connection uses the <code>postgres</code> database. Please note that the concept of &ldquo;database&rdquo; in MySQL actually corresponds to &ldquo;Schema&rdquo; in PostgreSQL. Therefore, <code>use mysql</code> actually uses the <code>mysql</code> Schema within the <code>postgres</code> database.</p><p>The username and password for MySQL are the same as in PostgreSQL. You can manage users and permissions using standard PostgreSQL methods.</p><h3 id=client-access>Client Access</h3><p>OpenHalo provides MySQL wire protocol compatibility, listening on port 3306 by default, allowing MySQL clients and drivers to connect directly.</p><p>Pigsty&rsquo;s <a href=https://github.com/pgsty/pigsty/blob/main/conf/mysql.yml><code>conf/mysql</code></a> configuration installs the <code>mysql</code> client tool by default.</p><p>You can access MySQL using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -h 127.0.0.1 -u dbuser_dba
</span></span></code></pre></div><p>Currently, OpenHalo officially ensures Navicat can properly access this MySQL port, but Intellij IDEA&rsquo;s DataGrip access will cause errors.</p><hr><h2 id=modification-notes>Modification Notes</h2><p>The <a href=https://github.com/pgsty/openHalo>OpenHalo</a> kernel installed by Pigsty is based on the <a href=https://github.com/HaloTech-Co-Ltd/openHalo>HaloTech-Co-Ltd/openHalo</a> kernel with minor modifications:</p><ul><li>Changed the default database name from <code>halo0root</code> back to <code>postgres</code></li><li>Removed the <code>1.0.</code> prefix from the default version number, restoring it to <code>14.10</code></li><li>Modified the default configuration file to enable MySQL compatibility and listen on port <code>3306</code> by default</li></ul><p>Please note that Pigsty does not provide any warranty for using the OpenHalo kernel. Any issues or requirements encountered when using this kernel should be addressed with the original vendor.</p><blockquote><p><strong>Warning</strong>: Currently experimental - thoroughly evaluate before production use.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-311f723c83095a738bfb441159db0044>5 - OrioleDB</h1><div class=lead>Next-generation OLTP engine for PostgreSQL</div><p><a href=https://orioledb.com/>OrioleDB</a> is a PostgreSQL storage engine extension that claims to provide 4x OLTP performance, no xid wraparound and table bloat issues, and &ldquo;cloud-native&rdquo; (data stored in S3) capabilities.</p><p>OrioleDB&rsquo;s latest version is based on a <a href=https://github.com/orioledb/postgres>patched PostgreSQL 17.0</a> and an additional <a href=https://github.com/orioledb/orioledb>extension</a></p><p>You can run OrioleDB as an RDS using Pigsty. It&rsquo;s compatible with PG 17 and available on all supported Linux platforms.
The latest version is beta12, based on PG 17_11 patch.</p><hr><h2 id=quick-start>Quick Start</h2><p>Follow Pigsty&rsquo;s <a href=/docs/setup/install><strong>standard installation</strong></a> process using the <a href=https://github.com/pgsty/pigsty/blob/main/conf/oriole.yml><code>oriole</code></a> configuration template.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> ~/pigsty<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>./configure -c oriole    <span style=color:#8f5902;font-style:italic># Use OrioleDB configuration template</span>
</span></span><span style=display:flex><span>./deploy.yml             <span style=color:#8f5902;font-style:italic># Install Pigsty with OrioleDB</span>
</span></span></code></pre></div><p>For production deployment, ensure you modify the password parameters in the <code>pigsty.yml</code> configuration before running the <code>install</code> playbook.</p><hr><h2 id=configuration>Configuration</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin]    ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer for meta database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: meta ,baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty], extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>orioledb]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Full backup at 1 AM daily</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># OrioleDB specific settings</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oriole                                        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># oriole compatibility mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>orioledb, pgsql-common ]                </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Install OrioleDB kernel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;orioledb, pg_stat_statements, auto_explain&#39;</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Load OrioleDB extension</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=usage>Usage</h2><p>To use OrioleDB, you need to install the <code>orioledb_17</code> and <code>oriolepg_17</code> packages (currently only RPM versions are available).</p><p>Initialize TPC-B-like tables with <code>pgbench</code> using 100 warehouses:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pgbench -is <span style=color:#0000cf;font-weight:700>100</span> meta
</span></span><span style=display:flex><span>pgbench -nv -P1 -c10 -S -T1000 meta
</span></span><span style=display:flex><span>pgbench -nv -P1 -c50 -S -T1000 meta
</span></span><span style=display:flex><span>pgbench -nv -P1 -c10    -T1000 meta
</span></span><span style=display:flex><span>pgbench -nv -P1 -c50    -T1000 meta
</span></span></code></pre></div><p>Next, you can rebuild these tables using the <code>orioledb</code> storage engine and observe the performance difference:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Create OrioleDB tables
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts_o</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>LIKE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INCLUDING</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>ALL</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>USING</span><span style=color:#f8f8f8> </span><span style=color:#000>orioledb</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches_o</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>LIKE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INCLUDING</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>ALL</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>USING</span><span style=color:#f8f8f8> </span><span style=color:#000>orioledb</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history_o</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>LIKE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INCLUDING</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>ALL</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>USING</span><span style=color:#f8f8f8> </span><span style=color:#000>orioledb</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers_o</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>LIKE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INCLUDING</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>ALL</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>USING</span><span style=color:#f8f8f8> </span><span style=color:#000>orioledb</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Copy data from regular tables to OrioleDB tables
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8>  </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Drop original tables and rename OrioleDB tables
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ALTER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>RENAME</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_accounts</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ALTER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>RENAME</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_branches</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ALTER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>RENAME</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_history</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ALTER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers_o</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>RENAME</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TO</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbench_tellers</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=key-features>Key Features</h2><ul><li><strong>No XID Wraparound</strong>: Eliminates transaction ID wraparound maintenance</li><li><strong>No Table Bloat</strong>: Advanced storage management prevents table bloat</li><li><strong>Cloud Storage</strong>: Native support for S3-compatible object storage</li><li><strong>OLTP Optimized</strong>: Designed for transactional workloads</li><li><strong>Improved Performance</strong>: Better space utilization and query performance</li></ul><blockquote><p><strong>Note</strong>: Currently in Beta stage - thoroughly evaluate before production use.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-7200791b1d0ca9c1c30f1e8d7dc9ece2>6 - Citus</h1><div class=lead>Deploy native high-availability Citus horizontally sharded clusters with Pigsty, seamlessly scaling PostgreSQL across multiple shards and accelerating OLTP/OLAP queries.</div><p>Pigsty natively supports Citus. This is a distributed horizontal scaling extension based on the native PostgreSQL kernel.</p><p><img src=/img/pigsty/citus.jpg alt></p><hr><h2 id=installation>Installation</h2><p>Citus is a PostgreSQL <a href=/docs/pgsql/ext/>extension plugin</a> that can be installed and enabled on a native PostgreSQL cluster following the standard plugin installation process.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -t pg_extension -e <span style=color:#4e9a06>&#39;{&#34;pg_extensions&#34;:[&#34;citus&#34;]}&#39;</span>
</span></span></code></pre></div><hr><h2 id=configuration>Configuration</h2><p>To define a citus cluster, you need to specify the following parameters:</p><ul><li><a href=/docs/pgsql/param#pg_mode><code>pg_mode</code></a> must be set to <code>citus</code> instead of the default <code>pgsql</code></li><li>You must define the shard name <a href=/docs/pgsql/param#pg_shard><code>pg_shard</code></a> and shard number <a href=/docs/pgsql/param#pg_group><code>pg_group</code></a> on each shard cluster</li><li>You must define <a href=/docs/pgsql/param#pg_primary_db><code>pg_primary_db</code></a> to specify the database managed by Patroni</li><li>If you want to use <code>postgres</code> from <a href=/docs/pgsql/param#pg_dbsu><code>pg_dbsu</code></a> instead of the default <a href=/docs/pgsql/param#pg_admin_username><code>pg_admin_username</code></a> to execute admin commands, then <a href=/docs/pgsql/param#pg_dbsu_password><code>pg_dbsu_password</code></a> must be set to a non-empty plaintext password</li></ul><p>Additionally, you need extra hba rules to allow SSL access from localhost and other data nodes.</p><p>You can define each Citus cluster as a separate group, like standard PostgreSQL clusters, as shown in <a href=https://github.com/pgsty/pigsty/blob/main/conf/citus.yml><code>conf/dbms/citus.yml</code></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-citus0</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus shard 0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: pg-citus0 , pg_group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-citus1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus shard 1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: pg-citus1 , pg_group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-citus2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus shard 2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: pg-citus2 , pg_group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-citus3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus shard 3</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.14</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: pg-citus3 , pg_group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                               </span><span style=color:#8f5902;font-style:italic># Global parameters for all Citus clusters</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_mode: citus                    # pgsql cluster mode must be set to</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>citus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_shard: pg-citus                # citus horizontal shard name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-citus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_primary_db: meta               # citus database name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_dbsu_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Postgres</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># If using dbsu, you need to configure a password for it</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta ,pgbouncer: true ,roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>citus }, { name: postgis }, { name: timescaledb } ] } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: &#39;all&#39; ,db: all  ,addr: 127.0.0.1/32 ,auth: ssl ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;all user ssl access from localhost&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: &#39;all&#39; ,db: all  ,addr: intra        ,auth: ssl ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;all user ssl access from intranet&#39;</span><span style=color:#f8f8f8>  </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>You can also specify identity parameters for all Citus cluster members within a single group, as shown in <a href=https://github.com/pgsty/pigsty/blob/main/conf/prod.yml#L298><code>prod.yml</code></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==========================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># pg-citus: 10 node citus cluster (5 x primary-replica pair)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==========================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-citus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus group</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.50</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 0, pg_cluster: pg-citus0 ,pg_vip_address: 10.10.10.60/24 ,pg_seq: 0, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.51</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 0, pg_cluster: pg-citus0 ,pg_vip_address: 10.10.10.60/24 ,pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.52</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 1, pg_cluster: pg-citus1 ,pg_vip_address: 10.10.10.61/24 ,pg_seq: 0, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.53</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 1, pg_cluster: pg-citus1 ,pg_vip_address: 10.10.10.61/24 ,pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.54</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 2, pg_cluster: pg-citus2 ,pg_vip_address: 10.10.10.62/24 ,pg_seq: 0, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.55</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 2, pg_cluster: pg-citus2 ,pg_vip_address: 10.10.10.62/24 ,pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.56</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 3, pg_cluster: pg-citus3 ,pg_vip_address: 10.10.10.63/24 ,pg_seq: 0, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.57</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 3, pg_cluster: pg-citus3 ,pg_vip_address: 10.10.10.63/24 ,pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.58</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 4, pg_cluster: pg-citus4 ,pg_vip_address: 10.10.10.64/24 ,pg_seq: 0, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.59</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_group: 4, pg_cluster: pg-citus4 ,pg_vip_address: 10.10.10.64/24 ,pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_mode: citus                    # pgsql cluster mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>citus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_shard: pg-citus                # citus shard name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-citus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_primary_db</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>test              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># primary database used by citus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_dbsu_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Postgres</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># all dbsu password access for citus cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_vip_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_vip_interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>eth1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;citus postgis timescaledb pgvector&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;citus, timescaledb, pg_stat_statements, auto_explain&#39;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># citus will be added by patroni automatically</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: test ,password: test ,pgbouncer: true ,roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>dbrole_admin ] } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: test ,owner: test ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>citus }, { name: postgis } ] } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: &#39;all&#39; ,db: all  ,addr: 10.10.10.0/24 ,auth: trust ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;trust citus cluster members&#39;</span><span style=color:#f8f8f8>        </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: &#39;all&#39; ,db: all  ,addr: 127.0.0.1/32  ,auth: ssl   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;all user ssl access from localhost&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>user: &#39;all&#39; ,db: all  ,addr: intra         ,auth: ssl   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;all user ssl access from intranet&#39;</span><span style=color:#f8f8f8>  </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=usage>Usage</h2><p>You can access any node just like accessing a regular cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pgbench -i postgres://test:test@pg-citus0/test
</span></span><span style=display:flex><span>pgbench -nv -P1 -T1000 -c <span style=color:#0000cf;font-weight:700>2</span> postgres://test:test@pg-citus0/test
</span></span></code></pre></div><p>By default, changes you make to one Shard only occur on that cluster and are not synchronized to other Shards.</p><p>If you want to distribute writes across all Shards, you can use the API functions provided by Citus to mark tables as:</p><ul><li><strong>Distributed tables</strong> (automatic partitioning, requires specifying partition key)</li><li><strong>Reference tables</strong> (full replication: does not require specifying partition key)</li></ul><p>Starting from Citus 11.2, any Citus database node can play the role of coordinator, meaning any primary node can write:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql -h pg-citus0 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#34;SELECT create_distributed_table(&#39;pgbench_accounts&#39;, &#39;aid&#39;); SELECT truncate_local_data_after_distributing_table(&#39;public.pgbench_accounts&#39;);&#34;</span>
</span></span><span style=display:flex><span>psql -h pg-citus0 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#34;SELECT create_reference_table(&#39;pgbench_branches&#39;)         ; SELECT truncate_local_data_after_distributing_table(&#39;public.pgbench_branches&#39;);&#34;</span>
</span></span><span style=display:flex><span>psql -h pg-citus0 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#34;SELECT create_reference_table(&#39;pgbench_history&#39;)          ; SELECT truncate_local_data_after_distributing_table(&#39;public.pgbench_history&#39;);&#34;</span>
</span></span><span style=display:flex><span>psql -h pg-citus0 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#34;SELECT create_reference_table(&#39;pgbench_tellers&#39;)          ; SELECT truncate_local_data_after_distributing_table(&#39;public.pgbench_tellers&#39;);&#34;</span>
</span></span></code></pre></div><p>After distributing the tables, you can also access them on other nodes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql -h pg-citus1 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#39;\dt+&#39;</span>
</span></span></code></pre></div><p>For example, a full table scan will show that the execution plan has become a distributed plan:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vagrant@meta-1:~$ psql -h pg-citus3 -d <span style=color:#204a87>test</span> -c <span style=color:#4e9a06>&#39;explain select * from pgbench_accounts&#39;</span>
</span></span><span style=display:flex><span>                                               QUERY PLAN
</span></span><span style=display:flex><span>---------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span> Custom Scan <span style=color:#ce5c00;font-weight:700>(</span>Citus Adaptive<span style=color:#ce5c00;font-weight:700>)</span>  <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cost</span><span style=color:#ce5c00;font-weight:700>=</span>0.00..0.00 <span style=color:#000>rows</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>100000</span> <span style=color:#000>width</span><span style=color:#ce5c00;font-weight:700>=</span>352<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>   Task Count: <span style=color:#0000cf;font-weight:700>32</span>
</span></span><span style=display:flex><span>   Tasks Shown: One of <span style=color:#0000cf;font-weight:700>32</span>
</span></span><span style=display:flex><span>   -&gt;  Task
</span></span><span style=display:flex><span>         Node: <span style=color:#000>host</span><span style=color:#ce5c00;font-weight:700>=</span>10.10.10.52 <span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000>dbname</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>test</span>
</span></span><span style=display:flex><span>         -&gt;  Seq Scan on pgbench_accounts_102008 pgbench_accounts  <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cost</span><span style=color:#ce5c00;font-weight:700>=</span>0.00..81.66 <span style=color:#000>rows</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>3066</span> <span style=color:#000>width</span><span style=color:#ce5c00;font-weight:700>=</span>97<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span> rows<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>You can initiate writes from several different primary nodes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pgbench -nv -P1 -T1000 -c <span style=color:#0000cf;font-weight:700>2</span> postgres://test:test@pg-citus1/test
</span></span><span style=display:flex><span>pgbench -nv -P1 -T1000 -c <span style=color:#0000cf;font-weight:700>2</span> postgres://test:test@pg-citus2/test
</span></span><span style=display:flex><span>pgbench -nv -P1 -T1000 -c <span style=color:#0000cf;font-weight:700>2</span> postgres://test:test@pg-citus3/test
</span></span><span style=display:flex><span>pgbench -nv -P1 -T1000 -c <span style=color:#0000cf;font-weight:700>2</span> postgres://test:test@pg-citus4/test
</span></span></code></pre></div><p>When a node fails, the native high availability support provided by Patroni will promote the standby node and automatically take over.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>test</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#8f5902;font-style:italic># select * from  pg_dist_node;</span>
</span></span><span style=display:flex><span> nodeid <span style=color:#000;font-weight:700>|</span> groupid <span style=color:#000;font-weight:700>|</span>  nodename   <span style=color:#000;font-weight:700>|</span> nodeport <span style=color:#000;font-weight:700>|</span> noderack <span style=color:#000;font-weight:700>|</span> hasmetadata <span style=color:#000;font-weight:700>|</span> isactive <span style=color:#000;font-weight:700>|</span> noderole <span style=color:#000;font-weight:700>|</span> nodecluster <span style=color:#000;font-weight:700>|</span> metadatasynced <span style=color:#000;font-weight:700>|</span> shouldhaveshards
</span></span><span style=display:flex><span>--------+---------+-------------+----------+----------+-------------+----------+----------+-------------+----------------+------------------
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#000;font-weight:700>|</span>       <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>|</span> 10.10.10.51 <span style=color:#000;font-weight:700>|</span>     <span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000;font-weight:700>|</span> default  <span style=color:#000;font-weight:700>|</span> t           <span style=color:#000;font-weight:700>|</span> t        <span style=color:#000;font-weight:700>|</span> primary  <span style=color:#000;font-weight:700>|</span> default     <span style=color:#000;font-weight:700>|</span> t              <span style=color:#000;font-weight:700>|</span> f
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>2</span> <span style=color:#000;font-weight:700>|</span>       <span style=color:#0000cf;font-weight:700>2</span> <span style=color:#000;font-weight:700>|</span> 10.10.10.54 <span style=color:#000;font-weight:700>|</span>     <span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000;font-weight:700>|</span> default  <span style=color:#000;font-weight:700>|</span> t           <span style=color:#000;font-weight:700>|</span> t        <span style=color:#000;font-weight:700>|</span> primary  <span style=color:#000;font-weight:700>|</span> default     <span style=color:#000;font-weight:700>|</span> t              <span style=color:#000;font-weight:700>|</span> t
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#000;font-weight:700>|</span>       <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#000;font-weight:700>|</span> 10.10.10.52 <span style=color:#000;font-weight:700>|</span>     <span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000;font-weight:700>|</span> default  <span style=color:#000;font-weight:700>|</span> t           <span style=color:#000;font-weight:700>|</span> t        <span style=color:#000;font-weight:700>|</span> primary  <span style=color:#000;font-weight:700>|</span> default     <span style=color:#000;font-weight:700>|</span> t              <span style=color:#000;font-weight:700>|</span> t
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#000;font-weight:700>|</span>       <span style=color:#0000cf;font-weight:700>4</span> <span style=color:#000;font-weight:700>|</span> 10.10.10.58 <span style=color:#000;font-weight:700>|</span>     <span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000;font-weight:700>|</span> default  <span style=color:#000;font-weight:700>|</span> t           <span style=color:#000;font-weight:700>|</span> t        <span style=color:#000;font-weight:700>|</span> primary  <span style=color:#000;font-weight:700>|</span> default     <span style=color:#000;font-weight:700>|</span> t              <span style=color:#000;font-weight:700>|</span> t
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>4</span> <span style=color:#000;font-weight:700>|</span>       <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#000;font-weight:700>|</span> 10.10.10.56 <span style=color:#000;font-weight:700>|</span>     <span style=color:#0000cf;font-weight:700>5432</span> <span style=color:#000;font-weight:700>|</span> default  <span style=color:#000;font-weight:700>|</span> t           <span style=color:#000;font-weight:700>|</span> t        <span style=color:#000;font-weight:700>|</span> primary  <span style=color:#000;font-weight:700>|</span> default     <span style=color:#000;font-weight:700>|</span> t              <span style=color:#000;font-weight:700>|</span> t
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-86f570780ad542823d4ed958af36ce0f>7 - Babelfish</h1><div class=lead>Create Microsoft SQL Server compatible PostgreSQL clusters using WiltonDB and Babelfish! (Wire protocol level compatibility)</div><blockquote><p><a href=https://babelfishpg.org/>Babelfish</a> is an MSSQL (Microsoft SQL Server) compatibility solution based on PostgreSQL, open-sourced by AWS.</p></blockquote><hr><h2 id=overview>Overview</h2><p>Pigsty allows users to create Microsoft SQL Server compatible PostgreSQL clusters using Babelfish and WiltonDB!</p><ul><li><a href=https://babelfishpg.org/>Babelfish</a>: An MSSQL (Microsoft SQL Server) compatibility extension plugin open-sourced by AWS</li><li><a href=https://github.com/wiltondb/wiltondb>WiltonDB</a>: A PostgreSQL kernel distribution focusing on integrating Babelfish</li></ul><p>Babelfish is a PostgreSQL extension, but it only works on a slightly modified PostgreSQL kernel fork. WiltonDB provides compiled fork kernel binaries and extension binary packages on EL/Ubuntu systems.</p><p>Pigsty can replace the native PostgreSQL kernel with WiltonDB, providing an out-of-the-box MSSQL compatible cluster. Using and managing an MSSQL cluster is no different from a standard PostgreSQL 15 cluster. You can use all the features provided by Pigsty, such as high availability, backup, monitoring, etc.</p><p>WiltonDB comes with several extension plugins including Babelfish, but cannot use native PostgreSQL extension plugins.</p><p>After the MSSQL compatible cluster starts, in addition to listening on the PostgreSQL default port, it also listens on the MSSQL default port <code>1433</code>, providing MSSQL services via the TDS Wire Protocol on this port.
You can connect to the MSSQL service provided by Pigsty using any MSSQL client, such as SQL Server Management Studio, or using the <code>sqlcmd</code> command-line tool.</p><p><img src=/img/pigsty/mssql.jpg alt></p><hr><h2 id=installation>Installation</h2><p>WiltonDB conflicts with the native PostgreSQL kernel. Only one kernel can be installed on a node. Use the following command to install the WiltonDB kernel online.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -t node_install -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;local,mssql&#34;,&#34;node_packages&#34;:[&#34;wiltondb&#34;]}&#39;</span>
</span></span></code></pre></div><p>Please note that WiltonDB is only available on EL and Ubuntu systems. Debian support is not currently provided.</p><p>The Pigsty Professional Edition provides offline installation packages for WiltonDB, which can be installed from local software sources.</p><hr><h2 id=configuration>Configuration</h2><p>When installing and deploying the MSSQL module, please pay special attention to the following:</p><ul><li>WiltonDB is available on EL (7/8/9) and Ubuntu (20.04/22.04), but <strong>not available on Debian systems</strong>.</li><li>WiltonDB is currently compiled based on PostgreSQL 15, so you need to specify <code>pg_version: 15</code>.</li><li>On EL systems, the <code>wiltondb</code> binary is installed by default in the <code>/usr/bin/</code> directory, while on Ubuntu systems it is installed in the <code>/usr/lib/postgresql/15/bin/</code> directory, which is different from the official PostgreSQL binary placement.</li><li>In WiltonDB compatibility mode, the HBA password authentication rule needs to use <code>md5</code> instead of <code>scram-sha-256</code>. Therefore, you need to override Pigsty&rsquo;s default HBA rule set and insert the <code>md5</code> authentication rule required by SQL Server before the <code>dbrole_readonly</code> wildcard authentication rule.</li><li>WiltonDB can only be enabled for one primary database, and you should designate a user as the Babelfish superuser, allowing Babelfish to create databases and users. The default is <code>mssql</code> and <code>dbuser_mssql</code>. If you change this, please also modify the user in <code>files/mssql.sql</code>.</li><li>The WiltonDB TDS wire protocol compatibility plugin <code>babelfishpg_tds</code> needs to be enabled in <code>shared_preload_libraries</code>.</li><li>After enabling the WiltonDB extension, it listens on the MSSQL default port <code>1433</code>. You can override Pigsty&rsquo;s default service definitions to point the <code>primary</code> and <code>replica</code> services to port <code>1433</code> instead of <code>5432</code> / <code>6432</code>.</li></ul><p>The following parameters need to be configured for the MSSQL database cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># PGSQL &amp; MSSQL (Babelfish &amp; Wilton)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># PG Installation</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>local,node,mssql</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># add mssql and os upstream repos</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mssql                     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Microsoft SQL Server Compatible Mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;babelfishpg_tds, pg_stat_statements, auto_explain&#39;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># add timescaledb to shared_preload_libraries</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># The current WiltonDB major version is 15</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#000>wiltondb                       </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># install forked version of postgresql with babelfishpg support</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#000>patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8>                   </span><span style=color:#8f5902;font-style:italic># do not install any vanilla postgresql extensions</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># PG Provision</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_default_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>               </span><span style=color:#8f5902;font-style:italic># overwrite default HBA rules for babelfish cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${dbsu}&#39;</span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>,db: all         ,addr: local     ,auth: ident ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;dbsu access via local os user ident&#39;</span><span style=color:#f8f8f8>  </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${dbsu}&#39;</span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>,db: replication ,addr: local     ,auth: ident ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;dbsu replication from local os ident&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${repl}&#39;</span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>,db: replication ,addr: localhost ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;replicator replication from localhost&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${repl}&#39;</span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>,db: replication ,addr: intra     ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;replicator replication from intranet&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${repl}&#39;</span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>,db: postgres    ,addr: intra     ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;replicator postgres db from intranet&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${monitor}&#39;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,db: all         ,addr: localhost ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;monitor from localhost with password&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${monitor}&#39;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,db: all         ,addr: infra     ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;monitor from infra host with password&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${admin}&#39;</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>,db: all         ,addr: infra     ,auth: ssl   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;admin @ infra nodes with pwd &amp; ssl&#39;</span><span style=color:#f8f8f8>   </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${admin}&#39;</span><span style=color:#f8f8f8>   </span><span style=color:#204a87;font-weight:700>,db: all         ,addr: world     ,auth: ssl   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;admin @ everywhere with ssl &amp; pwd&#39;</span><span style=color:#f8f8f8>    </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user: dbuser_mssql ,db: mssql       ,addr: intra     ,auth: md5   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow mssql dbsu intranet access&#39;</span><span style=color:#f8f8f8>     </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;--- use md5 auth method for mssql user</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user: &#39;+dbrole_readonly&#39;,db: all    ,addr: localhost ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;pgbouncer read/write via local socket&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user: &#39;+dbrole_readonly&#39;,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;read/write biz user via password&#39;</span><span style=color:#f8f8f8>     </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#204a87;font-weight:700>user: &#39;+dbrole_offline&#39; ,db: all    ,addr: intra     ,auth: pwd   ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow etl offline tasks from intranet&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_default_services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># route primary &amp; replica service to mssql port 1433</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: primary ,port: 5433 ,dest: 1433  ,check: /primary   ,selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[]&#34;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: replica ,port: 5434 ,dest: 1433  ,check: /read-only ,selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[]&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>, backup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[? pg_role == `primary` || pg_role == `offline` ]&#34;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: default ,port: 5436 ,dest: postgres ,check: /primary   ,selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[]&#34;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: offline ,port: 5438 ,dest: postgres ,check: /replica   ,selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[? pg_role == `offline` || pg_offline_query ]&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>, backup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;[? pg_role == `replica` &amp;&amp; !pg_offline_query]&#34;</span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>You can define MSSQL business databases and business users:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># pgsql (singleton on current node)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># this is an example single-node postgres cluster with postgis &amp; timescaledb installed, with one biz database &amp; two biz users</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;---- primary instance with read-write capability</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                           </span><span style=color:#8f5902;font-style:italic># create MSSQL superuser</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_mssql ,password: DBUser.MSSQL ,superuser: true, pgbouncer: true ,roles: [dbrole_admin], comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>superuser &amp; owner for babelfish  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_primary_db</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mssql               </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># use `mssql` as the primary sql server database</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mssql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>baseline</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mssql.sql            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># init babelfish database &amp; user</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>uuid-ossp          }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>babelfishpg_common }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>babelfishpg_tsql   }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>babelfishpg_tds    }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>babelfishpg_money  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg_hint_plan       }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>system_stats       }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>tds_fdw            }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>owner</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>dbuser_mssql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>&#39;babelfishpg_tsql.migration_mode&#39; </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;multi-db&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>babelfish cluster, a MSSQL compatible pg cluster</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=access>Access</h2><p>You can use any SQL Server compatible client tool to access this database cluster.</p><p>Microsoft provides <a href="https://learn.microsoft.com/en-us/sql/tools/sqlcmd/sqlcmd-use-utility?view=sql-server-ver16">sqlcmd</a> as the official command-line tool.</p><p>In addition, they also provide a Go version command-line tool <a href=https://github.com/microsoft/go-sqlcmd>go-sqlcmd</a>.</p><p>Install <code>go-sqlcmd</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -LO https://github.com/microsoft/go-sqlcmd/releases/download/v1.4.0/sqlcmd-v1.4.0-linux-amd64.tar.bz2
</span></span><span style=display:flex><span>tar xjvf sqlcmd-v1.4.0-linux-amd64.tar.bz2
</span></span><span style=display:flex><span>sudo mv sqlcmd* /usr/bin/
</span></span></code></pre></div><p>Quick start with <code>go-sqlcmd</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlcmd -S 10.10.10.10,1433 -U dbuser_mssql -P DBUser.MSSQL
</span></span><span style=display:flex><span>1&gt; <span style=color:#204a87;font-weight:700>select</span> @@version
</span></span><span style=display:flex><span>2&gt; go
</span></span><span style=display:flex><span>version
</span></span><span style=display:flex><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>Babelfish <span style=color:#204a87;font-weight:700>for</span> PostgreSQL with SQL Server Compatibility - 12.0.2000.8
</span></span><span style=display:flex><span>Oct <span style=color:#0000cf;font-weight:700>22</span> <span style=color:#0000cf;font-weight:700>2023</span> 17:48:32
</span></span><span style=display:flex><span>Copyright <span style=color:#ce5c00;font-weight:700>(</span>c<span style=color:#ce5c00;font-weight:700>)</span> Amazon Web Services
</span></span><span style=display:flex><span>PostgreSQL 15.4 <span style=color:#ce5c00;font-weight:700>(</span>EL 1:15.4.wiltondb3.3_2-2.el8<span style=color:#ce5c00;font-weight:700>)</span> on x86_64-redhat-linux-gnu <span style=color:#ce5c00;font-weight:700>(</span>Babelfish 3.3.0<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span> row affected<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>Using the service mechanism provided by Pigsty, you can use ports 5433 / 5434 to always connect to port 1433 on the primary/replica.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Access port 5433 on any cluster member, pointing to port 1433 MSSQL port on the primary</span>
</span></span><span style=display:flex><span>sqlcmd -S 10.10.10.11,5433 -U dbuser_mssql -P DBUser.MSSQL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Access port 5434 on any cluster member, pointing to port 1433 MSSQL port on any readable replica</span>
</span></span><span style=display:flex><span>sqlcmd -S 10.10.10.11,5434 -U dbuser_mssql -P DBUser.MSSQL
</span></span></code></pre></div><hr><h2 id=extensions>Extensions</h2><p>Most of the <strong>PGSQL</strong> module&rsquo;s <a href=/docs/pgsql/ext/><strong>extension plugins</strong></a> (non-pure SQL class) cannot be directly used on the WiltonDB kernel of the MSSQL module and need to be recompiled.</p><p>Currently, WiltonDB comes with the following extension plugins. In addition to PostgreSQL Contrib extensions and the four BabelfishPG core extensions, it also provides three third-party extensions: <code>pg_hint_plan</code>, <code>tds_fdw</code>, and <code>system_stats</code>.</p><table><thead><tr><th>Extension Name</th><th>Version</th><th>Description</th></tr></thead><tbody><tr><td>dblink</td><td>1.2</td><td>connect to other PostgreSQL databases from within a database</td></tr><tr><td>adminpack</td><td>2.1</td><td>administrative functions for PostgreSQL</td></tr><tr><td>dict_int</td><td>1.0</td><td>text search dictionary template for integers</td></tr><tr><td>intagg</td><td>1.1</td><td>integer aggregator and enumerator (obsolete)</td></tr><tr><td>dict_xsyn</td><td>1.0</td><td>text search dictionary template for extended synonym processing</td></tr><tr><td>amcheck</td><td>1.3</td><td>functions for verifying relation integrity</td></tr><tr><td>autoinc</td><td>1.0</td><td>functions for autoincrementing fields</td></tr><tr><td>bloom</td><td>1.0</td><td>bloom access method - signature file based index</td></tr><tr><td>fuzzystrmatch</td><td>1.1</td><td>determine similarities and distance between strings</td></tr><tr><td>intarray</td><td>1.5</td><td>functions, operators, and index support for 1-D arrays of integers</td></tr><tr><td>btree_gin</td><td>1.3</td><td>support for indexing common datatypes in GIN</td></tr><tr><td>btree_gist</td><td>1.7</td><td>support for indexing common datatypes in GiST</td></tr><tr><td>hstore</td><td>1.8</td><td>data type for storing sets of (key, value) pairs</td></tr><tr><td>hstore_plperl</td><td>1.0</td><td>transform between hstore and plperl</td></tr><tr><td>isn</td><td>1.2</td><td>data types for international product numbering standards</td></tr><tr><td>hstore_plperlu</td><td>1.0</td><td>transform between hstore and plperlu</td></tr><tr><td>jsonb_plperl</td><td>1.0</td><td>transform between jsonb and plperl</td></tr><tr><td>citext</td><td>1.6</td><td>data type for case-insensitive character strings</td></tr><tr><td>jsonb_plperlu</td><td>1.0</td><td>transform between jsonb and plperlu</td></tr><tr><td>jsonb_plpython3u</td><td>1.0</td><td>transform between jsonb and plpython3u</td></tr><tr><td>cube</td><td>1.5</td><td>data type for multidimensional cubes</td></tr><tr><td>hstore_plpython3u</td><td>1.0</td><td>transform between hstore and plpython3u</td></tr><tr><td>earthdistance</td><td>1.1</td><td>calculate great-circle distances on the surface of the Earth</td></tr><tr><td>lo</td><td>1.1</td><td>Large Object maintenance</td></tr><tr><td>file_fdw</td><td>1.0</td><td>foreign-data wrapper for flat file access</td></tr><tr><td>insert_username</td><td>1.0</td><td>functions for tracking who changed a table</td></tr><tr><td>ltree</td><td>1.2</td><td>data type for hierarchical tree-like structures</td></tr><tr><td>ltree_plpython3u</td><td>1.0</td><td>transform between ltree and plpython3u</td></tr><tr><td>pg_walinspect</td><td>1.0</td><td>functions to inspect contents of PostgreSQL Write-Ahead Log</td></tr><tr><td>moddatetime</td><td>1.0</td><td>functions for tracking last modification time</td></tr><tr><td>old_snapshot</td><td>1.0</td><td>utilities in support of old_snapshot_threshold</td></tr><tr><td>pgcrypto</td><td>1.3</td><td>cryptographic functions</td></tr><tr><td>pgrowlocks</td><td>1.2</td><td>show row-level locking information</td></tr><tr><td>pageinspect</td><td>1.11</td><td>inspect the contents of database pages at a low level</td></tr><tr><td>pg_surgery</td><td>1.0</td><td>extension to perform surgery on a damaged relation</td></tr><tr><td>seg</td><td>1.4</td><td>data type for representing line segments or floating-point intervals</td></tr><tr><td>pgstattuple</td><td>1.5</td><td>show tuple-level statistics</td></tr><tr><td>pg_buffercache</td><td>1.3</td><td>examine the shared buffer cache</td></tr><tr><td>pg_freespacemap</td><td>1.2</td><td>examine the free space map (FSM)</td></tr><tr><td>postgres_fdw</td><td>1.1</td><td>foreign-data wrapper for remote PostgreSQL servers</td></tr><tr><td>pg_prewarm</td><td>1.2</td><td>prewarm relation data</td></tr><tr><td>tcn</td><td>1.0</td><td>Triggered change notifications</td></tr><tr><td>pg_trgm</td><td>1.6</td><td>text similarity measurement and index searching based on trigrams</td></tr><tr><td>xml2</td><td>1.1</td><td>XPath querying and XSLT</td></tr><tr><td>refint</td><td>1.0</td><td>functions for implementing referential integrity (obsolete)</td></tr><tr><td>pg_visibility</td><td>1.2</td><td>examine the visibility map (VM) and page-level visibility info</td></tr><tr><td>pg_stat_statements</td><td>1.10</td><td>track planning and execution statistics of all SQL statements executed</td></tr><tr><td>sslinfo</td><td>1.2</td><td>information about SSL certificates</td></tr><tr><td>tablefunc</td><td>1.0</td><td>functions that manipulate whole tables, including crosstab</td></tr><tr><td>tsm_system_rows</td><td>1.0</td><td>TABLESAMPLE method which accepts number of rows as a limit</td></tr><tr><td>tsm_system_time</td><td>1.0</td><td>TABLESAMPLE method which accepts time in milliseconds as a limit</td></tr><tr><td>unaccent</td><td>1.1</td><td>text search dictionary that removes accents</td></tr><tr><td>uuid-ossp</td><td>1.1</td><td>generate universally unique identifiers (UUIDs)</td></tr><tr><td>plpgsql</td><td>1.0</td><td>PL/pgSQL procedural language</td></tr><tr><td>babelfishpg_money</td><td>1.1.0</td><td>babelfishpg_money</td></tr><tr><td>system_stats</td><td>2.0</td><td>EnterpriseDB system statistics for PostgreSQL</td></tr><tr><td>tds_fdw</td><td>2.0.3</td><td>Foreign data wrapper for querying a TDS database (Sybase or Microsoft SQL Server)</td></tr><tr><td>babelfishpg_common</td><td>3.3.3</td><td>Transact SQL Datatype Support</td></tr><tr><td>babelfishpg_tds</td><td>1.0.0</td><td>TDS protocol extension</td></tr><tr><td>pg_hint_plan</td><td>1.5.1</td><td></td></tr><tr><td>babelfishpg_tsql</td><td>3.3.1</td><td>Transact SQL compatibility</td></tr></tbody></table><ul><li>The Pigsty Professional Edition provides offline installation capabilities for MSSQL compatible modules</li><li>Pigsty <a href=/docs/about/service/><strong>Professional Edition</strong></a> provides optional MSSQL compatible kernel extension porting and customization services, which can port <a href=/docs/pgsql/ext/><strong>extensions</strong></a> available in the PGSQL module to MSSQL clusters.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d4592799fc81bf53d57e017444a325f6>8 - IvorySQL</h1><div class=lead>Use HighGo&rsquo;s open-source IvorySQL kernel to achieve Oracle syntax/PLSQL compatibility based on PostgreSQL clusters.</div><p><a href=https://www.ivorysql.org/>IvorySQL</a> is an open-source PostgreSQL kernel fork that aims to provide &ldquo;Oracle compatibility&rdquo; based on PG.</p><hr><h2 id=overview>Overview</h2><p>The IvorySQL kernel is supported in the Pigsty open-source version. Your server needs internet access to download relevant packages directly from IvorySQL&rsquo;s official repository.</p><p>Please note that adding IvorySQL directly to Pigsty&rsquo;s default software repository will affect the installation of the native PostgreSQL kernel. Pigsty Professional Edition provides offline installation solutions including the IvorySQL kernel.</p><p><img src=/img/pigsty/ivory.jpg alt></p><p>The current latest version of IvorySQL is <strong>5.0</strong>, corresponding to PostgreSQL version <strong>18</strong>. Please note that IvorySQL is currently only available on EL8/EL9.</p><blockquote><p>The last IvorySQL version supporting EL7 was 3.3, corresponding to PostgreSQL 16.3; the last version based on PostgreSQL 17 is IvorySQL 4.4</p></blockquote><hr><h2 id=installation>Installation</h2><p>If your environment has internet access, you can add the IvorySQL repository directly to the node using the following method, then execute the PGSQL playbook for installation:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -t node_repo -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;local,node,pgsql,ivory&#34;}&#39;</span>
</span></span></code></pre></div><hr><h2 id=configuration>Configuration</h2><p>The following parameters need to be configured for IvorySQL database clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Ivory SQL Configuration</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>local,node,pgsql,ivory </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># add ivorysql upstream repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>ivory                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># IvorySQL Oracle Compatible Mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;ivorysql patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;liboracle_parser, pg_stat_statements, auto_explain&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># do not install any vanilla postgresql extensions</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><blockquote><p>When using Oracle compatibility mode, you need to dynamically load the <code>liboracle_parser</code> extension plugin.</p></blockquote><hr><h2 id=client-access>Client Access</h2><p>IvorySQL is equivalent to PostgreSQL 16, and any client tool compatible with the PostgreSQL wire protocol can access IvorySQL clusters.</p><hr><h2 id=extension-list>Extension List</h2><p>Most of the <strong>PGSQL</strong> module&rsquo;s <a href=/docs/pgsql/ext/><strong>extensions</strong></a> (non-pure SQL types) cannot be used directly on the IvorySQL kernel. If you need to use them, please recompile and install from source for the new kernel.</p><p>Currently, the IvorySQL kernel comes with the following <strong>101</strong> extension plugins.</p><p>(The extension table remains unchanged as it&rsquo;s already in English)</p><p>Please note that Pigsty does not assume any warranty responsibility for using the IvorySQL kernel. Any issues or requirements encountered when using this kernel should be addressed with the original vendor.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-293b566be2331c0d55a3457bdfb0a860>9 - PolarDB PG</h1><div class=lead>Using Alibaba Cloud&rsquo;s open-source PolarDB for PostgreSQL kernel to provide domestic innovation qualification support, with Oracle RAC-like user experience.</div><hr><h2 id=overview>Overview</h2><p>Pigsty allows you to create PostgreSQL clusters with &ldquo;domestic innovation qualification&rdquo; credentials using PolarDB!</p><p>PolarDB for PostgreSQL is essentially equivalent to PostgreSQL 15. Any client tool compatible with the PostgreSQL wire protocol can access PolarDB clusters.</p><p>Pigsty&rsquo;s PGSQL repository provides PolarDB PG open-source installation packages for EL7 / EL8, but they are not downloaded to the local software repository during Pigsty installation.</p><p>If you need offline installation support for PolarDB PG, please consider our <a href=/docs/about/service>professional subscription service</a></p><p><img src=/img/pigsty/polar.jpg alt></p><hr><h2 id=installation>Installation</h2><p>If your environment has internet access, you can add the Pigsty PGSQL and dependency repositories to the node using the following method:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>local,node,pgsql</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then in <code>pg_packages</code>, replace the native <code>postgresql</code> package with <code>polardb</code>.</p><hr><h2 id=configuration>Configuration</h2><p>The following parameters need special configuration for PolarDB database clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># PGSQL &amp; PolarDB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;polardb patroni pgbouncer pgbackrest pg_exporter pgbadger vip-manager&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># do not install any vanilla postgresql extensions</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>polar                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># PolarDB Compatible Mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg_default_roles</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic># default roles and users in postgres cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbrole_readonly  ,login: false ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>role for global read-only access     }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbrole_offline   ,login: false ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>role for restricted read-only access }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbrole_readwrite ,login: false ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>role for global read-write access }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbrole_admin     ,login: false ,roles: [pg_monitor, dbrole_readwrite] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>role for object creation }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: postgres     ,superuser: true  ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>system superuser }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: replicator   ,superuser: true  ,replication: true ,roles: [pg_monitor, dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>system replicator }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;- superuser is required for replication</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_dba   ,superuser: true  ,roles: [dbrole_admin]  ,pgbouncer: true ,pool_mode: session, pool_connlimit: 16 ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_monitor ,roles: [pg_monitor] ,pgbouncer: true ,parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#204a87;font-weight:700>log_min_duration_statement: 1000 } ,pool_mode: session ,pool_connlimit: 8 ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql monitor user }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Note particularly that PolarDB PG requires the <code>replicator</code> replication user to be a Superuser, unlike native PG.</p><hr><h2 id=extension-list>Extension List</h2><p>Most <strong>PGSQL</strong> module <a href=/docs/pgsql/ext/><strong>extension plugins</strong></a> (non-pure SQL types) cannot be used directly on the PolarDB kernel. If needed, please recompile and install from source for the new kernel.</p><p>Currently, the PolarDB kernel comes with the following <strong>61</strong> extension plugins. Apart from Contrib extensions, the additional extensions provided include:</p><ul><li><code>polar_csn</code> 1.0 : polar_csn</li><li><code>polar_monitor</code> 1.2 : examine the polardb information</li><li><code>polar_monitor_preload</code> 1.1 : examine the polardb information</li><li><code>polar_parameter_check</code> 1.0 : kernel extension for parameter validation</li><li><code>polar_px</code> 1.0 : Parallel Execution extension</li><li><code>polar_stat_env</code> 1.0 : env stat functions for PolarDB</li><li><code>polar_stat_sql</code> 1.3 : Kernel statistics gathering, and sql plan nodes information gathering</li><li><code>polar_tde_utils</code> 1.0 : Internal extension for TDE</li><li><code>polar_vfs</code> 1.0 : polar_vfs</li><li><code>polar_worker</code> 1.0 : polar_worker</li><li><code>timetravel</code> 1.0 : functions for implementing time travel</li><li><code>vector</code> 0.5.1 : vector data type and ivfflat and hnsw access methods</li><li><code>smlar</code> 1.0 : compute similary of any one-dimensional arrays</li></ul><p>Complete list of available PolarDB plugins:</p><table><thead><tr><th>name</th><th>version</th><th>comment</th></tr></thead><tbody><tr><td>hstore_plpython2u</td><td>1.0</td><td>transform between hstore and plpython2u</td></tr><tr><td>dict_int</td><td>1.0</td><td>text search dictionary template for integers</td></tr><tr><td>adminpack</td><td>2.0</td><td>administrative functions for PostgreSQL</td></tr><tr><td>hstore_plpython3u</td><td>1.0</td><td>transform between hstore and plpython3u</td></tr><tr><td>amcheck</td><td>1.1</td><td>functions for verifying relation integrity</td></tr><tr><td>hstore_plpythonu</td><td>1.0</td><td>transform between hstore and plpythonu</td></tr><tr><td>autoinc</td><td>1.0</td><td>functions for autoincrementing fields</td></tr><tr><td>insert_username</td><td>1.0</td><td>functions for tracking who changed a table</td></tr><tr><td>bloom</td><td>1.0</td><td>bloom access method - signature file based index</td></tr><tr><td>file_fdw</td><td>1.0</td><td>foreign-data wrapper for flat file access</td></tr><tr><td>dblink</td><td>1.2</td><td>connect to other PostgreSQL databases from within a database</td></tr><tr><td>btree_gin</td><td>1.3</td><td>support for indexing common datatypes in GIN</td></tr><tr><td>fuzzystrmatch</td><td>1.1</td><td>determine similarities and distance between strings</td></tr><tr><td>lo</td><td>1.1</td><td>Large Object maintenance</td></tr><tr><td>intagg</td><td>1.1</td><td>integer aggregator and enumerator (obsolete)</td></tr><tr><td>btree_gist</td><td>1.5</td><td>support for indexing common datatypes in GiST</td></tr><tr><td>hstore</td><td>1.5</td><td>data type for storing sets of (key, value) pairs</td></tr><tr><td>intarray</td><td>1.2</td><td>functions, operators, and index support for 1-D arrays of integers</td></tr><tr><td>citext</td><td>1.5</td><td>data type for case-insensitive character strings</td></tr><tr><td>cube</td><td>1.4</td><td>data type for multidimensional cubes</td></tr><tr><td>hstore_plperl</td><td>1.0</td><td>transform between hstore and plperl</td></tr><tr><td>isn</td><td>1.2</td><td>data types for international product numbering standards</td></tr><tr><td>jsonb_plperl</td><td>1.0</td><td>transform between jsonb and plperl</td></tr><tr><td>dict_xsyn</td><td>1.0</td><td>text search dictionary template for extended synonym processing</td></tr><tr><td>hstore_plperlu</td><td>1.0</td><td>transform between hstore and plperlu</td></tr><tr><td>earthdistance</td><td>1.1</td><td>calculate great-circle distances on the surface of the Earth</td></tr><tr><td>pg_prewarm</td><td>1.2</td><td>prewarm relation data</td></tr><tr><td>jsonb_plperlu</td><td>1.0</td><td>transform between jsonb and plperlu</td></tr><tr><td>pg_stat_statements</td><td>1.6</td><td>track execution statistics of all SQL statements executed</td></tr><tr><td>jsonb_plpython2u</td><td>1.0</td><td>transform between jsonb and plpython2u</td></tr><tr><td>jsonb_plpython3u</td><td>1.0</td><td>transform between jsonb and plpython3u</td></tr><tr><td>jsonb_plpythonu</td><td>1.0</td><td>transform between jsonb and plpythonu</td></tr><tr><td>pg_trgm</td><td>1.4</td><td>text similarity measurement and index searching based on trigrams</td></tr><tr><td>pgstattuple</td><td>1.5</td><td>show tuple-level statistics</td></tr><tr><td>ltree</td><td>1.1</td><td>data type for hierarchical tree-like structures</td></tr><tr><td>ltree_plpython2u</td><td>1.0</td><td>transform between ltree and plpython2u</td></tr><tr><td>pg_visibility</td><td>1.2</td><td>examine the visibility map (VM) and page-level visibility info</td></tr><tr><td>ltree_plpython3u</td><td>1.0</td><td>transform between ltree and plpython3u</td></tr><tr><td>ltree_plpythonu</td><td>1.0</td><td>transform between ltree and plpythonu</td></tr><tr><td>seg</td><td>1.3</td><td>data type for representing line segments or floating-point intervals</td></tr><tr><td>moddatetime</td><td>1.0</td><td>functions for tracking last modification time</td></tr><tr><td>pgcrypto</td><td>1.3</td><td>cryptographic functions</td></tr><tr><td>pgrowlocks</td><td>1.2</td><td>show row-level locking information</td></tr><tr><td>pageinspect</td><td>1.7</td><td>inspect the contents of database pages at a low level</td></tr><tr><td>pg_buffercache</td><td>1.3</td><td>examine the shared buffer cache</td></tr><tr><td>pg_freespacemap</td><td>1.2</td><td>examine the free space map (FSM)</td></tr><tr><td>tcn</td><td>1.0</td><td>Triggered change notifications</td></tr><tr><td>plperl</td><td>1.0</td><td>PL/Perl procedural language</td></tr><tr><td>uuid-ossp</td><td>1.1</td><td>generate universally unique identifiers (UUIDs)</td></tr><tr><td>plperlu</td><td>1.0</td><td>PL/PerlU untrusted procedural language</td></tr><tr><td>refint</td><td>1.0</td><td>functions for implementing referential integrity (obsolete)</td></tr><tr><td>xml2</td><td>1.1</td><td>XPath querying and XSLT</td></tr><tr><td>plpgsql</td><td>1.0</td><td>PL/pgSQL procedural language</td></tr><tr><td>plpython3u</td><td>1.0</td><td>PL/Python3U untrusted procedural language</td></tr><tr><td>pltcl</td><td>1.0</td><td>PL/Tcl procedural language</td></tr><tr><td>pltclu</td><td>1.0</td><td>PL/TclU untrusted procedural language</td></tr><tr><td>polar_csn</td><td>1.0</td><td>polar_csn</td></tr><tr><td>sslinfo</td><td>1.2</td><td>information about SSL certificates</td></tr><tr><td>polar_monitor</td><td>1.2</td><td>examine the polardb information</td></tr><tr><td>polar_monitor_preload</td><td>1.1</td><td>examine the polardb information</td></tr><tr><td>polar_parameter_check</td><td>1.0</td><td>kernel extension for parameter validation</td></tr><tr><td>polar_px</td><td>1.0</td><td>Parallel Execution extension</td></tr><tr><td>tablefunc</td><td>1.0</td><td>functions that manipulate whole tables, including crosstab</td></tr><tr><td>polar_stat_env</td><td>1.0</td><td>env stat functions for PolarDB</td></tr><tr><td>smlar</td><td>1.0</td><td>compute similary of any one-dimensional arrays</td></tr><tr><td>timetravel</td><td>1.0</td><td>functions for implementing time travel</td></tr><tr><td>tsm_system_rows</td><td>1.0</td><td>TABLESAMPLE method which accepts number of rows as a limit</td></tr><tr><td>polar_stat_sql</td><td>1.3</td><td>Kernel statistics gathering, and sql plan nodes information gathering</td></tr><tr><td>tsm_system_time</td><td>1.0</td><td>TABLESAMPLE method which accepts time in milliseconds as a limit</td></tr><tr><td>polar_tde_utils</td><td>1.0</td><td>Internal extension for TDE</td></tr><tr><td>polar_vfs</td><td>1.0</td><td>polar_vfs</td></tr><tr><td>polar_worker</td><td>1.0</td><td>polar_worker</td></tr><tr><td>unaccent</td><td>1.1</td><td>text search dictionary that removes accents</td></tr><tr><td>postgres_fdw</td><td>1.0</td><td>foreign-data wrapper for remote PostgreSQL servers</td></tr></tbody></table><ul><li>Pigsty Professional Edition provides PolarDB offline installation support, extension plugin compilation support, and monitoring and management support specifically adapted for PolarDB clusters.</li><li>Pigsty collaborates with the Alibaba Cloud kernel team and can provide paid kernel backup support services.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ffed78d77ebf7627086f9da938f9b9f6>10 - PolarDB Oracle</h1><div class=lead>Using Alibaba Cloud&rsquo;s commercial PolarDB for Oracle kernel (closed source, PG14, only available in special enterprise edition customization)</div><p>Pigsty allows you to create PolarDB for Oracle clusters with &ldquo;domestic innovation qualification&rdquo; credentials using PolarDB!</p><p>According to the <a href=http://www.itsec.gov.cn/aqkkcp/cpgg/202312/t20231226_162074.html>Security and Reliability Evaluation Results Announcement (No. 1, 2023)</a>, Appendix 3, Centralized Database. PolarDB v2.0 is an autonomous, controllable, secure, and reliable domestic innovation database.</p><p>PolarDB for Oracle is an Oracle-compatible version developed based on PolarDB for PostgreSQL. Both share the same kernel, distinguished by the <code>--compatibility-mode</code> parameter.</p><p>We collaborate with the Alibaba Cloud kernel team to provide a complete database solution based on PolarDB v2.0 kernel and Pigsty v3.0 RDS. Please contact sales for inquiries, or purchase on Alibaba Cloud Marketplace.</p><p>The PolarDB for Oracle kernel is currently only available on EL systems.</p><p><img src=/img/pigsty/polar.jpg alt></p><hr><h2 id=extensions>Extensions</h2><p>Currently, the PolarDB 2.0 (Oracle compatible) kernel comes with the following <strong>188</strong> extension plugins:</p><table><thead><tr><th>name</th><th>default_version</th><th>comment</th></tr></thead><tbody><tr><td>cube</td><td>1.5</td><td>data type for multidimensional cubes</td></tr><tr><td>ip4r</td><td>2.4</td><td>NULL</td></tr><tr><td>adminpack</td><td>2.1</td><td>administrative functions for PostgreSQL</td></tr><tr><td>dict_xsyn</td><td>1.0</td><td>text search dictionary template for extended synonym processing</td></tr><tr><td>amcheck</td><td>1.4</td><td>functions for verifying relation integrity</td></tr><tr><td>autoinc</td><td>1.0</td><td>functions for autoincrementing fields</td></tr><tr><td>hstore</td><td>1.8</td><td>data type for storing sets of (key, value) pairs</td></tr><tr><td>bloom</td><td>1.0</td><td>bloom access method - signature file based index</td></tr><tr><td>earthdistance</td><td>1.1</td><td>calculate great-circle distances on the surface of the Earth</td></tr><tr><td>hstore_plperl</td><td>1.0</td><td>transform between hstore and plperl</td></tr><tr><td>bool_plperl</td><td>1.0</td><td>transform between bool and plperl</td></tr><tr><td>file_fdw</td><td>1.0</td><td>foreign-data wrapper for flat file access</td></tr><tr><td>bool_plperlu</td><td>1.0</td><td>transform between bool and plperlu</td></tr><tr><td>fuzzystrmatch</td><td>1.1</td><td>determine similarities and distance between strings</td></tr><tr><td>hstore_plperlu</td><td>1.0</td><td>transform between hstore and plperlu</td></tr><tr><td>btree_gin</td><td>1.3</td><td>support for indexing common datatypes in GIN</td></tr><tr><td>hstore_plpython2u</td><td>1.0</td><td>transform between hstore and plpython2u</td></tr><tr><td>btree_gist</td><td>1.6</td><td>support for indexing common datatypes in GiST</td></tr><tr><td>hll</td><td>2.17</td><td>type for storing hyperloglog data</td></tr><tr><td>hstore_plpython3u</td><td>1.0</td><td>transform between hstore and plpython3u</td></tr><tr><td>citext</td><td>1.6</td><td>data type for case-insensitive character strings</td></tr><tr><td>hstore_plpythonu</td><td>1.0</td><td>transform between hstore and plpythonu</td></tr><tr><td>hypopg</td><td>1.3.1</td><td>Hypothetical indexes for PostgreSQL</td></tr><tr><td>insert_username</td><td>1.0</td><td>functions for tracking who changed a table</td></tr><tr><td>dblink</td><td>1.2</td><td>connect to other PostgreSQL databases from within a database</td></tr><tr><td>decoderbufs</td><td>0.1.0</td><td>Logical decoding plugin that delivers WAL stream changes using a Protocol Buffer format</td></tr><tr><td>intagg</td><td>1.1</td><td>integer aggregator and enumerator (obsolete)</td></tr><tr><td>dict_int</td><td>1.0</td><td>text search dictionary template for integers</td></tr><tr><td>intarray</td><td>1.5</td><td>functions, operators, and index support for 1-D arrays of integers</td></tr><tr><td>isn</td><td>1.2</td><td>data types for international product numbering standards</td></tr><tr><td>jsonb_plperl</td><td>1.0</td><td>transform between jsonb and plperl</td></tr><tr><td>jsonb_plperlu</td><td>1.0</td><td>transform between jsonb and plperlu</td></tr><tr><td>jsonb_plpython2u</td><td>1.0</td><td>transform between jsonb and plpython2u</td></tr><tr><td>jsonb_plpython3u</td><td>1.0</td><td>transform between jsonb and plpython3u</td></tr><tr><td>jsonb_plpythonu</td><td>1.0</td><td>transform between jsonb and plpythonu</td></tr><tr><td>lo</td><td>1.1</td><td>Large Object maintenance</td></tr><tr><td>log_fdw</td><td>1.0</td><td>foreign-data wrapper for csvlog</td></tr><tr><td>ltree</td><td>1.2</td><td>data type for hierarchical tree-like structures</td></tr><tr><td>ltree_plpython2u</td><td>1.0</td><td>transform between ltree and plpython2u</td></tr><tr><td>ltree_plpython3u</td><td>1.0</td><td>transform between ltree and plpython3u</td></tr><tr><td>ltree_plpythonu</td><td>1.0</td><td>transform between ltree and plpythonu</td></tr><tr><td>moddatetime</td><td>1.0</td><td>functions for tracking last modification time</td></tr><tr><td>old_snapshot</td><td>1.0</td><td>utilities in support of old_snapshot_threshold</td></tr><tr><td>oracle_fdw</td><td>1.2</td><td>foreign data wrapper for Oracle access</td></tr><tr><td>oss_fdw</td><td>1.1</td><td>foreign-data wrapper for OSS access</td></tr><tr><td>pageinspect</td><td>2.1</td><td>inspect the contents of database pages at a low level</td></tr><tr><td>pase</td><td>0.0.1</td><td>ant ai similarity search</td></tr><tr><td>pg_bigm</td><td>1.2</td><td>text similarity measurement and index searching based on bigrams</td></tr><tr><td>pg_freespacemap</td><td>1.2</td><td>examine the free space map (FSM)</td></tr><tr><td>pg_hint_plan</td><td>1.4</td><td>controls execution plan with hinting phrases in comment of special form</td></tr><tr><td>pg_buffercache</td><td>1.5</td><td>examine the shared buffer cache</td></tr><tr><td>pg_prewarm</td><td>1.2</td><td>prewarm relation data</td></tr><tr><td>pg_repack</td><td>1.4.8-1</td><td>Reorganize tables in PostgreSQL databases with minimal locks</td></tr><tr><td>pg_sphere</td><td>1.0</td><td>spherical objects with useful functions, operators and index support</td></tr><tr><td>pg_cron</td><td>1.5</td><td>Job scheduler for PostgreSQL</td></tr><tr><td>pg_jieba</td><td>1.1.0</td><td>a parser for full-text search of Chinese</td></tr><tr><td>pg_stat_kcache</td><td>2.2.1</td><td>Kernel statistics gathering</td></tr><tr><td>pg_stat_statements</td><td>1.9</td><td>track planning and execution statistics of all SQL statements executed</td></tr><tr><td>pg_surgery</td><td>1.0</td><td>extension to perform surgery on a damaged relation</td></tr><tr><td>pg_trgm</td><td>1.6</td><td>text similarity measurement and index searching based on trigrams</td></tr><tr><td>pg_visibility</td><td>1.2</td><td>examine the visibility map (VM) and page-level visibility info</td></tr><tr><td>pg_wait_sampling</td><td>1.1</td><td>sampling based statistics of wait events</td></tr><tr><td>pgaudit</td><td>1.6.2</td><td>provides auditing functionality</td></tr><tr><td>pgcrypto</td><td>1.3</td><td>cryptographic functions</td></tr><tr><td>pgrowlocks</td><td>1.2</td><td>show row-level locking information</td></tr><tr><td>pgstattuple</td><td>1.5</td><td>show tuple-level statistics</td></tr><tr><td>pgtap</td><td>1.2.0</td><td>Unit testing for PostgreSQL</td></tr><tr><td>pldbgapi</td><td>1.1</td><td>server-side support for debugging PL/pgSQL functions</td></tr><tr><td>plperl</td><td>1.0</td><td>PL/Perl procedural language</td></tr><tr><td>plperlu</td><td>1.0</td><td>PL/PerlU untrusted procedural language</td></tr><tr><td>plpgsql</td><td>1.0</td><td>PL/pgSQL procedural language</td></tr><tr><td>plpython2u</td><td>1.0</td><td>PL/Python2U untrusted procedural language</td></tr><tr><td>plpythonu</td><td>1.0</td><td>PL/PythonU untrusted procedural language</td></tr><tr><td>plsql</td><td>1.0</td><td>Oracle compatible PL/SQL procedural language</td></tr><tr><td>pltcl</td><td>1.0</td><td>PL/Tcl procedural language</td></tr><tr><td>pltclu</td><td>1.0</td><td>PL/TclU untrusted procedural language</td></tr><tr><td>polar_bfile</td><td>1.0</td><td>The BFILE data type enables access to binary file LOBs that are stored in file systems outside Database</td></tr><tr><td>polar_bpe</td><td>1.0</td><td>polar_bpe</td></tr><tr><td>polar_builtin_cast</td><td>1.1</td><td>Internal extension for builtin casts</td></tr><tr><td>polar_builtin_funcs</td><td>2.0</td><td>implement polar builtin functions</td></tr><tr><td>polar_builtin_type</td><td>1.5</td><td>polar_builtin_type for PolarDB</td></tr><tr><td>polar_builtin_view</td><td>1.5</td><td>polar_builtin_view</td></tr><tr><td>polar_catalog</td><td>1.2</td><td>polardb pg extend catalog</td></tr><tr><td>polar_channel</td><td>1.0</td><td>polar_channel</td></tr><tr><td>polar_constraint</td><td>1.0</td><td>polar_constraint</td></tr><tr><td>polar_csn</td><td>1.0</td><td>polar_csn</td></tr><tr><td>polar_dba_views</td><td>1.0</td><td>polar_dba_views</td></tr><tr><td>polar_dbms_alert</td><td>1.2</td><td>implement polar_dbms_alert - supports asynchronous notification of database events.</td></tr><tr><td>polar_dbms_application_info</td><td>1.0</td><td>implement polar_dbms_application_info - record names of executing modules or transactions in the database.</td></tr><tr><td>polar_dbms_pipe</td><td>1.1</td><td>implements polar_dbms_pipe - package lets two or more sessions in the same instance communicate.</td></tr><tr><td>polar_dbms_aq</td><td>1.2</td><td>implement dbms_aq - provides an interface to Advanced Queuing.</td></tr><tr><td>polar_dbms_lob</td><td>1.3</td><td>implement dbms_lob - provides subprograms to operate on BLOBs, CLOBs, and NCLOBs.</td></tr><tr><td>polar_dbms_output</td><td>1.2</td><td>implement polar_dbms_output - enables you to send messages from stored procedures.</td></tr><tr><td>polar_dbms_lock</td><td>1.0</td><td>implement polar_dbms_lock - provides an interface to Oracle Lock Management services.</td></tr><tr><td>polar_dbms_aqadm</td><td>1.3</td><td>polar_dbms_aqadm - procedures to manage Advanced Queuing configuration and administration information.</td></tr><tr><td>polar_dbms_assert</td><td>1.0</td><td>implement polar_dbms_assert - provide an interface to validate properties of the input value.</td></tr><tr><td>polar_dbms_metadata</td><td>1.0</td><td>implement polar_dbms_metadata - provides a way for you to retrieve metadata from the database dictionary.</td></tr><tr><td>polar_dbms_random</td><td>1.0</td><td>implement polar_dbms_random - a built-in random number generator, not intended for cryptography</td></tr><tr><td>polar_dbms_crypto</td><td>1.1</td><td>implement dbms_crypto - provides an interface to encrypt and decrypt stored data.</td></tr><tr><td>polar_dbms_redact</td><td>1.0</td><td>implement polar_dbms_redact - provides an interface to mask data from queries by an application.</td></tr><tr><td>polar_dbms_debug</td><td>1.1</td><td>server-side support for debugging PL/SQL functions</td></tr><tr><td>polar_dbms_job</td><td>1.0</td><td>polar_dbms_job</td></tr><tr><td>polar_dbms_mview</td><td>1.1</td><td>implement polar_dbms_mview - enables to refresh materialized views.</td></tr><tr><td>polar_dbms_job_preload</td><td>1.0</td><td>polar_dbms_job_preload</td></tr><tr><td>polar_dbms_obfuscation_toolkit</td><td>1.1</td><td>implement polar_dbms_obfuscation_toolkit - enables an application to get data md5.</td></tr><tr><td>polar_dbms_rls</td><td>1.1</td><td>implement polar_dbms_rls - a fine-grained access control administrative built-in package</td></tr><tr><td>polar_multi_toast_utils</td><td>1.0</td><td>polar_multi_toast_utils</td></tr><tr><td>polar_dbms_session</td><td>1.2</td><td>implement polar_dbms_session - support to set preferences and security levels.</td></tr><tr><td>polar_odciconst</td><td>1.0</td><td>implement ODCIConst - Provide some built-in constants in Oracle.</td></tr><tr><td>polar_dbms_sql</td><td>1.2</td><td>implement polar_dbms_sql - provides an interface to execute dynamic SQL.</td></tr><tr><td>polar_osfs_toolkit</td><td>1.0</td><td>osfs library tools and functions extension</td></tr><tr><td>polar_dbms_stats</td><td>14.0</td><td>stabilize plans by fixing statistics</td></tr><tr><td>polar_monitor</td><td>1.5</td><td>monitor functions for PolarDB</td></tr><tr><td>polar_osfs_utils</td><td>1.0</td><td>osfs library utils extension</td></tr><tr><td>polar_dbms_utility</td><td>1.3</td><td>implement polar_dbms_utility - provides various utility subprograms.</td></tr><tr><td>polar_parameter_check</td><td>1.0</td><td>kernel extension for parameter validation</td></tr><tr><td>polar_dbms_xmldom</td><td>1.0</td><td>implement dbms_xmldom and dbms_xmlparser - support standard DOM interface and xml parser object</td></tr><tr><td>polar_parameter_manager</td><td>1.1</td><td>Extension to select parameters for manger.</td></tr><tr><td>polar_faults</td><td>1.0.0</td><td>simulate some database faults for end user or testing system.</td></tr><tr><td>polar_monitor_preload</td><td>1.1</td><td>examine the polardb information</td></tr><tr><td>polar_proxy_utils</td><td>1.0</td><td>Extension to provide operations about proxy.</td></tr><tr><td>polar_feature_utils</td><td>1.2</td><td>PolarDB feature utilization</td></tr><tr><td>polar_global_awr</td><td>1.0</td><td>PolarDB Global AWR Report</td></tr><tr><td>polar_publication</td><td>1.0</td><td>support polardb pg logical replication</td></tr><tr><td>polar_global_cache</td><td>1.0</td><td>polar_global_cache</td></tr><tr><td>polar_px</td><td>1.0</td><td>Parallel Execution extension</td></tr><tr><td>polar_serverless</td><td>1.0</td><td>polar serverless extension</td></tr><tr><td>polar_resource_manager</td><td>1.0</td><td>a background process that forcibly frees user session process memory</td></tr><tr><td>polar_sys_context</td><td>1.1</td><td>implement polar_sys_context - returns the value of parameter associated with the context namespace at the current instant.</td></tr><tr><td>polar_gpc</td><td>1.3</td><td>polar_gpc</td></tr><tr><td>polar_tde_utils</td><td>1.0</td><td>Internal extension for TDE</td></tr><tr><td>polar_gtt</td><td>1.1</td><td>polar_gtt</td></tr><tr><td>polar_utl_encode</td><td>1.2</td><td>implement polar_utl_encode - provides functions that encode RAW data into a standard encoded format</td></tr><tr><td>polar_htap</td><td>1.1</td><td>extension for PolarDB HTAP</td></tr><tr><td>polar_htap_db</td><td>1.0</td><td>extension for PolarDB HTAP database level operation</td></tr><tr><td>polar_io_stat</td><td>1.0</td><td>polar io stat in multi dimension</td></tr><tr><td>polar_utl_file</td><td>1.0</td><td>implement utl_file - support PL/SQL programs can read and write operating system text files</td></tr><tr><td>polar_ivm</td><td>1.0</td><td>polar_ivm</td></tr><tr><td>polar_sql_mapping</td><td>1.2</td><td>Record error sqls and mapping them to correct one</td></tr><tr><td>polar_stat_sql</td><td>1.0</td><td>Kernel statistics gathering, and sql plan nodes information gathering</td></tr><tr><td>tds_fdw</td><td>2.0.2</td><td>Foreign data wrapper for querying a TDS database (Sybase or Microsoft SQL Server)</td></tr><tr><td>xml2</td><td>1.1</td><td>XPath querying and XSLT</td></tr><tr><td>polar_upgrade_catalogs</td><td>1.1</td><td>Upgrade catalogs for old version instance</td></tr><tr><td>polar_utl_i18n</td><td>1.1</td><td>polar_utl_i18n</td></tr><tr><td>polar_utl_raw</td><td>1.0</td><td>implement utl_raw - provides SQL functions for manipulating RAW datatypes.</td></tr><tr><td>timescaledb</td><td>2.9.2</td><td>Enables scalable inserts and complex queries for time-series data</td></tr><tr><td>polar_vfs</td><td>1.0</td><td>polar virtual file system for different storage</td></tr><tr><td>polar_worker</td><td>1.0</td><td>polar_worker</td></tr><tr><td>postgres_fdw</td><td>1.1</td><td>foreign-data wrapper for remote PostgreSQL servers</td></tr><tr><td>refint</td><td>1.0</td><td>functions for implementing referential integrity (obsolete)</td></tr><tr><td>roaringbitmap</td><td>0.5</td><td>support for Roaring Bitmaps</td></tr><tr><td>tsm_system_time</td><td>1.0</td><td>TABLESAMPLE method which accepts time in milliseconds as a limit</td></tr><tr><td>vector</td><td>0.5.0</td><td>vector data type and ivfflat and hnsw access methods</td></tr><tr><td>rum</td><td>1.3</td><td>RUM index access method</td></tr><tr><td>unaccent</td><td>1.1</td><td>text search dictionary that removes accents</td></tr><tr><td>seg</td><td>1.4</td><td>data type for representing line segments or floating-point intervals</td></tr><tr><td>sequential_uuids</td><td>1.0.2</td><td>generator of sequential UUIDs</td></tr><tr><td>uuid-ossp</td><td>1.1</td><td>generate universally unique identifiers (UUIDs)</td></tr><tr><td>smlar</td><td>1.0</td><td>compute similary of any one-dimensional arrays</td></tr><tr><td>varbitx</td><td>1.1</td><td>varbit functions pack</td></tr><tr><td>sslinfo</td><td>1.2</td><td>information about SSL certificates</td></tr><tr><td>tablefunc</td><td>1.0</td><td>functions that manipulate whole tables, including crosstab</td></tr><tr><td>tcn</td><td>1.0</td><td>Triggered change notifications</td></tr><tr><td>zhparser</td><td>1.0</td><td>a parser for full-text search of Chinese</td></tr><tr><td>address_standardizer</td><td>3.3.2</td><td>Ganos PostGIS address standardizer</td></tr><tr><td>address_standardizer_data_us</td><td>3.3.2</td><td>Ganos PostGIS address standardizer data us</td></tr><tr><td>ganos_fdw</td><td>6.0</td><td>Ganos Spatial FDW extension for POLARDB</td></tr><tr><td>ganos_geometry</td><td>6.0</td><td>Ganos geometry lite extension for POLARDB</td></tr><tr><td>ganos_geometry_pyramid</td><td>6.0</td><td>Ganos Geometry Pyramid extension for POLARDB</td></tr><tr><td>ganos_geometry_sfcgal</td><td>6.0</td><td>Ganos geometry lite sfcgal extension for POLARDB</td></tr><tr><td>ganos_geomgrid</td><td>6.0</td><td>Ganos geometry grid extension for POLARDB</td></tr><tr><td>ganos_importer</td><td>6.0</td><td>Ganos Spatial importer extension for POLARDB</td></tr><tr><td>ganos_networking</td><td>6.0</td><td>Ganos networking</td></tr><tr><td>ganos_pointcloud</td><td>6.0</td><td>Ganos pointcloud extension For POLARDB</td></tr><tr><td>ganos_pointcloud_geometry</td><td>6.0</td><td>Ganos_pointcloud LIDAR data and ganos_geometry data for POLARDB</td></tr><tr><td>ganos_raster</td><td>6.0</td><td>Ganos raster extension for POLARDB</td></tr><tr><td>ganos_scene</td><td>6.0</td><td>Ganos scene extension for POLARDB</td></tr><tr><td>ganos_sfmesh</td><td>6.0</td><td>Ganos surface mesh extension for POLARDB</td></tr><tr><td>ganos_spatialref</td><td>6.0</td><td>Ganos spatial reference extension for POLARDB</td></tr><tr><td>ganos_trajectory</td><td>6.0</td><td>Ganos trajectory extension for POLARDB</td></tr><tr><td>ganos_vomesh</td><td>6.0</td><td>Ganos volumn mesh extension for POLARDB</td></tr><tr><td>postgis_tiger_geocoder</td><td>3.3.2</td><td>Ganos PostGIS tiger geocoder</td></tr><tr><td>postgis_topology</td><td>3.3.2</td><td>Ganos PostGIS topology</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-e59a81d2edf1c2072f834e4d8ef376db>11 - PostgresML</h1><div class=lead>How to deploy PostgresML with Pigsty: ML, training, inference, Embedding, RAG inside DB.</div><p><a href=https://postgresml.org/>PostgresML</a> is a PostgreSQL extension that supports the latest large language models (LLM), vector operations, classical machine learning, and traditional Postgres application workloads.</p><p>PostgresML (pgml) is a PostgreSQL extension written in Rust. You can run standalone Docker images, but this documentation is not a docker-compose template introduction, for reference only.</p><p>PostgresML officially supports Ubuntu 22.04, but we also maintain RPM versions for EL 8/9, if you don&rsquo;t need CUDA and NVIDIA-related features.</p><p>You need internet access on database nodes to download Python dependencies from PyPI and models from HuggingFace.</p><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>PostgresML is Deprecated</div><p>Because the company behind it has ceased operations.</p></div><hr><h2 id=configuration>Configuration</h2><p>PostgresML is an extension written in Rust, officially supporting Ubuntu. Pigsty maintains RPM versions of PostgresML on EL8 and EL9.</p><p><strong>Creating a New Cluster</strong></p><p>PostgresML 2.7.9 is available for PostgreSQL 15, supporting Ubuntu 22.04 (official), Debian 12, and EL 8/9 (maintained by Pigsty). To enable <code>pgml</code>, you first need to install the extension:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_meta     ,password: DBUser.Meta     ,pgbouncer: true ,roles: [dbrole_admin]    ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>name: dbuser_view     ,password: DBUser.Viewer   ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer for meta database }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span>{<span style=color:#204a87;font-weight:700>name: postgis, schema</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>public}, {name: timescaledb}]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_hba_rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#204a87;font-weight:700>user: dbuser_view , db: all ,addr: infra ,auth: pwd ,title</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;allow grafana dashboard access cmdb from infra nodes&#39;</span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;pgml, pg_stat_statements, auto_explain&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;pgml_15 pgvector_15 wal2json_15 repack_15&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># ubuntu</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#pg_extensions: [ &#39;postgresql-pgml-15 postgresql-15-pgvector postgresql-15-wal2json postgresql-15-repack&#39; ]  # ubuntu</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>On EL 8/9, the extension name is <code>pgml_15</code>, corresponding to the Ubuntu/Debian name <code>postgresql-pgml-15</code>. You also need to add <code>pgml</code> to <code>pg_libs</code>.</p><p><strong>Enabling on an Existing Cluster</strong></p><p>To enable <code>pgml</code> on an existing cluster, you can install it using Ansible&rsquo;s <code>package</code> module:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible pg-meta -m package -b -a <span style=color:#4e9a06>&#39;name=pgml_15&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ansible el8,el9 -m package -b -a &#39;name=pgml_15&#39;           # EL 8/9</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ansible u22 -m package -b -a &#39;name=postgresql-pgml-15&#39;    # Ubuntu 22.04 jammy</span>
</span></span></code></pre></div><hr><h2 id=python-dependencies>Python Dependencies</h2><p>You also need to install PostgresML&rsquo;s Python dependencies on cluster nodes. Official tutorial: <a href=https://postgresml.org/docs/guides/developer-docs/installation>Installation Guide</a></p><p><strong>Install Python and PIP</strong></p><p>Ensure <code>python3</code>, <code>pip</code>, and <code>venv</code> are installed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Ubuntu 22.04 (python3.10), need to install pip and venv using apt</span>
</span></span><span style=display:flex><span>sudo apt install -y python3 python3-pip python3-venv
</span></span></code></pre></div><p>For EL 8 / EL9 and compatible distributions, you can use python3.11:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># EL 8/9, can upgrade the default pip and virtualenv</span>
</span></span><span style=display:flex><span>sudo yum install -y python3.11 python3.11-pip       <span style=color:#8f5902;font-style:italic># install latest python3.11</span>
</span></span><span style=display:flex><span>python3.11 -m pip install --upgrade pip virtualenv  <span style=color:#8f5902;font-style:italic># use python3.11 on EL8 / EL9</span>
</span></span></code></pre></div><details><summary>Using PyPI Mirrors</summary><p>For users in mainland China, we recommend using Tsinghua University&rsquo;s PyPI <a href=https://mirrors.tuna.tsinghua.edu.cn/help/pypi/>mirror</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip config <span style=color:#204a87>set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple    <span style=color:#8f5902;font-style:italic># set global mirror (recommended)</span>
</span></span><span style=display:flex><span>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package        <span style=color:#8f5902;font-style:italic># use for single installation</span>
</span></span></code></pre></div></details><p><strong>Install Dependencies</strong></p><p>Create a Python virtual environment and use <code>pip</code> to install dependencies from <a href=https://github.com/postgresml/postgresml/blob/master/pgml-extension/requirements.txt><code>requirements.txt</code></a> and <a href=https://github.com/postgresml/postgresml/blob/master/pgml-extension/requirements-xformers.txt><code>requirements-xformers.txt</code></a>.</p><blockquote><p>If you&rsquo;re using EL 8/9, replace <code>python3</code> with <code>python3.11</code> in the following commands.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>su - postgres<span style=color:#000;font-weight:700>;</span>                          <span style=color:#8f5902;font-style:italic># create virtual environment as database superuser</span>
</span></span><span style=display:flex><span>mkdir -p /data/pgml<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> /data/pgml<span style=color:#000;font-weight:700>;</span>     <span style=color:#8f5902;font-style:italic># create virtual environment directory</span>
</span></span><span style=display:flex><span>python3    -m venv /data/pgml           <span style=color:#8f5902;font-style:italic># create virtual environment directory (Ubuntu 22.04)</span>
</span></span><span style=display:flex><span><span style=color:#204a87>source</span> /data/pgml/bin/activate          <span style=color:#8f5902;font-style:italic># activate virtual environment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># write Python dependencies and install with pip</span>
</span></span><span style=display:flex><span>cat &gt; /data/pgml/requirments.txt <span style=color:#4e9a06>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>accelerate==0.22.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>auto-gptq==0.4.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>bitsandbytes==0.41.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>catboost==1.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>ctransformers==0.2.27
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>datasets==2.14.5
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>deepspeed==0.10.3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>huggingface-hub==0.17.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>InstructorEmbedding==1.0.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>lightgbm==4.1.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>orjson==3.9.7
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>pandas==2.1.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>rich==13.5.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>rouge==1.0.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>sacrebleu==2.3.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>sacremoses==0.0.53
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>scikit-learn==1.3.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>sentencepiece==0.1.99
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>sentence-transformers==2.2.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>tokenizers==0.13.3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>torch==2.0.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>torchaudio==2.0.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>torchvision==0.15.2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>tqdm==4.66.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>transformers==4.33.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>xgboost==2.0.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>langchain==0.0.287
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>einops==0.6.1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>pynvml==11.5.0
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># install dependencies using pip in the virtual environment</span>
</span></span><span style=display:flex><span>python3 -m pip install -r /data/pgml/requirments.txt
</span></span><span style=display:flex><span>python3 -m pip install <span style=color:#000>xformers</span><span style=color:#ce5c00;font-weight:700>==</span>0.0.21 --no-dependencies
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># additionally, 3 Python packages need to be installed globally using sudo!</span>
</span></span><span style=display:flex><span>sudo python3 -m pip install xgboost lightgbm scikit-learn
</span></span></code></pre></div><hr><h2 id=enable-postgresml>Enable PostgresML</h2><p>After installing the <code>pgml</code> extension and Python dependencies on all cluster nodes, you can enable <code>pgml</code> on the PostgreSQL cluster.</p><p>Use the <code>patronictl</code> command to <a href=https://pigsty.io/docs/pgsql/admin/#config-cluster>configure the cluster</a>, add <code>pgml</code> to <code>shared_preload_libraries</code>, and specify your virtual environment directory in <code>pgml.venv</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>shared_preload_libraries</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgml, timescaledb, pg_stat_statements, auto_explain</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pgml.venv</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data/pgml&#39;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then restart the database cluster and create the extension using SQL commands:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#000>EXTENSION</span><span style=color:#f8f8f8> </span><span style=color:#000>vector</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>-- also recommend installing pgvector!
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#000>EXTENSION</span><span style=color:#f8f8f8> </span><span style=color:#000>pgml</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>          </span><span style=color:#8f5902;font-style:italic>-- create PostgresML in the current database
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#000>pgml</span><span style=color:#000;font-weight:700>.</span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8>          </span><span style=color:#8f5902;font-style:italic>-- print PostgresML version information
</span></span></span></code></pre></div><p>If everything is normal, you should see output similar to the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># create extension pgml;</span>
</span></span><span style=display:flex><span>INFO:  Python version: 3.11.2 <span style=color:#ce5c00;font-weight:700>(</span>main, Oct  <span style=color:#0000cf;font-weight:700>5</span> 2023, 16:06:03<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 8.5.0 <span style=color:#0000cf;font-weight:700>20210514</span> <span style=color:#ce5c00;font-weight:700>(</span>Red Hat 8.5.0-18<span style=color:#ce5c00;font-weight:700>)]</span>
</span></span><span style=display:flex><span>INFO:  Scikit-learn 1.3.0, XGBoost 2.0.0, LightGBM 4.1.0, NumPy 1.26.1
</span></span><span style=display:flex><span>CREATE EXTENSION
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># SELECT pgml.version(); -- print PostgresML version information</span>
</span></span><span style=display:flex><span> version
</span></span><span style=display:flex><span>---------
</span></span><span style=display:flex><span> 2.7.8
</span></span></code></pre></div><p>Done! For more details, please refer to the official PostgresML documentation: <a href=https://postgresml.org/docs/guides/use-cases/>https://postgresml.org/docs/guides/use-cases/</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-227e1bd7e26827efbe4f8ed91ee4c679>12 - Greenplum</h1><div class=lead>Deploy/Monitor Greenplum clusters with Pigsty, build Massively Parallel Processing (MPP) PostgreSQL data warehouse clusters!</div><p>Pigsty supports deploying Greenplum clusters and its derivative distribution YMatrixDB, and provides the capability to integrate existing Greenplum deployments into Pigsty monitoring.</p><hr><h2 id=overview>Overview</h2><p>Greenplum / YMatrix cluster deployment capabilities are only available in the professional/enterprise editions and are not currently open source.</p><hr><h2 id=installation>Installation</h2><p>Pigsty provides installation packages for Greenplum 6 (@el7) and Greenplum 7 (@el8). Open source users can install and configure them manually.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># EL 7 Only (Greenplum6)</span>
</span></span><span style=display:flex><span>./node.yml -t node_install  -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;pgsql&#34;,&#34;node_packages&#34;:[&#34;open-source-greenplum-db-6&#34;]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># EL 8 Only (Greenplum7)</span>
</span></span><span style=display:flex><span>./node.yml -t node_install  -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;pgsql&#34;,&#34;node_packages&#34;:[&#34;open-source-greenplum-db-7&#34;]}&#39;</span>
</span></span></code></pre></div><hr><h2 id=configuration>Configuration</h2><p>To define a Greenplum cluster, you need to use <code>pg_mode</code> = <code>gpsql</code> and additional identity parameters <code>pg_shard</code> and <code>gp_role</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#================================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                        GPSQL Clusters                          #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#================================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cluster: mx-mdw (gp master)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>mx-mdw</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role: primary , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-mdw-1 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>gp_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>master         </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># this cluster is used as greenplum master</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_shard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pgsql sharding name &amp; gpsql deployment name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-mdw      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># this master cluster name is mx-mdw</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: matrixmgr , extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>matrixdbts } ] }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>meta }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta , password: DBUser.Meta , pgbouncer</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_monitor , password: DBUser.Monitor , roles: [ dbrole_readonly ], superuser</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pgbouncer_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># enable pgbouncer for greenplum master</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pgbouncer_exporter_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># enable pgbouncer_exporter for greenplum master</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_exporter_params</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;host=127.0.0.1&amp;sslmode=disable&#39;</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># use 127.0.0.1 as local monitor host</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cluster: mx-sdw (gp master)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#----------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>mx-sdw</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-sdw-1       </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># greenplum segment node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>pg_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># greenplum segment instances</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6000</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg1, pg_seq: 1, pg_role: primary , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9633</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6001</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg2, pg_seq: 2, pg_role: replica , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9634</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-sdw-2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>pg_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6000</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg2, pg_seq: 1, pg_role: primary , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9633</span><span style=color:#f8f8f8>  </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6001</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg3, pg_seq: 2, pg_role: replica , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9634</span><span style=color:#f8f8f8>  </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-sdw-3</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>pg_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6000</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg3, pg_seq: 1, pg_role: primary , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9633</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>6001</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster: mx-seg1, pg_seq: 2, pg_role: replica , pg_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9634</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>gp_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>segment              </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># these are nodes for gp segments</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_shard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx                  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pgsql sharding name &amp; gpsql deployment name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mx-sdw            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># these segment clusters name is mx-sdw</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_preflight_skip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># skip preflight check (since pg_seq &amp; pg_role &amp; pg_cluster not exists)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_exporter_config</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg_exporter_basic.yml                            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># use basic config to avoid segment server crash</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_exporter_params</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;options=-c%20gp_role%3Dutility&amp;sslmode=disable&#39;</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># use gp_role = utility to connect to segments</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Additionally, PG Exporter requires extra connection parameters to connect to Greenplum Segment instances for metric collection.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a970dfd99688547f0ffb0bf4d5c4de61>13 - Cloudberry</h1><div class=lead>Deploy/Monitor Cloudberry clusters with Pigsty, an MPP data warehouse cluster forked from Greenplum!</div><hr><h2 id=installation>Installation</h2><p>Pigsty provides installation packages for Greenplum 6 (@el7) and Greenplum 7 (@el8). Open source users can install and configure them manually.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># EL 7 Only (Greenplum6)</span>
</span></span><span style=display:flex><span>./node.yml -t node_install  -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;pgsql&#34;,&#34;node_packages&#34;:[&#34;cloudberrydb&#34;]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># EL 8 Only (Greenplum7)</span>
</span></span><span style=display:flex><span>./node.yml -t node_install  -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;pgsql&#34;,&#34;node_packages&#34;:[&#34;cloudberrydb&#34;]}&#39;</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-2342a2eaca8515e616cb1dfa8c4db39d>14 - Neon</h1><div class=lead>Use Neon&rsquo;s open-source Serverless PostgreSQL kernel to build flexible, scale-to-zero, forkable PG services.</div><p><a href=https://github.com/neondatabase/neon><strong>Neon</strong></a> adopts a storage and compute separation architecture, providing seamless autoscaling, scale to zero, and unique database branching capabilities.</p><p>Neon official website: <a href=https://neon.tech/>https://neon.tech/</a></p><p>The compiled binaries of Neon are excessively large and are currently not available to open-source users. It is currently in the pilot stage. If you have requirements, please contact Pigsty sales.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email - Vonng" aria-label="Email - Vonng"><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label="Email - Vonng"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=WeChat aria-label=WeChat><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=WeChat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=Discussion><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Repo aria-label=Repo><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=Repo><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
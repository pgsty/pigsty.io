<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><link rel=canonical type=text/html href=https://pigsty.io/docs/minio/><link rel=alternate type=application/rss+xml href=https://pigsty.io/docs/minio/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Module: MINIO | PIGSTY</title><meta name=description content="Pigsty has built-in MinIO support, an open-source S3-compatible object storage that can be used for PGSQL cold backup storage."><meta property="og:url" content="https://pigsty.io/docs/minio/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="Module: MINIO"><meta property="og:description" content="Pigsty has built-in MinIO support, an open-source S3-compatible object storage that can be used for PGSQL cold backup storage."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Module: MINIO"><meta itemprop=description content="Pigsty has built-in MinIO support, an open-source S3-compatible object storage that can be used for PGSQL cold backup storage."><meta itemprop=dateModified content="2026-01-08T18:48:49+08:00"><meta itemprop=wordCount content="317"><meta itemprop=keywords content="Reference,MINIO"><meta name=twitter:card content="summary"><meta name=twitter:title content="Module: MINIO"><meta name=twitter:description content="Pigsty has built-in MinIO support, an open-source S3-compatible object storage that can be used for PGSQL cold backup storage."><link rel=preload href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css as=style integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><link href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css rel=stylesheet integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Ver</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.cc>Pigsty 中文网站</a></li><li><a class=dropdown-item href=https://doc.pgsty.com>Pigsty v3.7 Doc</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc>Pigsty v3.4 Doc</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 Doc</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 Doc</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch Language / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d757e151050fd40088751a74721d74f6.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:window.location.href="https://pigsty.cc"+e}</script></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/minio/>Return to the regular view of this page</a>.</p></div><h1 class=title>Module: MINIO</h1><div class=lead>Pigsty has built-in MinIO support, an open-source S3-compatible object storage that can be used for PGSQL cold backup storage.</div><ul><li>1: <a href=#pg-45b8da1dfca6b0e91aef873f7b72b337>Usage</a></li><li>2: <a href=#pg-08605fa7a960e0149e3c22312586b71e>Configuration</a></li><li>3: <a href=#pg-280b7e56b08e272d7b26411d506d6c5d>Parameters</a></li><li>4: <a href=#pg-ccc1805ae841df3ebaeb7bb6b8008203>Playbook</a></li><li>5: <a href=#pg-172708bf70f3c5729ee49aac66787c09>Administration</a></li><li>6: <a href=#pg-81383092950ff4115e1c3850be65d36f>Monitoring</a></li><li>7: <a href=#pg-61857417600e2adc512dcba599edd776>Metrics</a></li><li>8: <a href=#pg-571982477397f0d78a3a5034a4ef3e1d>FAQ</a></li></ul><div class=content><p><a href=https://min.io/>MinIO</a> is an S3-compatible multi-cloud object storage software, open-sourced under the AGPLv3 license.</p><p>MinIO can be used to store documents, images, videos, and backups. Pigsty natively supports deploying various MinIO clusters with native multi-node multi-disk high availability support, easy to scale, secure, and ready to use out of the box.
It has been used in production environments at 10PB+ scale.</p><p>MinIO is an <a href=/docs/ref/module><strong>optional module</strong></a> in Pigsty. You can use MinIO as an optional storage repository for PostgreSQL <a href=/docs/pgsql/backup/repository/><strong>backups</strong></a>, supplementing the default local POSIX filesystem repository.
If using the MinIO backup repository, the <code>MINIO</code> module should be installed before any <a href=/docs/pgsql><code>PGSQL</code></a> modules. MinIO requires a trusted CA certificate to work, so it depends on the <a href=/docs/node><code>NODE</code></a> module.</p><hr><h2 id=quick-start>Quick Start</h2><p>Here&rsquo;s a simple example of MinIO single-node single-disk deployment:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Define MinIO cluster in the config inventory</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio } }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio    <span style=color:#8f5902;font-style:italic># Deploy MinIO module on the minio group</span>
</span></span></code></pre></div><p>After deployment, you can access MinIO via:</p><ul><li><strong>S3 API</strong>: <code>https://sss.pigsty:9000</code> (requires DNS resolution for the domain)</li><li><strong>Web Console</strong>: <code>https://&lt;minio-ip>:9001</code> (default username/password: <code>minioadmin</code> / <code>S3User.MinIO</code>)</li><li><strong>Command Line</strong>: <code>mcli ls sss/</code> (alias pre-configured on the admin node)</li></ul><hr><h2 id=deployment-modes>Deployment Modes</h2><p>MinIO supports three major deployment modes:</p><table><thead><tr><th style=text-align:left>Mode</th><th style=text-align:left>Description</th><th style=text-align:left>Use Cases</th></tr></thead><tbody><tr><td style=text-align:left><a href=config#single-node-single-disk><strong>Single-Node Single-Disk</strong></a> (SNSD)</td><td style=text-align:left>Single node, single data directory</td><td style=text-align:left>Development, testing, demo</td></tr><tr><td style=text-align:left><a href=config#single-node-multi-disk><strong>Single-Node Multi-Disk</strong></a> (SNMD)</td><td style=text-align:left>Single node, multiple disks</td><td style=text-align:left>Resource-constrained small-scale deployments</td></tr><tr><td style=text-align:left><a href=config#multi-node-multi-disk><strong>Multi-Node Multi-Disk</strong></a> (MNMD)</td><td style=text-align:left>Multiple nodes, multiple disks per node</td><td style=text-align:left><strong>Recommended for production</strong></td></tr></tbody></table><p>Additionally, you can use <a href=config#multi-pool>multi-pool deployment</a> to scale existing clusters, or deploy <a href=config#multiple-clusters>multiple clusters</a>.</p><hr><h2 id=key-features>Key Features</h2><ul><li><strong>S3 Compatible</strong>: Fully compatible with AWS S3 API, seamlessly integrates with various S3 clients and tools</li><li><strong>High Availability</strong>: Native support for multi-node multi-disk deployment, tolerates node and disk failures</li><li><strong>Secure</strong>: HTTPS encrypted transmission enabled by default, supports server-side encryption</li><li><strong>Monitoring</strong>: Out-of-the-box Grafana dashboards and Prometheus alerting rules</li><li><strong>Easy to Use</strong>: Pre-configured <code>mcli</code> client alias, one-click deployment and management</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-45b8da1dfca6b0e91aef873f7b72b337>1 - Usage</h1><div class=lead>Getting started: how to use MinIO? How to reliably access MinIO? How to use mc / rclone client tools?</div><p>After you <a href=config>configure</a> and deploy the MinIO cluster with the <a href=playbook>playbook</a>, you can start using and accessing the MinIO cluster by following the instructions here.</p><hr><h2 id=deploy-cluster>Deploy Cluster</h2><p>Deploying an out-of-the-box single-node single-disk MinIO instance in Pigsty is straightforward. First, define a MinIO cluster in the <a href=/docs/setup/config#config-inventory>config inventory</a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio } }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then, run the <a href=playbook><code>minio.yml</code></a> playbook provided by Pigsty against the defined group (here <code>minio</code>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio
</span></span></code></pre></div><p>Note that in <a href=/docs/setup/playbook#installyml><code>deploy.yml</code></a>, pre-defined MinIO clusters will be automatically created, so you don&rsquo;t need to manually run the <code>minio.yml</code> playbook again.</p><p>If you plan to deploy a production-grade large-scale multi-node MinIO cluster, we strongly recommend reading the Pigsty MinIO <a href=config>configuration documentation</a> and the MinIO <a href=https://min.io/docs/minio/linux/operations/concepts.html>official documentation</a> before proceeding.</p><hr><h2 id=access-cluster>Access Cluster</h2><p>Note: MinIO services must be accessed via domain name and HTTPS, so make sure the MinIO service domain (default <code>sss.pigsty</code>) correctly points to the MinIO server node.</p><ol><li>You can add static resolution records in <a href=/docs/node/param#node_etc_hosts><code>node_etc_hosts</code></a>, or manually modify the <code>/etc/hosts</code> file</li><li>You can add a record on the internal DNS server if you already have an existing DNS service</li><li>If you have enabled the DNS server on Infra nodes, you can add records in <a href=/docs/infra/param#dns_records><code>dns_records</code></a></li></ol><p>For production environment access to MinIO, we recommend using the first method: static DNS resolution records, to avoid MinIO&rsquo;s additional dependency on DNS.</p><p>You should point the MinIO service domain to the IP address and service port of the MinIO server node, or the IP address and service port of the load balancer.
Pigsty uses the default MinIO service domain <code>sss.pigsty</code>, which defaults to localhost for single-node deployment, serving on port <code>9000</code>.</p><p>In some examples, HAProxy instances are also deployed on the MinIO cluster to expose services. In this case, <code>9002</code> is the service port used in the templates.</p><hr><h2 id=adding-alias>Adding Alias</h2><p>To access the MinIO server cluster using the <code>mcli</code> client, you need to first configure the server alias:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli <span style=color:#204a87>alias</span> ls  <span style=color:#8f5902;font-style:italic># list minio alias (default is sss)</span>
</span></span><span style=display:flex><span>mcli <span style=color:#204a87>alias</span> <span style=color:#204a87>set</span> sss https://sss.pigsty:9000 minioadmin S3User.MinIO            <span style=color:#8f5902;font-style:italic># root user</span>
</span></span><span style=display:flex><span>mcli <span style=color:#204a87>alias</span> <span style=color:#204a87>set</span> sss https://sss.pigsty:9002 minioadmin S3User.MinIO            <span style=color:#8f5902;font-style:italic># root user, using load balancer port 9002</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mcli <span style=color:#204a87>alias</span> <span style=color:#204a87>set</span> pgbackrest https://sss.pigsty:9000 pgbackrest S3User.Backup    <span style=color:#8f5902;font-style:italic># use backup user</span>
</span></span></code></pre></div><p>On the admin user of the admin node, a MinIO alias named <code>sss</code> is pre-configured and can be used directly.</p><p>For the full functionality reference of the MinIO client tool <code>mcli</code>, please refer to the documentation: <a href=https://min.io/docs/minio/linux/reference/minio-mc.html>MinIO Client</a>.</p><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Note: Use Your Actual Password</div><p>The password <code>S3User.MinIO</code> in the above examples is the Pigsty default. If you modified <a href=/docs/minio/param#minio_secret_key><code>minio_secret_key</code></a> during deployment, please use your actual configured password.</p></div><hr><h2 id=user-management>User Management</h2><p>You can manage business users in MinIO using <code>mcli</code>. For example, here we can create two business users using the command line:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli admin user list sss     <span style=color:#8f5902;font-style:italic># list all users on sss</span>
</span></span><span style=display:flex><span><span style=color:#204a87>set</span> +o <span style=color:#204a87>history</span> <span style=color:#8f5902;font-style:italic># hide password in history and create minio users</span>
</span></span><span style=display:flex><span>mcli admin user add sss dba S3User.DBA
</span></span><span style=display:flex><span>mcli admin user add sss pgbackrest S3User.Backup
</span></span><span style=display:flex><span><span style=color:#204a87>set</span> -o <span style=color:#204a87>history</span>
</span></span></code></pre></div><hr><h2 id=bucket-management>Bucket Management</h2><p><strong>You can perform CRUD operations on buckets in MinIO</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli ls sss/                         <span style=color:#8f5902;font-style:italic># list all buckets on alias &#39;sss&#39;</span>
</span></span><span style=display:flex><span>mcli mb --ignore-existing sss/hello  <span style=color:#8f5902;font-style:italic># create a bucket named &#39;hello&#39;</span>
</span></span><span style=display:flex><span>mcli rb --force sss/hello            <span style=color:#8f5902;font-style:italic># force delete the &#39;hello&#39; bucket</span>
</span></span></code></pre></div><hr><h2 id=object-management>Object Management</h2><p><strong>You can also perform CRUD operations on objects within buckets</strong>. For details, please refer to the official documentation: <a href=https://min.io/docs/minio/linux/administration/object-management.html>Object Management</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli cp /www/pigsty/* sss/infra/     <span style=color:#8f5902;font-style:italic># upload local repo content to MinIO infra bucket</span>
</span></span><span style=display:flex><span>mcli cp sss/infra/plugins.tgz /tmp/  <span style=color:#8f5902;font-style:italic># download file from minio to local</span>
</span></span><span style=display:flex><span>mcli ls sss/infra                    <span style=color:#8f5902;font-style:italic># list all files in the infra bucket</span>
</span></span><span style=display:flex><span>mcli rm sss/infra/plugins.tgz        <span style=color:#8f5902;font-style:italic># delete specific file in infra bucket</span>
</span></span><span style=display:flex><span>mcli cat sss/infra/repo_complete     <span style=color:#8f5902;font-style:italic># view file content in infra bucket</span>
</span></span></code></pre></div><hr><h2 id=using-rclone>Using rclone</h2><p>Pigsty repository provides <a href=https://rclone.org/>rclone</a>, a convenient multi-cloud object storage client that you can use to access MinIO services.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install rclone<span style=color:#000;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic># EL-compatible systems</span>
</span></span><span style=display:flex><span>apt install rclone<span style=color:#000;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic># Debian/Ubuntu systems</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir -p ~/.config/rclone/<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>tee ~/.config/rclone/rclone.conf &gt; /dev/null <span style=color:#4e9a06>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>[sss]
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>type = s3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>access_key_id = minioadmin
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>secret_access_key = S3User.MinIO
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>endpoint = https://sss.pigsty:9000
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rclone ls sss:/
</span></span></code></pre></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Note: HTTPS and Certificate Trust</div><p>If MinIO uses HTTPS (default configuration), you need to ensure the client trusts Pigsty&rsquo;s CA certificate (<code>/etc/pki/ca.crt</code>), or add <code>no_check_certificate = true</code> in the rclone configuration to skip certificate verification (not recommended for production).</p></div><hr><h2 id=configure-backup-repository>Configure Backup Repository</h2><p>In Pigsty, the default use case for MinIO is as a backup storage repository for pgBackRest.
When you modify <a href=/docs/pgsql/param#pgbackrest_method><code>pgbackrest_method</code></a> to <code>minio</code>, the PGSQL module will automatically switch the backup repository to MinIO.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pgbackrest_method: local          # pgbackrest repo method</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>local,minio,[user-defined...]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pgbackrest_repo:                  # pgbackrest repo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://pgbackrest.org/configuration.html#section-repository</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>local</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                          </span><span style=color:#8f5902;font-style:italic># default pgbackrest repo with local posix fs</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/pg/backup             </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># local backup directory, `/pg/backup` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>retention_full_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>count   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># retention full backups by count</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>retention_full</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># keep 2, at most 3 full backup when using local fs repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                          </span><span style=color:#8f5902;font-style:italic># optional minio repo for pgbackrest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>s3                     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio is s3-compatible, so s3 is used</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss.pigsty      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio endpoint domain name, `sss.pigsty` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>us-east-1         </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio region, us-east-1 by default, useless for minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_bucket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql             </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio bucket name, `pgsql` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbackrest           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio user access key for pgbackrest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_key_secret</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.Backup </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio user secret key for pgbackrest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>s3_uri_style</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>path           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># use path style uri for minio rather than host style</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/pgbackrest            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio backup path, default is `/pgbackrest`</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>storage_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9000</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># minio port, 9000 by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>storage_ca_file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/pg/cert/ca.crt </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio ca file path, `/pg/cert/ca.crt` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>bundle</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>y</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># bundle small files into a single file</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>cipher_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>aes-256-cbc     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># enable AES encryption for remote backup repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>cipher_pass</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgBackRest      </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># AES encryption password, default is &#39;pgBackRest&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>retention_full_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>time    </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># retention full backup by time on minio repo</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>retention_full</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>14</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># keep full backup for last 14 days</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Note that if you are using a multi-node MinIO cluster and exposing services through a load balancer, you need to modify the <code>s3_endpoint</code> and <code>storage_port</code> parameters accordingly.</p><br><hr><br></div><div class=td-content style=page-break-before:always><h1 id=pg-08605fa7a960e0149e3c22312586b71e>2 - Configuration</h1><div class=lead>Choose the appropriate MinIO deployment type based on your requirements and provide reliable access.</div><p>Before deploying MinIO, you need to define a MinIO cluster in the <a href=/docs/setup/config>config inventory</a>. MinIO has three classic deployment modes:</p><ul><li><a href=#single-node-single-disk>Single-Node Single-Disk: SNSD</a>: Single-node single-disk mode, can use any directory as a data disk, for development, testing, and demo only.</li><li><a href=#single-node-multi-disk>Single-Node Multi-Disk: SNMD</a>: Compromise mode, using multiple disks (>=2) on a single server, only when resources are extremely limited.</li><li><a href=#multi-node-multi-disk>Multi-Node Multi-Disk: MNMD</a>: Multi-node multi-disk mode, standard production deployment with the best reliability, but requires multiple servers.</li></ul><p>We recommend using SNSD and MNMD modes - the former for development and testing, the latter for production deployment. SNMD should only be used when resources are limited (only one server).</p><p>Additionally, you can use <a href=#multi-pool>multi-pool deployment</a> to scale existing MinIO clusters, or directly deploy <a href=#multiple-clusters>multiple clusters</a>.</p><p>When using a multi-node MinIO cluster, you can access the service from any node, so the best practice is to use load balancing with <a href=#expose-service>high availability service access</a> in front of the MinIO cluster.</p><hr><h2 id=core-parameters>Core Parameters</h2><p>In MinIO deployment, <a href=https://min.io/docs/minio/linux/reference/minio-server/settings/core.html#envvar.MINIO_VOLUMES><code>MINIO_VOLUMES</code></a> is a core configuration parameter that specifies the MinIO deployment mode.
Pigsty provides convenient parameters to automatically generate <code>MINIO_VOLUMES</code> and other configuration values based on the config inventory, but you can also specify them directly.</p><ul><li>Single-Node Single-Disk: <code>MINIO_VOLUMES</code> points to a regular directory on the local machine, specified by <a href=/docs/minio/param#minio_data><code>minio_data</code></a>, defaulting to <code>/data/minio</code>.</li><li>Single-Node Multi-Disk: <code>MINIO_VOLUMES</code> points to a series of mount points on the local machine, also specified by <a href=/docs/minio/param#minio_data><code>minio_data</code></a>, but requires special syntax to explicitly specify real mount points, e.g., <code>/data{1...4}</code>.</li><li>Multi-Node Multi-Disk: <code>MINIO_VOLUMES</code> points to mount points across multiple servers, automatically generated from two parts:<ul><li>First, use <a href=/docs/minio/param#minio_data><code>minio_data</code></a> to specify the disk mount point sequence for each cluster member <code>/data{1...4}</code></li><li>Also use <a href=/docs/minio/param#minio_node><code>minio_node</code></a> to specify the node naming pattern <code>${minio_cluster}-${minio_seq}.pigsty</code></li></ul></li><li>Multi-Pool: You need to explicitly specify the <a href=/docs/minio/param#minio_volumes><code>minio_volumes</code></a> parameter to allocate nodes for each storage pool</li></ul><hr><h2 id=single-node-single-disk>Single-Node Single-Disk</h2><p>SNSD mode, deployment reference: <a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-single-node-single-drive.html>MinIO Single-Node Single-Drive</a></p><p>In Pigsty, defining a singleton MinIO instance is straightforward:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1 Node 1 Driver (DEFAULT)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio } }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>In single-node mode, the only required parameters are <a href=/docs/minio/param#minio_seq><code>minio_seq</code></a> and <a href=/docs/minio/param#minio_cluster><code>minio_cluster</code></a>, which uniquely identify each MinIO instance.</p><p>Single-node single-disk mode is for development purposes only, so you can use a regular directory as the data directory, specified by <a href=/docs/minio/param#minio_data><code>minio_data</code></a>, defaulting to <code>/data/minio</code>.</p><p>When using MinIO, we strongly recommend accessing it via a statically resolved domain name. For example, if <a href=/docs/minio/param#minio_domain><code>minio_domain</code></a> uses the default <code>sss.pigsty</code>,
you can add a static resolution on all nodes to facilitate access to this service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_etc_hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;10.10.10.10 sss.pigsty&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># domain name to access minio from all nodes (required)</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>SNSD is for Development Only</div><p>Single-node single-disk mode should only be used for development, testing, and demo purposes, as it cannot tolerate any hardware failure and does not benefit from multi-disk performance improvements. For production, use <a href=#multi-node-multi-disk>Multi-Node Multi-Disk</a> mode.</p></div><hr><h2 id=single-node-multi-disk>Single-Node Multi-Disk</h2><p>SNMD mode, deployment reference: <a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-single-node-multi-drive.html>MinIO Single-Node Multi-Drive</a></p><p>To use multiple disks on a single node, the operation is similar to <a href=#single-node-single-disk>Single-Node Single-Disk</a>, but you need to specify <a href=/docs/minio/param#minio_data><code>minio_data</code></a> in the format <code>{{ prefix }}{x...y}</code>, which defines a series of disk mount points.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio cluster name, minio by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data{1...4}&#39;</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># minio data dir(s), use {x...y} to specify multi drivers</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Use Real Disk Mount Points</div><p>Note that SNMD mode does not support using regular directories as data directories. If you start MinIO in SNMD mode but the data directory is not a valid disk mount point, MinIO will refuse to start. Ensure you use real disks formatted with XFS.</p></div><p>For example, the Vagrant MinIO <a href=https://github.com/pgsty/pigsty/blob/main/vagrant/spec/minio.rb>sandbox</a> defines a single-node MinIO cluster with 4 disks: <code>/data1</code>, <code>/data2</code>, <code>/data3</code>, and <code>/data4</code>. Before starting MinIO, you need to mount them properly (be sure to format disks with <code>xfs</code>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.xfs /dev/vdb<span style=color:#000;font-weight:700>;</span> mkdir /data1<span style=color:#000;font-weight:700>;</span> mount -t xfs /dev/sdb /data1<span style=color:#000;font-weight:700>;</span>   <span style=color:#8f5902;font-style:italic># mount disk 1...</span>
</span></span><span style=display:flex><span>mkfs.xfs /dev/vdc<span style=color:#000;font-weight:700>;</span> mkdir /data2<span style=color:#000;font-weight:700>;</span> mount -t xfs /dev/sdb /data2<span style=color:#000;font-weight:700>;</span>   <span style=color:#8f5902;font-style:italic># mount disk 2...</span>
</span></span><span style=display:flex><span>mkfs.xfs /dev/vdd<span style=color:#000;font-weight:700>;</span> mkdir /data3<span style=color:#000;font-weight:700>;</span> mount -t xfs /dev/sdb /data3<span style=color:#000;font-weight:700>;</span>   <span style=color:#8f5902;font-style:italic># mount disk 3...</span>
</span></span><span style=display:flex><span>mkfs.xfs /dev/vde<span style=color:#000;font-weight:700>;</span> mkdir /data4<span style=color:#000;font-weight:700>;</span> mount -t xfs /dev/sdb /data4<span style=color:#000;font-weight:700>;</span>   <span style=color:#8f5902;font-style:italic># mount disk 4...</span>
</span></span></code></pre></div><p>Disk mounting is part of server provisioning and beyond Pigsty&rsquo;s scope. Mounted disks should be written to <code>/etc/fstab</code> for auto-mounting after server restart.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/dev/vdb /data1 xfs defaults,noatime,nodiratime <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>/dev/vdc /data2 xfs defaults,noatime,nodiratime <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>/dev/vdd /data3 xfs defaults,noatime,nodiratime <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>/dev/vde /data4 xfs defaults,noatime,nodiratime <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span></code></pre></div><p>SNMD mode can utilize multiple disks on a single machine to provide higher performance and capacity, and tolerate partial disk failures.
However, single-node mode cannot tolerate entire node failure, and you cannot add new nodes at runtime, so we do not recommend using SNMD mode in production unless you have special reasons.</p><hr><h2 id=multi-node-multi-disk>Multi-Node Multi-Disk</h2><p>MNMD mode, deployment reference: <a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html>MinIO Multi-Node Multi-Drive</a></p><p>In addition to <a href=/docs/minio/param#minio_data><code>minio_data</code></a> for specifying disk drives as in <a href=#single-node-multi-disk>Single-Node Multi-Disk</a> mode, multi-node MinIO deployment requires an additional <a href=/docs/minio/param#minio_node><code>minio_node</code></a> parameter.</p><p>For example, the following configuration defines a MinIO cluster with four nodes, each with four disks:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 }  # actual nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-1.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 2 }  # actual nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-2.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 3 }  # actual nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-3.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 4 }  # actual nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-4.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data{1...4}&#39;</span><span style=color:#f8f8f8>                         </span><span style=color:#8f5902;font-style:italic># 4-disk per node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_node</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${minio_cluster}-${minio_seq}.pigsty&#39;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio node name pattern</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>The <a href=param#minio_node><code>minio_node</code></a> parameter specifies the MinIO node name pattern, used to generate a unique name for each node.
By default, the node name is <code>${minio_cluster}-${minio_seq}.pigsty</code>, where <code>${minio_cluster}</code> is the cluster name and <code>${minio_seq}</code> is the node sequence number.
The MinIO instance name is crucial and will be automatically written to <code>/etc/hosts</code> on MinIO nodes for static resolution. MinIO relies on these names to identify and access other nodes in the cluster.</p><p>In this case, <code>MINIO_VOLUMES</code> will be set to <code>https://minio-{1...4}.pigsty/data{1...4}</code> to identify the four disks on four nodes.
You can directly specify the <a href=param#minio_volumes><code>minio_volumes</code></a> parameter in the MinIO cluster to override the automatically generated value.
However, this is usually not necessary as Pigsty will automatically generate it based on the config inventory.</p><hr><h2 id=multi-pool>Multi-Pool</h2><p>MinIO&rsquo;s architecture allows scaling by adding new storage pools. In Pigsty, you can achieve cluster scaling by explicitly specifying the <a href=param#minio_volumes><code>minio_volumes</code></a> parameter to allocate nodes for each storage pool.</p><p>For example, suppose you have already created the MinIO cluster defined in the <a href=#multi-node-multi-disk>Multi-Node Multi-Disk</a> example, and now you want to add a new storage pool with four more nodes.</p><p>You need to directly override the <a href=param#minio_volumes><code>minio_volumes</code></a> parameter:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.14</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.15</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.16</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.17</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;/data{1...4}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_node</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${minio_cluster}-${minio_seq}.pigsty&#39;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio node name pattern</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;https://minio-{1...4}.pigsty:9000/data{1...4} https://minio-{5...8}.pigsty:9000/data{1...4}&#39;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Here, the two space-separated parameters represent two storage pools, each with four nodes and four disks per node. For more information on storage pools, refer to <a href=admin>Administration: MinIO Cluster Expansion</a></p><hr><h2 id=multiple-clusters>Multiple Clusters</h2><p>You can deploy new MinIO nodes as a completely new MinIO cluster by defining a new group with a different cluster name. The following configuration declares two independent MinIO clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;/data{1...4}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.14</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.15</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.16</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.17</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;/data{1...4}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_alias</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss2.pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss2.pigsty:9000</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Note that Pigsty defaults to having only one MinIO cluster per deployment. If you need to deploy multiple MinIO clusters, some parameters with default values must be explicitly set and cannot be omitted, otherwise naming conflicts will occur, as shown above.</p><hr><h2 id=expose-service>Expose Service</h2><p>MinIO serves on port <code>9000</code> by default. A multi-node MinIO cluster can be accessed by connecting to <strong>any one of its nodes</strong>.</p><p>Service access falls under the scope of the <a href=/docs/node>NODE</a> module, and we&rsquo;ll provide only a basic introduction here.</p><p>High-availability access to a multi-node MinIO cluster can be achieved using L2 VIP or HAProxy. For example, you can use keepalived to bind an L2 <a href=/docs/node/param#node_vip>VIP</a> to the MinIO cluster,
or use the <a href=/docs/node/param#haproxy><code>haproxy</code></a> component provided by the <a href=/docs/node><code>NODE</code></a> module to expose MinIO services through a load balancer.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># minio cluster with 4 nodes and 4 drivers per node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-1 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 2 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-2 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 3 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-3 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 4 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-4 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data{1...4}&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_buckets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }, { name: infra }, { name: redis } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: dba , secret_key: S3User.DBA, policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>consoleAdmin }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: pgbackrest , secret_key: S3User.SomeNewPassWord , policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>readwrite }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># bind a node l2 vip (10.10.10.9) to minio cluster (optional)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_vrid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>128</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.9</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>eth1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># expose minio service with haproxy on all nodes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service name, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9002</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service port, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>balance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>leastconn            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] load balancer algorithm</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                       </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] minio health check</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>option httpchk</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>option http-keep-alive</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>http-check send meth OPTIONS uri /minio/health/live</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>http-check expect status 200</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>servers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-1 ,ip: 10.10.10.10 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-2 ,ip: 10.10.10.11 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-3 ,ip: 10.10.10.12 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-4 ,ip: 10.10.10.13 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>For example, the configuration above enables HAProxy on all nodes of the MinIO cluster, exposing MinIO services on port <code>9002</code>, and binds a Layer 2 VIP to the cluster.
When in use, users should point the <code>sss.pigsty</code> domain name to the VIP address <code>10.10.10.9</code> and access MinIO services using port <code>9002</code>. This ensures high availability, as the VIP will automatically switch to another node if any node fails.</p><p>In this scenario, you may also need to globally modify the domain name resolution destination and the <a href=param#minio_endpoint><code>minio_endpoint</code></a> parameter to change the endpoint address for the MinIO alias on the admin node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_endpoint: https://sss.pigsty:9002   # Override the default</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://sss.pigsty:9000</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_etc_hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;10.10.10.9 sss.pigsty&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Other nodes will use sss.pigsty domain to access MinIO</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=dedicated-load-balancer>Dedicated Load Balancer</h2><p>Pigsty allows using a dedicated load balancer server group instead of the cluster itself to run VIP and HAProxy. For example, the <a href=/docs/conf/pro><code>prod</code></a> template uses this approach.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>proxy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.18 </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>nodename: proxy1 ,node_cluster: proxy ,vip_interface: eth1 ,vip_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>master }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.19 </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>nodename: proxy2 ,node_cluster: proxy ,vip_interface: eth1 ,vip_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>backup }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.20</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_vrid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_services:      # expose minio service </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss.pigsty:9000</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio       </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service name, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9000</span><span style=color:#f8f8f8>         </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service port, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>balance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>leastconn</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Use leastconn algorithm and minio health check</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;option httpchk&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;option http-keep-alive&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;http-check send meth OPTIONS uri /minio/health/live&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;http-check expect status 200&#34;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>servers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic># reload service with ./node.yml -t haproxy_config,haproxy_reload</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-1 ,ip: 10.10.10.21 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-2 ,ip: 10.10.10.22 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-3 ,ip: 10.10.10.23 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-4 ,ip: 10.10.10.24 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-5 ,ip: 10.10.10.25 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>In this case, you typically need to globally modify the MinIO domain resolution to point <code>sss.pigsty</code> to the load balancer address, and modify the <a href=param#minio_endpoint><code>minio_endpoint</code></a> parameter to change the endpoint address for the MinIO alias on the admin node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_endpoint: https://sss.pigsty:9002    # overwrite the defaults</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>https://sss.pigsty:9000</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>node_etc_hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;10.10.10.20 sss.pigsty&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># domain name to access minio from all nodes (required)</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=access-service>Access Service</h2><p>To access MinIO exposed via HAProxy, taking PGSQL backup configuration as an example, you can modify the configuration in <a href=/docs/pgsql/param#pgbackrest_repo><code>pgbackrest_repo</code></a> to add a new backup repository definition:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This is the newly added HA MinIO Repo definition, USE THIS INSTEAD!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_ha</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>s3</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_endpoint: minio-1.pigsty   # s3_endpoint can be any load balancer</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.1</span>{<span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span>}<span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>or domain names pointing to any of the nodes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_region: us-east-1          # you can use external domain name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss.pigsty, which resolves to any member (`minio_domain`)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_bucket: pgsql              # instance &amp; nodename can be used</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-1.pigsty minio-1.pigsty minio-1.pigsty minio-1 minio-2 minio-3</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgbackrest           </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Better using a dedicated password for MinIO pgbackrest user</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_key_secret</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.SomeNewPassWord</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>s3_uri_style</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>path</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/pgbackrest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>storage_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9002</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># Use load balancer port 9002 instead of default 9000 (direct access)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>storage_ca_file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/etc/pki/ca.crt</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>bundle</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>y</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>cipher_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>aes-256-cbc     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Better using a new cipher password for your production environment</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>cipher_pass</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgBackRest.With.Some.Extra.PassWord.And.Salt.${pg_cluster}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>retention_full_type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>time</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>retention_full</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>14</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=expose-console>Expose Console</h2><p>MinIO provides a Web console interface on port <code>9001</code> by default (specified by the <a href=param#minio_admin_port><code>minio_admin_port</code></a> parameter).</p><p>Exposing the admin interface to external networks may pose security risks. If you want to do this, add MinIO to <a href=/docs/infra/param#infra_portal><code>infra_portal</code></a> and refresh the Nginx configuration.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ./infra.yml -t nginx</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>home         </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>h.pigsty }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># MinIO console requires HTTPS / Websocket to work</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio        </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m.pigsty     ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio10      </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m10.pigsty   ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.10:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio11      </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m11.pigsty   ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.11:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio12      </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m12.pigsty   ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.12:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>minio13      </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: m13.pigsty   ,endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10.10.10.13:9001&#34;</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>,scheme: https ,websocket</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Note that the MinIO console requires HTTPS. Please <strong>DO NOT</strong> expose an unencrypted MinIO console in production.</p><p>This means you typically need to add a resolution record for <code>m.pigsty</code> in your DNS server or local <code>/etc/hosts</code> file to access the MinIO console.</p><p>Meanwhile, if you are using Pigsty&rsquo;s self-signed CA rather than a proper public CA, you usually need to manually trust the CA or certificate to skip the &ldquo;insecure&rdquo; warning in the browser.</p><br><hr><br></div><div class=td-content style=page-break-before:always><h1 id=pg-280b7e56b08e272d7b26411d506d6c5d>3 - Parameters</h1><div class=lead>MinIO module provides 21 configuration parameters for customizing your MinIO cluster.</div><p>The MinIO module parameter list contains <strong>21</strong> parameters in two groups:</p><ul><li><a href=#minio><strong><code>MINIO</code></strong></a>: 18 parameters for MinIO cluster deployment and configuration</li><li><a href=#minio_remove><strong><code>MINIO_REMOVE</code></strong></a>: 3 parameters for MinIO cluster removal</li></ul><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>Architecture Change: Pigsty v3.6+</div><p>Since Pigsty v3.6, the <code>minio.yml</code> playbook no longer includes removal functionality. Removal-related parameters have been migrated to the dedicated <code>minio_remove</code> role and <code>minio-rm.yml</code> playbook.</p></div><hr><h2 id=parameter-overview>Parameter Overview</h2><p>The <a href=#minio><code>MINIO</code></a> parameter group is used for MinIO cluster deployment and configuration, including identity, storage paths, ports, authentication credentials, and provisioning of buckets and users.</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:center>Type</th><th style=text-align:center>Level</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><a href=#minio_seq><code>minio_seq</code></a></td><td style=text-align:center><code>int</code></td><td style=text-align:center><code>I</code></td><td style=text-align:left>minio instance identifier, REQUIRED</td></tr><tr><td style=text-align:left><a href=#minio_cluster><code>minio_cluster</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio cluster name, minio by default</td></tr><tr><td style=text-align:left><a href=#minio_user><code>minio_user</code></a></td><td style=text-align:center><code>username</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio os user, <code>minio</code> by default</td></tr><tr><td style=text-align:left><a href=#minio_https><code>minio_https</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C</code></td><td style=text-align:left>enable HTTPS for MinIO? true by default</td></tr><tr><td style=text-align:left><a href=#minio_node><code>minio_node</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio node name pattern</td></tr><tr><td style=text-align:left><a href=#minio_data><code>minio_data</code></a></td><td style=text-align:center><code>path</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio data dir, use <code>{x...y}</code> for multiple disks</td></tr><tr><td style=text-align:left><a href=#minio_volumes><code>minio_volumes</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio core parameter for nodes and disks, auto-gen</td></tr><tr><td style=text-align:left><a href=#minio_domain><code>minio_domain</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>G</code></td><td style=text-align:left>minio external domain, <code>sss.pigsty</code> by default</td></tr><tr><td style=text-align:left><a href=#minio_port><code>minio_port</code></a></td><td style=text-align:center><code>port</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio service port, 9000 by default</td></tr><tr><td style=text-align:left><a href=#minio_admin_port><code>minio_admin_port</code></a></td><td style=text-align:center><code>port</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>minio console port, 9001 by default</td></tr><tr><td style=text-align:left><a href=#minio_access_key><code>minio_access_key</code></a></td><td style=text-align:center><code>username</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>root access key, <code>minioadmin</code> by default</td></tr><tr><td style=text-align:left><a href=#minio_secret_key><code>minio_secret_key</code></a></td><td style=text-align:center><code>password</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>root secret key, <code>S3User.MinIO</code> by default</td></tr><tr><td style=text-align:left><a href=#minio_extra_vars><code>minio_extra_vars</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>extra environment variables for minio server</td></tr><tr><td style=text-align:left><a href=#minio_provision><code>minio_provision</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C</code></td><td style=text-align:left>run minio provisioning tasks? true by default</td></tr><tr><td style=text-align:left><a href=#minio_alias><code>minio_alias</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>G</code></td><td style=text-align:left>minio client alias for the deployment</td></tr><tr><td style=text-align:left><a href=#minio_endpoint><code>minio_endpoint</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>endpoint for the minio client alias</td></tr><tr><td style=text-align:left><a href=#minio_buckets><code>minio_buckets</code></a></td><td style=text-align:center><code>bucket[]</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>list of minio buckets to be created</td></tr><tr><td style=text-align:left><a href=#minio_users><code>minio_users</code></a></td><td style=text-align:center><code>user[]</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>list of minio users to be created</td></tr></tbody></table><p>The <a href=#minio_remove><code>MINIO_REMOVE</code></a> parameter group controls MinIO cluster removal behavior, including safeguard protection, data cleanup, and package uninstallation.</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:center>Type</th><th style=text-align:center>Level</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><a href=#minio_safeguard><code>minio_safeguard</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>prevent accidental removal? false by default</td></tr><tr><td style=text-align:left><a href=#minio_rm_data><code>minio_rm_data</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>remove minio data during removal? true by default</td></tr><tr><td style=text-align:left><a href=#minio_rm_pkg><code>minio_rm_pkg</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>uninstall minio packages during removal? false by default</td></tr></tbody></table><p>The <code>minio_volumes</code> and <code>minio_endpoint</code> are auto-generated parameters, but you can explicitly override them.</p><hr><h2 id=defaults>Defaults</h2><p><code>MINIO</code>: 18 parameters, defined in <a href=https://github.com/pgsty/pigsty/blob/main/roles/minio/defaults/main.yml><code>roles/minio/defaults/main.yml</code></a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#-----------------------------------------------------------------</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MINIO</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#-----------------------------------------------------------------</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#minio_seq: 1                     # minio instance identifier, REQUIRED</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio             </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio cluster name, minio by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_user</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio                </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio os user, `minio` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_https</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic># enable HTTPS for MinIO? true by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_node</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;${minio_cluster}-${minio_seq}.pigsty&#39;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio node name pattern</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data/minio&#39;</span><span style=color:#f8f8f8>         </span><span style=color:#8f5902;font-style:italic># minio data dir, use `{x...y}` for multiple disks</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#minio_volumes:                   # minio core parameter, auto-generated if not specified</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss.pigsty         </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio external domain, `sss.pigsty` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9000</span><span style=color:#f8f8f8>                  </span><span style=color:#8f5902;font-style:italic># minio service port, 9000 by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_admin_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9001</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># minio console port, 9001 by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_access_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minioadmin     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># root access key, `minioadmin` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_secret_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.MinIO   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># root secret key, `S3User.MinIO` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_extra_vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># extra environment variables for minio server</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_provision</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># run minio provisioning tasks?</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_alias</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sss                 </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># minio client alias for the deployment</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#minio_endpoint: https://sss.pigsty:9000 # endpoint for alias, auto-generated if not specified</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_buckets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                    </span><span style=color:#8f5902;font-style:italic># list of minio buckets to be created</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,versioning</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>data }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># list of minio users to be created</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: pgbackrest  ,secret_key: S3User.Backup ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: s3user_meta ,secret_key: S3User.Meta   ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>meta  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: s3user_data ,secret_key: S3User.Data   ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>data  }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><code>MINIO_REMOVE</code>: 3 parameters, defined in <a href=https://github.com/pgsty/pigsty/blob/main/roles/minio_remove/defaults/main.yml><code>roles/minio_remove/defaults/main.yml</code></a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#-----------------------------------------------------------------</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MINIO_REMOVE</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#-----------------------------------------------------------------</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_safeguard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># prevent accidental removal? false by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_rm_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>               </span><span style=color:#8f5902;font-style:italic># remove minio data during removal? true by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_rm_pkg</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>               </span><span style=color:#8f5902;font-style:italic># uninstall minio packages during removal? false by default</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=minio><code>MINIO</code></h2><p>This section contains parameters for the <a href=https://github.com/pgsty/pigsty/blob/main/roles/minio/defaults/main.yml><code>minio</code></a> role,
used by the <a href=/docs/minio/playbook#minioyml><code>minio.yml</code></a> playbook.</p><h3 id=minio_seq><code>minio_seq</code></h3><p>Parameter: <code>minio_seq</code>, Type: <code>int</code>, Level: <code>I</code></p><p>MinIO instance identifier, a required identity parameter. No default value—you must assign it manually.</p><p>Best practice is to start from 1, increment by 1, and never reuse previously assigned sequence numbers.
The sequence number, together with the cluster name <a href=#minio_cluster><code>minio_cluster</code></a>, uniquely identifies each MinIO instance (e.g., <code>minio-1</code>).</p><p>In multi-node deployments, sequence numbers are also used to generate node names, which are written to the <code>/etc/hosts</code> file for static resolution.</p><hr><h3 id=minio_cluster><code>minio_cluster</code></h3><p>Parameter: <code>minio_cluster</code>, Type: <code>string</code>, Level: <code>C</code></p><p>MinIO cluster name, default is <code>minio</code>. This is useful when deploying multiple MinIO clusters.</p><p>The cluster name, together with the sequence number <a href=#minio_seq><code>minio_seq</code></a>, uniquely identifies each MinIO instance.
For example, with cluster name <code>minio</code> and sequence <code>1</code>, the instance name is <code>minio-1</code>.</p><p>Note that Pigsty defaults to a single MinIO cluster per deployment. If you need multiple MinIO clusters,
you must explicitly set <a href=#minio_alias><code>minio_alias</code></a>, <a href=#minio_domain><code>minio_domain</code></a>, <a href=#minio_endpoint><code>minio_endpoint</code></a>, and other parameters to avoid naming conflicts.</p><hr><h3 id=minio_user><code>minio_user</code></h3><p>Parameter: <code>minio_user</code>, Type: <code>username</code>, Level: <code>C</code></p><p>MinIO operating system user, default is <code>minio</code>.</p><p>The MinIO service runs under this user. SSL certificates used by MinIO are stored in this user&rsquo;s home directory (default <code>/home/minio</code>), under the <code>~/.minio/certs/</code> directory.</p><hr><h3 id=minio_https><code>minio_https</code></h3><p>Parameter: <code>minio_https</code>, Type: <code>bool</code>, Level: <code>G/C</code></p><p>Enable HTTPS for MinIO service? Default is <code>true</code>.</p><p>Note that pgBackREST requires MinIO to use HTTPS to work properly. If you don&rsquo;t use MinIO for PostgreSQL backups and don&rsquo;t need HTTPS, you can set this to <code>false</code>.</p><p>When HTTPS is enabled, Pigsty automatically issues SSL certificates for the MinIO server, containing the domain specified in <a href=#minio_domain><code>minio_domain</code></a> and the IP addresses of each node.</p><hr><h3 id=minio_node><code>minio_node</code></h3><p>Parameter: <code>minio_node</code>, Type: <code>string</code>, Level: <code>C</code></p><p>MinIO node name pattern, used for <a href=/docs/minio/config#multi-node-multi-drive>multi-node</a> deployments.</p><p>Default value: <code>${minio_cluster}-${minio_seq}.pigsty</code>, which uses the instance name plus <code>.pigsty</code> suffix as the default node name.</p><p>The domain pattern specified here is used to generate node names, which are written to the <code>/etc/hosts</code> file on all MinIO nodes.</p><hr><h3 id=minio_data><code>minio_data</code></h3><p>Parameter: <code>minio_data</code>, Type: <code>path</code>, Level: <code>C</code></p><p>MinIO data directory(s), default value: <code>/data/minio</code>, a common directory for <a href=/docs/minio/config#single-node-single-drive>single-node</a> deployments.</p><p>For <a href=/docs/minio/config#multi-node-multi-drive>multi-node-multi-drive</a> and <a href=/docs/minio/config#single-node-multi-drive>single-node-multi-drive</a> deployments, use the <code>{x...y}</code> notation to specify multiple disks.</p><hr><h3 id=minio_volumes><code>minio_volumes</code></h3><p>Parameter: <code>minio_volumes</code>, Type: <code>string</code>, Level: <code>C</code></p><p>MinIO core parameter. By default, this is not specified and is auto-generated using the following rule:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;{% if minio_cluster_size|int &gt; 1 %}https://{{ minio_node|replace(&#39;${minio_cluster}&#39;, minio_cluster)|replace(&#39;${minio_seq}&#39;,minio_seq_range) }}:{{ minio_port|default(9000) }}{% endif %}{{ minio_data }}&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><ul><li>In single-node deployment (single or multi-drive), <code>minio_volumes</code> directly uses the <a href=#minio_data><code>minio_data</code></a> value.</li><li>In multi-node deployment, <code>minio_volumes</code> uses <code>minio_node</code>, <code>minio_port</code>, and <code>minio_data</code> to generate multi-node addresses.</li><li>In multi-pool deployment, you typically need to explicitly specify and override <code>minio_volumes</code> to define multiple node pool addresses.</li></ul><p>When specifying this parameter, ensure the values are consistent with <code>minio_node</code>, <code>minio_port</code>, and <code>minio_data</code>.</p><hr><h3 id=minio_domain><code>minio_domain</code></h3><p>Parameter: <code>minio_domain</code>, Type: <code>string</code>, Level: <code>G</code></p><p>MinIO service domain name, default is <code>sss.pigsty</code>.</p><p>Clients can access the MinIO S3 service via this domain name. This name is registered in local DNSMASQ and included in SSL certificates&rsquo; SAN (Subject Alternative Name) field.</p><p>It&rsquo;s recommended to add a static DNS record in <a href=/docs/node/param#node_etc_hosts><code>node_etc_hosts</code></a> pointing this domain to the MinIO server node&rsquo;s IP (single-node deployment) or load balancer VIP (multi-node deployment).</p><hr><h3 id=minio_port><code>minio_port</code></h3><p>Parameter: <code>minio_port</code>, Type: <code>port</code>, Level: <code>C</code></p><p>MinIO service port, default is <code>9000</code>.</p><p>This is the MinIO S3 API listening port. Clients access the object storage service through this port. In multi-node deployments, this port is also used for inter-node communication.</p><hr><h3 id=minio_admin_port><code>minio_admin_port</code></h3><p>Parameter: <code>minio_admin_port</code>, Type: <code>port</code>, Level: <code>C</code></p><p>MinIO console port, default is <code>9001</code>.</p><p>This is the listening port for MinIO&rsquo;s built-in web management console. You can access MinIO&rsquo;s graphical management interface at <code>https://&lt;minio-ip>:9001</code>.</p><p>To expose the MinIO console through Nginx, add it to <a href=/docs/infra/param#infra_portal><code>infra_portal</code></a>. Note that the MinIO console requires HTTPS and WebSocket support.</p><hr><h3 id=minio_access_key><code>minio_access_key</code></h3><p>Parameter: <code>minio_access_key</code>, Type: <code>username</code>, Level: <code>C</code></p><p>Root access key (username), default is <code>minioadmin</code>.</p><p>This is the MinIO super administrator username with full access to all buckets and objects. It&rsquo;s recommended to change this default value in production environments.</p><hr><h3 id=minio_secret_key><code>minio_secret_key</code></h3><p>Parameter: <code>minio_secret_key</code>, Type: <code>password</code>, Level: <code>C</code></p><p>Root secret key (password), default is <code>S3User.MinIO</code>.</p><p>This is the MinIO super administrator&rsquo;s password, used together with <a href=#minio_access_key><code>minio_access_key</code></a>.</p><div class="alert alert-danger" role=alert><div class="h4 alert-heading" role=heading>Security Warning: Change the default password!</div><p>Using default passwords is a high-risk behavior! Make sure to change this password in your production deployment.</p><p>Tip: Running <code>./configure</code> or <code>./configure -g</code> will automatically replace these default passwords in the configuration template.</p></div><hr><h3 id=minio_extra_vars><code>minio_extra_vars</code></h3><p>Parameter: <code>minio_extra_vars</code>, Type: <code>string</code>, Level: <code>C</code></p><p>Extra environment variables for MinIO server. See the <a href=https://min.io/docs/minio/linux/reference/minio-server/minio-server.html>MinIO Server</a> documentation for the complete list.</p><p>Default is an empty string. You can use multiline strings to pass multiple environment variables:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_extra_vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  MINIO_BROWSER_REDIRECT_URL=https://minio.example.com
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  MINIO_SERVER_URL=https://s3.example.com</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h3 id=minio_provision><code>minio_provision</code></h3><p>Parameter: <code>minio_provision</code>, Type: <code>bool</code>, Level: <code>G/C</code></p><p>Run MinIO provisioning tasks? Default is <code>true</code>.</p><p>When enabled, Pigsty automatically creates the buckets and users defined in <a href=#minio_buckets><code>minio_buckets</code></a> and <a href=#minio_users><code>minio_users</code></a>.
Set this to <code>false</code> if you don&rsquo;t need automatic provisioning of these resources.</p><hr><h3 id=minio_alias><code>minio_alias</code></h3><p>Parameter: <code>minio_alias</code>, Type: <code>string</code>, Level: <code>G</code></p><p>MinIO client alias for the local MinIO cluster, default value: <code>sss</code>.</p><p>This alias is written to the MinIO client configuration file (<code>~/.mcli/config.json</code>) for the admin user on the admin node,
allowing you to directly use <code>mcli &lt;alias></code> commands to access the MinIO cluster, e.g., <code>mcli ls sss/</code>.</p><p>If deploying multiple MinIO clusters, specify different aliases for each cluster to avoid conflicts.</p><hr><h3 id=minio_endpoint><code>minio_endpoint</code></h3><p>Parameter: <code>minio_endpoint</code>, Type: <code>string</code>, Level: <code>C</code></p><p>Endpoint for the client alias. If specified, this <code>minio_endpoint</code> (e.g., <code>https://sss.pigsty:9002</code>) will replace the default value as the target endpoint for the MinIO alias written on the admin node.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli <span style=color:#204a87>alias</span> <span style=color:#204a87>set</span> <span style=color:#ce5c00;font-weight:700>{{</span> minio_alias <span style=color:#ce5c00;font-weight:700>}}</span> <span style=color:#ce5c00;font-weight:700>{</span>% <span style=color:#204a87;font-weight:700>if</span> minio_endpoint is defined and minio_endpoint !<span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;&#39;</span> %<span style=color:#ce5c00;font-weight:700>}{{</span> minio_endpoint <span style=color:#ce5c00;font-weight:700>}}{</span>% <span style=color:#204a87;font-weight:700>else</span> %<span style=color:#ce5c00;font-weight:700>}</span>https://<span style=color:#ce5c00;font-weight:700>{{</span> minio_domain <span style=color:#ce5c00;font-weight:700>}}</span>:<span style=color:#ce5c00;font-weight:700>{{</span> minio_port <span style=color:#ce5c00;font-weight:700>}}{</span>% endif %<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>{{</span> minio_access_key <span style=color:#ce5c00;font-weight:700>}}</span> <span style=color:#ce5c00;font-weight:700>{{</span> minio_secret_key <span style=color:#ce5c00;font-weight:700>}}</span>
</span></span></code></pre></div><p>This MinIO alias is configured on the admin node as the default admin user.</p><hr><h3 id=minio_buckets><code>minio_buckets</code></h3><p>Parameter: <code>minio_buckets</code>, Type: <code>bucket[]</code>, Level: <code>C</code></p><p>List of MinIO buckets to create by default:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_buckets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,versioning</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>data }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Three default buckets are created with different purposes and policies:</p><ul><li><code>pgsql</code> bucket: Used by default for PostgreSQL pgBackREST backup storage.</li><li><code>meta</code> bucket: Open bucket with versioning enabled, suitable for storing important metadata requiring version management.</li><li><code>data</code> bucket: Open bucket for other purposes, e.g., Supabase templates may use this bucket for business data.</li></ul><p>Each bucket has a corresponding access policy with the same name. For example, the <code>pgsql</code> policy has full access to the <code>pgsql</code> bucket, and so on.</p><p>You can also add a <code>lock</code> flag to bucket definitions to enable object locking, preventing accidental deletion of objects in the bucket.</p><hr><h3 id=minio_users><code>minio_users</code></h3><p>Parameter: <code>minio_users</code>, Type: <code>user[]</code>, Level: <code>C</code></p><p>List of MinIO users to create, default value:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: pgbackrest  ,secret_key: S3User.Backup ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: s3user_meta ,secret_key: S3User.Meta   ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>meta  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: s3user_data ,secret_key: S3User.Data   ,policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>data  }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>The default configuration creates three users corresponding to three default buckets:</p><ul><li><code>pgbackrest</code>: For PostgreSQL pgBackREST backups, with access to the <code>pgsql</code> bucket.</li><li><code>s3user_meta</code>: For accessing the <code>meta</code> bucket.</li><li><code>s3user_data</code>: For accessing the <code>data</code> bucket.</li></ul><div class="alert alert-danger" role=alert><div class="h4 alert-heading" role=heading>Using default passwords is dangerous! Make sure to change these credentials in your deployment!</div><p>Tip: <code>./configure -g</code> will automatically replace these passwords in the configuration template if they appear as defaults.</p></div><hr><h2 id=minio_remove><code>MINIO_REMOVE</code></h2><p>This section contains parameters for the <a href=https://github.com/pgsty/pigsty/blob/main/roles/minio_remove/defaults/main.yml><code>minio_remove</code></a> role,
used by the <a href=/docs/minio/playbook#minio-rmyml><code>minio-rm.yml</code></a> playbook.</p><h3 id=minio_safeguard><code>minio_safeguard</code></h3><p>Parameter: <code>minio_safeguard</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Safeguard switch to prevent accidental deletion, default value is <code>false</code>.</p><p>When enabled, the <a href=/docs/minio/playbook/#minio-rmyml><code>minio-rm.yml</code></a> playbook will abort and refuse to remove the MinIO cluster, providing protection against accidental deletions.</p><p>It&rsquo;s recommended to enable this safeguard in production environments to prevent data loss from accidental operations:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_safeguard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># When enabled, minio-rm.yml will refuse to execute</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h3 id=minio_rm_data><code>minio_rm_data</code></h3><p>Parameter: <code>minio_rm_data</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Remove MinIO data during removal? Default value is <code>true</code>.</p><p>When enabled, the <a href=/docs/minio/playbook/#minio-rmyml><code>minio-rm.yml</code></a> playbook will delete MinIO data directories and configuration files during cluster removal.</p><hr><h3 id=minio_rm_pkg><code>minio_rm_pkg</code></h3><p>Parameter: <code>minio_rm_pkg</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Uninstall MinIO packages during removal? Default value is <code>false</code>.</p><p>When enabled, the <a href=/docs/minio/playbook/#minio-rmyml><code>minio-rm.yml</code></a> playbook will uninstall MinIO packages during cluster removal. This is disabled by default to preserve the MinIO installation for potential future use.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ccc1805ae841df3ebaeb7bb6b8008203>4 - Playbook</h1><div class=lead>Manage MinIO clusters with Ansible playbooks and quick command reference.</div><p>The MinIO module provides two built-in playbooks for cluster management:</p><ul><li><a href=#minioyml><code>minio.yml</code></a>: Install MinIO cluster</li><li><a href=#minio-rmyml><code>minio-rm.yml</code></a>: Remove MinIO cluster</li></ul><hr><h2 id=minioyml><code>minio.yml</code></h2><p>Playbook <a href=https://github.com/pgsty/pigsty/blob/main/minio.yml><code>minio.yml</code></a> installs the MinIO module on nodes.</p><ul><li><code>minio-id</code> : Generate/validate minio identity parameters</li><li><code>minio_install</code> : Install minio<ul><li><code>minio_os_user</code> : Create OS user minio</li><li><code>minio_pkg</code> : Install minio/mcli packages</li><li><code>minio_dir</code> : Create minio directories</li></ul></li><li><code>minio_config</code> : Generate minio configuration<ul><li><code>minio_conf</code> : Minio main config file</li><li><code>minio_cert</code> : Minio SSL certificate issuance</li><li><code>minio_dns</code> : Minio DNS record insertion</li></ul></li><li><code>minio_launch</code> : Launch minio service</li><li><code>minio_register</code> : Register minio to monitoring</li><li><code>minio_provision</code> : Create minio aliases/buckets/users<ul><li><code>minio_alias</code> : Create minio client alias (on admin node)</li><li><code>minio_bucket</code> : Create minio buckets</li><li><code>minio_user</code> : Create minio business users</li></ul></li></ul><p>Before running the playbook, complete the MinIO cluster <a href=config>configuration</a> in the <a href=/docs/setup/config>config inventory</a>.</p><div class="alert alert-primary" role=alert><div class="h4 alert-heading" role=heading>Execution Condition</div><p>The playbook automatically skips hosts without <a href=/docs/minio/param#minio_seq><code>minio_seq</code></a> defined. This means you can safely execute the playbook on mixed host groups - only actual MinIO nodes will be processed.</p></div><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>Architecture Change: Pigsty v3.6+</div><p>Since Pigsty v3.6, the <strong>minio.yml</strong> playbook focuses on cluster installation. All removal operations have been moved to the dedicated <strong>minio-rm.yml</strong> playbook using the <strong>minio_remove</strong> role.</p></div><hr><h2 id=minio-rmyml><code>minio-rm.yml</code></h2><p>Playbook <a href=https://github.com/pgsty/pigsty/blob/main/minio-rm.yml><code>minio-rm.yml</code></a> removes the MinIO cluster.</p><ul><li><code>minio-id</code> : Generate minio identity parameters for removal (with <code>any_errors_fatal</code> - stops immediately on identity validation failure)</li><li><code>minio_safeguard</code> : Safety check, prevent accidental deletion (default: <code>false</code>)</li><li><code>minio_pause</code> : Pause 3 seconds, allow user to abort (Ctrl+C to cancel)</li><li><code>minio_deregister</code> : Remove targets from Victoria/Prometheus monitoring, clean up DNS records</li><li><code>minio_svc</code> : Stop and disable minio systemd service</li><li><code>minio_data</code> : Remove minio data directory (disable with <code>minio_rm_data=false</code>)</li><li><code>minio_pkg</code> : Uninstall minio packages (enable with <code>minio_rm_pkg=true</code>)</li></ul><div class="alert alert-primary" role=alert><div class="h4 alert-heading" role=heading>Execution Condition & Safety Mechanisms</div><ul><li>The playbook automatically skips hosts without <a href=/docs/minio/param#minio_seq><code>minio_seq</code></a> defined, preventing accidental operations on non-MinIO nodes</li><li>Identity validation uses <code>any_errors_fatal</code> - the playbook stops immediately upon detecting invalid MinIO identity</li><li>A 3-second pause before removal gives users a chance to abort the operation</li></ul></div><p>The removal playbook uses the <strong>minio_remove</strong> role with the following <a href=/docs/minio/param>configurable parameters</a>:</p><ul><li><a href=/docs/minio/param#minio_safeguard><code>minio_safeguard</code></a>: Prevents accidental deletion when set to <code>true</code></li><li><a href=/docs/minio/param#minio_rm_data><code>minio_rm_data</code></a>: Controls whether MinIO data is deleted (default: <code>true</code>)</li><li><a href=/docs/minio/param#minio_rm_pkg><code>minio_rm_pkg</code></a>: Controls whether MinIO packages are uninstalled (default: <code>false</code>)</li></ul><hr><h2 id=cheatsheet>Cheatsheet</h2><p>Common MINIO playbook commands:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l &lt;cls&gt;                      <span style=color:#8f5902;font-style:italic># Install MINIO module on group &lt;cls&gt;</span>
</span></span><span style=display:flex><span>./minio.yml -l minio -t minio_install     <span style=color:#8f5902;font-style:italic># Install MinIO service, prepare data dirs, without configure &amp; launch</span>
</span></span><span style=display:flex><span>./minio.yml -l minio -t minio_config      <span style=color:#8f5902;font-style:italic># Reconfigure MinIO cluster</span>
</span></span><span style=display:flex><span>./minio.yml -l minio -t minio_launch      <span style=color:#8f5902;font-style:italic># Restart MinIO cluster</span>
</span></span><span style=display:flex><span>./minio.yml -l minio -t minio_provision   <span style=color:#8f5902;font-style:italic># Re-run provisioning (create buckets and users)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio                   <span style=color:#8f5902;font-style:italic># Remove MinIO cluster (using dedicated removal playbook)</span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>  <span style=color:#8f5902;font-style:italic># Remove cluster but preserve data</span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>    <span style=color:#8f5902;font-style:italic># Remove cluster and uninstall packages</span>
</span></span></code></pre></div><hr><h2 id=safeguard>Safeguard</h2><p>To prevent accidental deletion, Pigsty&rsquo;s MINIO module provides a safeguard mechanism controlled by the <a href=/docs/minio/param#minio_safeguard><code>minio_safeguard</code></a> parameter.</p><p>By default, <code>minio_safeguard</code> is <code>false</code>, allowing removal operations. If you want to protect the MinIO cluster from accidental deletion, enable this safeguard in the config inventory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio_safeguard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># When enabled, minio-rm.yml will refuse to execute</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>If you need to remove a protected cluster, override with command-line parameters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span></code></pre></div><hr><h2 id=demo>Demo</h2><p><a href=https://asciinema.org/a/566415><img src=https://asciinema.org/a/566415.svg alt=asciicast></a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-172708bf70f3c5729ee49aac66787c09>5 - Administration</h1><div class=lead>MinIO cluster management SOP: create, destroy, expand, shrink, and handle node and disk failures.</div><hr><h2 id=create-cluster>Create Cluster</h2><p>To create a cluster, define it in the config inventory and run the <a href=playbook#minioyml><code>minio.yml</code></a> playbook.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio } }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>For example, the above configuration defines an SNSD <a href=config#single-node-single-disk>Single-Node Single-Disk</a> MinIO cluster. Use the following command to create this MinIO cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio  <span style=color:#8f5902;font-style:italic># Install MinIO module on the minio group</span>
</span></span></code></pre></div><hr><h2 id=remove-cluster>Remove Cluster</h2><p>To destroy a cluster, run the dedicated <a href=playbook#minio-rmyml><code>minio-rm.yml</code></a> playbook:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio-rm.yml -l minio                   <span style=color:#8f5902;font-style:italic># Remove MinIO cluster</span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>  <span style=color:#8f5902;font-style:italic># Remove cluster but keep data</span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>    <span style=color:#8f5902;font-style:italic># Remove cluster and uninstall packages</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>Architecture Change: Pigsty v3.6+</div><p>Starting from Pigsty v3.6, cluster removal has been migrated from <code>minio.yml</code> playbook to the dedicated <code>minio-rm.yml</code> playbook. The old <code>minio_clean</code> task has been deprecated.</p></div><p>The removal playbook automatically performs the following:</p><ul><li>Deregisters MinIO targets from Victoria/Prometheus monitoring</li><li>Removes records from the DNS service on INFRA nodes</li><li>Stops and disables MinIO systemd service</li><li>Deletes MinIO data directory and configuration files (optional)</li><li>Uninstalls MinIO packages (optional)</li></ul><hr><h2 id=expand-cluster>Expand Cluster</h2><ul><li><a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/expand-minio-deployment.html>Expand Cluster Tutorial</a></li></ul><p>MinIO cannot scale at the node/disk level, but can scale at the storage pool (multiple nodes) level.</p><p>Assume you have a <a href=config#multi-node-multi-disk>four-node</a> MinIO cluster and want to double the capacity by adding a new four-node storage pool.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-1 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 2 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-2 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 3 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-3 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 4 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-4 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data{1...4}&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_buckets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql }, { name: infra }, { name: redis } ]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: dba , secret_key: S3User.DBA, policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>consoleAdmin }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>access_key: pgbackrest , secret_key: S3User.SomeNewPassWord , policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>readwrite }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># bind a node l2 vip (10.10.10.9) to minio cluster (optional)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_vrid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>128</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.9</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>vip_interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>eth1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># expose minio service with haproxy on all nodes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service name, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9002</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service port, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>balance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>leastconn            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] load balancer algorithm</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                       </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] minio health check</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>option httpchk</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>option http-keep-alive</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>http-check send meth OPTIONS uri /minio/health/live</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- <span style=color:#000>http-check expect status 200</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>servers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-1 ,ip: 10.10.10.10 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-2 ,ip: 10.10.10.11 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-3 ,ip: 10.10.10.12 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-4 ,ip: 10.10.10.13 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>First, modify the MinIO cluster definition to add four new nodes, assigning sequence numbers 5 to 8.
The key step is to modify the <a href=param#minio_volumes><code>minio_volumes</code></a> parameter to designate the new four nodes as a new <strong>storage pool</strong>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>minio</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 1 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-1 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 2 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-2 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 3 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-3 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 4 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-4 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># new nodes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.14</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 5 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-5 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.15</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 6 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-6 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.16</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 7 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-7 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.17</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>minio_seq: 8 , nodename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio-8 }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;/data{1...4}&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;https://minio-{1...4}.pigsty:9000/data{1...4} https://minio-{5...8}.pigsty:9000/data{1...4}&#39;</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># new cluster config</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># ... other configs omitted</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Step 2: Add these nodes to Pigsty:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -l 10.10.10.14,10.10.10.15,10.10.10.16,10.10.10.17
</span></span></code></pre></div><p>Step 3: On the new nodes, use the Ansible <a href=playbook>playbook</a> to install and prepare MinIO software:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l 10.10.10.14,10.10.10.15,10.10.10.16,10.10.10.17 -t minio_install
</span></span></code></pre></div><p>Step 4: On the <strong>entire cluster</strong>, use the Ansible <a href=playbook>playbook</a> to reconfigure the MinIO cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio -t minio_config
</span></span></code></pre></div><blockquote><p>This step updates the <code>MINIO_VOLUMES</code> configuration on the existing four nodes</p></blockquote><p>Step 5: Restart the entire MinIO cluster at once (be careful, do not rolling restart!):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio -t minio_launch -f <span style=color:#0000cf;font-weight:700>10</span>   <span style=color:#8f5902;font-style:italic># 8 parallel, ensure simultaneous restart</span>
</span></span></code></pre></div><p>Step 6 (optional): If you are using a load balancer, make sure the load balancer configuration is updated. For example, add the new four nodes to the load balancer configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># expose minio service with haproxy on all nodes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>haproxy_services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service name, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9002</span><span style=color:#f8f8f8>                     </span><span style=color:#8f5902;font-style:italic># [REQUIRED] service port, unique</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>balance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>leastconn            </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] load balancer algorithm</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>                       </span><span style=color:#8f5902;font-style:italic># [OPTIONAL] minio health check</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>option httpchk</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>option http-keep-alive</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>http-check send meth OPTIONS uri /minio/health/live</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>http-check expect status 200</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>servers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-1 ,ip: 10.10.10.10 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-2 ,ip: 10.10.10.11 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-3 ,ip: 10.10.10.12 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-4 ,ip: 10.10.10.13 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-5 ,ip: 10.10.10.14 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-6 ,ip: 10.10.10.15 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-7 ,ip: 10.10.10.16 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: minio-8 ,ip: 10.10.10.17 ,port: 9000 ,options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;check-ssl ca-file /etc/pki/ca.crt check port 9000&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then, run the <code>haproxy</code> subtask of the <code>node.yml</code> playbook to update the load balancer configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -l minio -t haproxy_config,haproxy_reload   <span style=color:#8f5902;font-style:italic># Update and reload load balancer config</span>
</span></span></code></pre></div><p>If you use L2 VIP for reliable load balancer access, you also need to add new nodes (if any) to the existing NODE VIP group:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -l minio -t node_vip  <span style=color:#8f5902;font-style:italic># Refresh cluster L2 VIP configuration</span>
</span></span></code></pre></div><hr><h2 id=shrink-cluster>Shrink Cluster</h2><p>MinIO cannot shrink at the node/disk level, but can retire at the storage pool (multiple nodes) level — add a new storage pool, drain the old storage pool to the new one, then retire the old storage pool.</p><ul><li><a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/decommission-server-pool.html>Shrink Cluster Tutorial</a></li></ul><hr><h2 id=upgrade-cluster>Upgrade Cluster</h2><ul><li><a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/upgrade-minio-deployment.html>Upgrade Cluster Tutorial</a></li></ul><p>First, download the new version of MinIO packages to the local software repository on the INFRA node, then rebuild the repository index:</p><ul><li><a href=https://github.com/minio/minio>minio</a>:<ul><li>amd64: <a href=https://dl.min.io/server/minio/release/linux-amd64/>https://dl.min.io/server/minio/release/linux-amd64/</a></li><li>arm64: <a href=https://dl.min.io/server/minio/release/linux-arm64/>https://dl.min.io/server/minio/release/linux-arm64/</a></li></ul></li><li><a href=https://github.com/minio/mc>mcli</a>:<ul><li>amd64: <a href=https://dl.min.io/client/mc/release/linux-amd64/>https://dl.min.io/client/mc/release/linux-amd64/</a></li><li>arm64: <a href=https://dl.min.io/client/mc/release/linux-arm64/>https://dl.min.io/client/mc/release/linux-arm64/</a></li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./infra.yml -t repo_create
</span></span></code></pre></div><p>Next, use Ansible to batch upgrade MinIO packages:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible minio -m package -b -a <span style=color:#4e9a06>&#39;name=minio state=latest&#39;</span>  <span style=color:#8f5902;font-style:italic># Upgrade MinIO server</span>
</span></span><span style=display:flex><span>ansible minio -m package -b -a <span style=color:#4e9a06>&#39;name=mcli state=latest&#39;</span>   <span style=color:#8f5902;font-style:italic># Upgrade MinIO client</span>
</span></span></code></pre></div><p>Finally, use the mc command line tool to instruct the MinIO cluster to restart:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mc admin service restart sss
</span></span></code></pre></div><hr><h2 id=node-failure-recovery>Node Failure Recovery</h2><ul><li><a href=https://min.io/docs/minio/linux/operations/data-recovery/recover-after-node-failure.html#minio-restore-hardware-failure-node>Node Failure Tutorial</a></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Remove the failed node from the cluster</span>
</span></span><span style=display:flex><span>bin/node-rm &lt;your_old_node_ip&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Replace the failed node with the same node name (if IP changes, modify the MinIO cluster definition)</span>
</span></span><span style=display:flex><span>bin/node-add &lt;your_new_node_ip&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Install and configure MinIO on the new node</span>
</span></span><span style=display:flex><span>./minio.yml -l &lt;your_new_node_ip&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Instruct MinIO to perform heal action</span>
</span></span><span style=display:flex><span>mc admin heal
</span></span></code></pre></div><hr><h2 id=disk-failure-recovery>Disk Failure Recovery</h2><ul><li><a href=https://min.io/docs/minio/linux/operations/data-recovery/recover-after-drive-failure.html#minio-restore-hardware-failure-drive>Disk Failure Tutorial</a></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Unmount the failed disk from the cluster</span>
</span></span><span style=display:flex><span>umount /dev/&lt;your_disk_device&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Replace the failed disk, format with xfs</span>
</span></span><span style=display:flex><span>mkfs.xfs /dev/sdb -L DRIVE1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Don&#39;t forget to setup fstab for auto-mount</span>
</span></span><span style=display:flex><span>vi /etc/fstab
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># LABEL=DRIVE1     /mnt/drive1    xfs     defaults,noatime  0       2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Remount</span>
</span></span><span style=display:flex><span>mount -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 5. Instruct MinIO to perform heal action</span>
</span></span><span style=display:flex><span>mc admin heal
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-81383092950ff4115e1c3850be65d36f>6 - Monitoring</h1><div class=lead>How to monitor MinIO in Pigsty? How to use MinIO&rsquo;s built-in console? What alerting rules are worth noting?</div><hr><h2 id=built-in-console>Built-in Console</h2><p>MinIO has a built-in management console. By default, you can access this interface via HTTPS through the admin port (<a href=/docs/minio/param#minio_admin_port><code>minio_admin_port</code></a>, default <code>9001</code>) of any MinIO instance.</p><p>In most configuration templates that provide MinIO services, MinIO is exposed as a custom service at <code>m.pigsty</code>. After configuring domain name resolution, you can access the MinIO console at <code>https://m.pigsty</code>.</p><p>Log in with the admin credentials configured by <a href=/docs/minio/param#minio_access_key><code>minio_access_key</code></a> and <a href=/docs/minio/param#minio_secret_key><code>minio_secret_key</code></a> (default <code>minioadmin</code> / <code>S3User.MinIO</code>).</p><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>Note: HTTPS and Certificate Trust</div><p>The MinIO console requires HTTPS access. If you use Pigsty&rsquo;s self-signed CA, you need to trust the CA certificate in your browser, or manually accept the security warning.</p></div><hr><h2 id=pigsty-monitoring>Pigsty Monitoring</h2><p>Pigsty provides two monitoring dashboards related to the <a href=/docs/minio><code>MINIO</code></a> module:</p><ul><li><a href=https://demo.pigsty.io/d/minio-overview>MinIO Overview</a>: Displays overall monitoring metrics for the MinIO cluster, including cluster status, storage usage, request rates, etc.</li><li><a href=https://demo.pigsty.io/d/minio-instance>MinIO Instance</a>: Displays monitoring metrics details for a single MinIO instance, including CPU, memory, network, disk, etc.</li></ul><p><a href=https://demo.pigsty.io/d/minio-overview><img src=/img/dashboard/minio-overview.jpg alt=minio-overview.jpg></a></p><p>MinIO monitoring metrics are collected through MinIO&rsquo;s native Prometheus endpoint (<code>/minio/v2/metrics/cluster</code>), and by default are scraped and stored by Victoria Metrics.</p><hr><h2 id=pigsty-alerting>Pigsty Alerting</h2><p>Pigsty provides the following three alerting rules for MinIO:</p><ul><li>MinIO Server Down</li><li>MinIO Node Offline</li><li>MinIO Disk Offline</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                         Aliveness                            #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MinIO server instance down</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>MinioServerDown</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio_up &lt; 1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 0, severity: CRIT, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CRIT MinioServerDown {{ $labels.ins }}@{{ $labels.instance }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      minio_up[ins={{ $labels.ins }}, instance={{ $labels.instance }}] = {{ $value }} &lt; 1
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/minio-overview</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                         Error                                #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MinIO node offline triggers a p1 alert</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>MinioNodeOffline</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>avg_over_time(minio_cluster_nodes_offline_total{job=&#34;minio&#34;}[5m]) &gt; 0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>3m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 1, severity: WARN, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;WARN MinioNodeOffline: {{ $labels.cls }} {{ $value }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      minio_cluster_nodes_offline_total[cls={{ $labels.cls }}] = {{ $value }} &gt; 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/minio-overview?from=now-5m&amp;to=now&amp;var-cls={{$labels.cls}}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># MinIO disk offline triggers a p1 alert</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>MinioDiskOffline</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>avg_over_time(minio_cluster_disk_offline_total{job=&#34;minio&#34;}[5m]) &gt; 0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>3m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 1, severity: WARN, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>minio }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;WARN MinioDiskOffline: {{ $labels.cls }} {{ $value }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      minio_cluster_disk_offline_total[cls={{ $labels.cls }}] = {{ $value }} &gt; 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/minio-overview?from=now-5m&amp;to=now&amp;var-cls={{$labels.cls}}</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-61857417600e2adc512dcba599edd776>7 - Metrics</h1><div class=lead>Complete list of monitoring metrics provided by the Pigsty MINIO module with explanations</div><p>The <a href=/docs/minio><strong><code>MINIO</code></strong></a> module contains 79 available monitoring metrics.</p><table><thead><tr><th>Metric Name</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td>minio_audit_failed_messages</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>target_id</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of messages that failed to send since start</td></tr><tr><td>minio_audit_target_queue_length</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>target_id</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of unsent messages in queue for target</td></tr><tr><td>minio_audit_total_messages</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>target_id</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of messages sent since start</td></tr><tr><td>minio_cluster_bucket_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of buckets in the cluster</td></tr><tr><td>minio_cluster_capacity_raw_free_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total free capacity online in the cluster</td></tr><tr><td>minio_cluster_capacity_raw_total_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total capacity online in the cluster</td></tr><tr><td>minio_cluster_capacity_usable_free_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total free usable capacity online in the cluster</td></tr><tr><td>minio_cluster_capacity_usable_total_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total usable capacity online in the cluster</td></tr><tr><td>minio_cluster_drive_offline_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total drives offline in this cluster</td></tr><tr><td>minio_cluster_drive_online_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total drives online in this cluster</td></tr><tr><td>minio_cluster_drive_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total drives in this cluster</td></tr><tr><td>minio_cluster_health_erasure_set_healing_drives</td><td>gauge</td><td><code>pool</code>, <code>ip</code>, <code>job</code>, <code>cls</code>, <code>set</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get the count of healing drives of this erasure set</td></tr><tr><td>minio_cluster_health_erasure_set_online_drives</td><td>gauge</td><td><code>pool</code>, <code>ip</code>, <code>job</code>, <code>cls</code>, <code>set</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get the count of the online drives in this erasure set</td></tr><tr><td>minio_cluster_health_erasure_set_read_quorum</td><td>gauge</td><td><code>pool</code>, <code>ip</code>, <code>job</code>, <code>cls</code>, <code>set</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get the read quorum for this erasure set</td></tr><tr><td>minio_cluster_health_erasure_set_status</td><td>gauge</td><td><code>pool</code>, <code>ip</code>, <code>job</code>, <code>cls</code>, <code>set</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get current health status for this erasure set</td></tr><tr><td>minio_cluster_health_erasure_set_write_quorum</td><td>gauge</td><td><code>pool</code>, <code>ip</code>, <code>job</code>, <code>cls</code>, <code>set</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get the write quorum for this erasure set</td></tr><tr><td>minio_cluster_health_status</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Get current cluster health status</td></tr><tr><td>minio_cluster_nodes_offline_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of MinIO nodes offline</td></tr><tr><td>minio_cluster_nodes_online_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of MinIO nodes online</td></tr><tr><td>minio_cluster_objects_size_distribution</td><td>gauge</td><td><code>ip</code>, <code>range</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Distribution of object sizes across a cluster</td></tr><tr><td>minio_cluster_objects_version_distribution</td><td>gauge</td><td><code>ip</code>, <code>range</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Distribution of object versions across a cluster</td></tr><tr><td>minio_cluster_usage_deletemarker_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of delete markers in a cluster</td></tr><tr><td>minio_cluster_usage_object_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of objects in a cluster</td></tr><tr><td>minio_cluster_usage_total_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total cluster usage in bytes</td></tr><tr><td>minio_cluster_usage_version_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of versions (includes delete marker) in a cluster</td></tr><tr><td>minio_cluster_webhook_failed_messages</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of messages that failed to send</td></tr><tr><td>minio_cluster_webhook_online</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Is the webhook online?</td></tr><tr><td>minio_cluster_webhook_queue_length</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Webhook queue length</td></tr><tr><td>minio_cluster_webhook_total_messages</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of messages sent to this target</td></tr><tr><td>minio_cluster_write_quorum</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Maximum write quorum across all pools and sets</td></tr><tr><td>minio_node_file_descriptor_limit_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Limit on total number of open file descriptors for the MinIO Server process</td></tr><tr><td>minio_node_file_descriptor_open_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of open file descriptors by the MinIO Server process</td></tr><tr><td>minio_node_go_routine_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of go routines running</td></tr><tr><td>minio_node_ilm_expiry_pending_tasks</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of pending ILM expiry tasks in the queue</td></tr><tr><td>minio_node_ilm_transition_active_tasks</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of active ILM transition tasks</td></tr><tr><td>minio_node_ilm_transition_missed_immediate_tasks</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of missed immediate ILM transition tasks</td></tr><tr><td>minio_node_ilm_transition_pending_tasks</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of pending ILM transition tasks in the queue</td></tr><tr><td>minio_node_ilm_versions_scanned</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of object versions checked for ilm actions since server start</td></tr><tr><td>minio_node_io_rchar_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total bytes read by the process from the underlying storage system including cache, /proc/[pid]/io rchar</td></tr><tr><td>minio_node_io_read_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total bytes read by the process from the underlying storage system, /proc/[pid]/io read_bytes</td></tr><tr><td>minio_node_io_wchar_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total bytes written by the process to the underlying storage system including page cache, /proc/[pid]/io wchar</td></tr><tr><td>minio_node_io_write_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total bytes written by the process to the underlying storage system, /proc/[pid]/io write_bytes</td></tr><tr><td>minio_node_process_cpu_total_seconds</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total user and system CPU time spent in seconds</td></tr><tr><td>minio_node_process_resident_memory_bytes</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Resident memory size in bytes</td></tr><tr><td>minio_node_process_starttime_seconds</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Start time for MinIO process per node, time in seconds since Unix epoc</td></tr><tr><td>minio_node_process_uptime_seconds</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Uptime for MinIO process per node in seconds</td></tr><tr><td>minio_node_scanner_bucket_scans_finished</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of bucket scans finished since server start</td></tr><tr><td>minio_node_scanner_bucket_scans_started</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of bucket scans started since server start</td></tr><tr><td>minio_node_scanner_directories_scanned</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of directories scanned since server start</td></tr><tr><td>minio_node_scanner_objects_scanned</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of unique objects scanned since server start</td></tr><tr><td>minio_node_scanner_versions_scanned</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of object versions scanned since server start</td></tr><tr><td>minio_node_syscall_read_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total read SysCalls to the kernel. /proc/[pid]/io syscr</td></tr><tr><td>minio_node_syscall_write_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total write SysCalls to the kernel. /proc/[pid]/io syscw</td></tr><tr><td>minio_notify_current_send_in_progress</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Number of concurrent async Send calls active to all targets (deprecated, please use &lsquo;minio_notify_target_current_send_in_progress&rsquo; instead)</td></tr><tr><td>minio_notify_events_errors_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Events that were failed to be sent to the targets (deprecated, please use &lsquo;minio_notify_target_failed_events&rsquo; instead)</td></tr><tr><td>minio_notify_events_sent_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of events sent to the targets (deprecated, please use &lsquo;minio_notify_target_total_events&rsquo; instead)</td></tr><tr><td>minio_notify_events_skipped_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Events that were skipped to be sent to the targets due to the in-memory queue being full</td></tr><tr><td>minio_s3_requests_4xx_errors_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code>, <code>api</code></td><td>Total number of S3 requests with (4xx) errors</td></tr><tr><td>minio_s3_requests_errors_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code>, <code>api</code></td><td>Total number of S3 requests with (4xx and 5xx) errors</td></tr><tr><td>minio_s3_requests_incoming_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of incoming S3 requests</td></tr><tr><td>minio_s3_requests_inflight_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code>, <code>api</code></td><td>Total number of S3 requests currently in flight</td></tr><tr><td>minio_s3_requests_rejected_auth_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of S3 requests rejected for auth failure</td></tr><tr><td>minio_s3_requests_rejected_header_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of S3 requests rejected for invalid header</td></tr><tr><td>minio_s3_requests_rejected_invalid_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of invalid S3 requests</td></tr><tr><td>minio_s3_requests_rejected_timestamp_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of S3 requests rejected for invalid timestamp</td></tr><tr><td>minio_s3_requests_total</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code>, <code>api</code></td><td>Total number of S3 requests</td></tr><tr><td>minio_s3_requests_ttfb_seconds_distribution</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>le</code>, <code>instance</code>, <code>server</code>, <code>ins</code>, <code>api</code></td><td>Distribution of time to first byte across API calls</td></tr><tr><td>minio_s3_requests_waiting_total</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of S3 requests in the waiting queue</td></tr><tr><td>minio_s3_traffic_received_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of s3 bytes received</td></tr><tr><td>minio_s3_traffic_sent_bytes</td><td>counter</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Total number of s3 bytes sent</td></tr><tr><td>minio_software_commit_info</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>commit</code>, <code>server</code>, <code>ins</code></td><td>Git commit hash for the MinIO release</td></tr><tr><td>minio_software_version_info</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>version</code>, <code>server</code>, <code>ins</code></td><td>MinIO Release tag for the server</td></tr><tr><td>minio_up</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr><tr><td>minio_usage_last_activity_nano_seconds</td><td>gauge</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>server</code>, <code>ins</code></td><td>Time elapsed (in nano seconds) since last scan activity.</td></tr><tr><td>scrape_duration_seconds</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr><tr><td>scrape_samples_post_metric_relabeling</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr><tr><td>scrape_samples_scraped</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr><tr><td>scrape_series_added</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr><tr><td>up</td><td>Unknown</td><td><code>ip</code>, <code>job</code>, <code>cls</code>, <code>instance</code>, <code>ins</code></td><td>N/A</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-571982477397f0d78a3a5034a4ef3e1d>8 - FAQ</h1><div class=lead>Frequently asked questions about the Pigsty MINIO object storage module</div><hr><h2 id=what-version-of-minio-does-pigsty-use>What version of MinIO does Pigsty use?</h2><p>MinIO announced entering <strong>maintenance mode</strong> on 2025-12-03, no longer releasing new feature versions, only security patches and maintenance versions, and stopped releasing binary RPM/DEB on 2025-10-15.
So Pigsty forked its own <a href=https://github.com/pgsty/minio>MinIO</a> and used <a href=https://github.com/minio/pkger><code>minio/pkger</code></a> to create the latest 2025-12-03 version.</p><p>This version fixes the MinIO <a href=https://nvd.nist.gov/vuln/detail/CVE-2025-62506><strong>CVE-2025-62506</strong></a> security vulnerability, ensuring Pigsty users&rsquo; MinIO deployments are safe and reliable.
You can find the RPM/DEB packages and build scripts in the Pigsty Infra repository.</p><hr><h2 id=why-does-minio-require-https>Why does MinIO require HTTPS?</h2><p>When pgBackRest uses object storage as a backup repository, HTTPS is mandatory to ensure data transmission security.
If your MinIO is not used for pgBackRest backup, you can still choose to use HTTP protocol.
You can disable HTTPS by modifying the parameter <a href=/docs/minio/param#minio_https><code>minio_https</code></a>.</p><hr><h2 id=getting-invalid-certificate-error-when-accessing-minio-from-containers>Getting invalid certificate error when accessing MinIO from containers?</h2><p>Unless you use certificates issued by a real enterprise CA, MinIO uses self-signed certificates by default, which causes client tools inside containers (such as mc / rclone / awscli, etc.) to be unable to verify the identity of the MinIO server, resulting in invalid certificate errors.</p><p>For example, for Node.js applications, you can mount the MinIO server&rsquo;s CA certificate into the container and specify the CA certificate path via the environment variable <code>NODE_EXTRA_CA_CERTS</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>NODE_EXTRA_CA_CERTS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/etc/pki/ca.crt</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>/etc/pki/ca.crt:/etc/pki/ca.crt:ro</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Of course, if your MinIO is not used as a pgBackRest backup repository, you can also choose to disable MinIO&rsquo;s HTTPS support and use HTTP protocol instead.</p><hr><h2 id=what-if-multi-nodemulti-disk-minio-cluster-fails-to-start>What if multi-node/multi-disk MinIO cluster fails to start?</h2><p>In <a href=/docs/minio/config#single-node-multi-disk><strong>Single-Node Multi-Disk</strong></a> or <a href=/docs/minio/config#multi-node-multi-disk><strong>Multi-Node Multi-Disk</strong></a> mode, if the data directory is not a valid disk mount point, MinIO will refuse to start.
Please use mounted disks as MinIO&rsquo;s data directory instead of regular directories. You can only use regular directories as MinIO&rsquo;s data directory in <a href=/docs/minio/config#single-node-single-disk><strong>Single-Node Single-Disk</strong></a> mode, which is only suitable for development testing or non-critical scenarios.</p><hr><h2 id=how-to-add-new-members-to-an-existing-minio-cluster>How to add new members to an existing MinIO cluster?</h2><blockquote><p>Before deployment, you should plan MinIO cluster capacity, as adding new members requires a global restart.</p></blockquote><p>You can scale MinIO by adding new server nodes to the existing cluster to create a new storage pool.</p><p>Note that once MinIO is deployed, you cannot modify the number of nodes and disks in the existing cluster! You can only scale by adding new storage pools.</p><p>For detailed steps, please refer to the Pigsty documentation: <a href=/docs/minio/admin#expand-cluster><strong>Expand Cluster</strong></a>, and the MinIO official documentation: <a href=https://min.io/docs/minio/linux/operations/install-deploy-manage/expand-minio-deployment.html><strong>Expand MinIO Deployment</strong></a></p><hr><h2 id=how-to-remove-a-minio-cluster>How to remove a MinIO cluster?</h2><p>Starting from Pigsty v3.6, removing a MinIO cluster requires using the dedicated <code>minio-rm.yml</code> playbook:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio-rm.yml -l minio                   <span style=color:#8f5902;font-style:italic># Remove MinIO cluster</span>
</span></span><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>  <span style=color:#8f5902;font-style:italic># Remove cluster but keep data</span>
</span></span></code></pre></div><p>If you have enabled <a href=/docs/minio/param#minio_safeguard><code>minio_safeguard</code></a> protection, you need to explicitly override it to perform removal:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio-rm.yml -l minio -e <span style=color:#000>minio_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span></code></pre></div><hr><h2 id=whats-the-difference-between-mcli-and-mc-commands>What&rsquo;s the difference between mcli and mc commands?</h2><p><code>mcli</code> is a renamed version of the official MinIO client <code>mc</code>. In Pigsty, we use <code>mcli</code> instead of <code>mc</code> to avoid conflicts with Midnight Commander (a common file manager that also uses the <code>mc</code> command).</p><p>Both have identical functionality, just with different command names. You can find the complete command reference in the <a href=https://min.io/docs/minio/linux/reference/minio-mc.html>MinIO Client documentation</a>.</p><hr><h2 id=how-to-monitor-minio-cluster-status>How to monitor MinIO cluster status?</h2><p>Pigsty provides out-of-the-box monitoring capabilities for MinIO:</p><ul><li><strong>Grafana Dashboards</strong>: <a href=https://demo.pigsty.io/d/minio-overview>MinIO Overview</a> and <a href=https://demo.pigsty.io/d/minio-instance>MinIO Instance</a></li><li><strong>Alerting Rules</strong>: Including MinIO down, node offline, disk offline alerts</li><li><strong>MinIO Built-in Console</strong>: Access via <code>https://&lt;minio-ip>:9001</code></li></ul><p>For details, please refer to the <a href=/docs/minio/monitor>Monitoring</a> documentation</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email - Vonng" aria-label="Email - Vonng"><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label="Email - Vonng"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=WeChat aria-label=WeChat><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=WeChat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=Discussion><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Repo aria-label=Repo><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=Repo><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><link rel=canonical type=text/html href=https://pigsty.io/docs/redis/><link rel=alternate type=application/rss+xml href=https://pigsty.io/docs/redis/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Module: REDIS | PIGSTY</title><meta name=description content="Pigsty has built-in Redis support, a high-performance in-memory data structure server. Deploy Redis in standalone, cluster, or sentinel mode as a companion to PostgreSQL."><meta property="og:url" content="https://pigsty.io/docs/redis/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="Module: REDIS"><meta property="og:description" content="Pigsty has built-in Redis support, a high-performance in-memory data structure server. Deploy Redis in standalone, cluster, or sentinel mode as a companion to PostgreSQL."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Module: REDIS"><meta itemprop=description content="Pigsty has built-in Redis support, a high-performance in-memory data structure server. Deploy Redis in standalone, cluster, or sentinel mode as a companion to PostgreSQL."><meta itemprop=dateModified content="2026-01-08T18:48:49+08:00"><meta itemprop=wordCount content="49"><meta itemprop=keywords content="Reference,REDIS"><meta name=twitter:card content="summary"><meta name=twitter:title content="Module: REDIS"><meta name=twitter:description content="Pigsty has built-in Redis support, a high-performance in-memory data structure server. Deploy Redis in standalone, cluster, or sentinel mode as a companion to PostgreSQL."><link rel=preload href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css as=style integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><link href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css rel=stylesheet integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Ver</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.cc>Pigsty 中文网站</a></li><li><a class=dropdown-item href=https://doc.pgsty.com>Pigsty v3.7 Doc</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc>Pigsty v3.4 Doc</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 Doc</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 Doc</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch Language / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d757e151050fd40088751a74721d74f6.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:window.location.href="https://pigsty.cc"+e}</script></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/redis/>Return to the regular view of this page</a>.</p></div><h1 class=title>Module: REDIS</h1><div class=lead>Pigsty has built-in Redis support, a high-performance in-memory data structure server. Deploy Redis in standalone, cluster, or sentinel mode as a companion to PostgreSQL.</div><ul><li>1: <a href=#pg-fc15b08dead0af0ef0581be1e78f1089>Configuration</a></li><li>2: <a href=#pg-107d691b6855a16e3959ebbb20893769>Parameters</a></li><li>3: <a href=#pg-a4ac99db4d7e939afec8be333eb8e254>Playbook</a></li><li>4: <a href=#pg-d30f775631874dbea209c56a3cf88d88>Administration</a></li><li>5: <a href=#pg-81482490a3974d936d1dca668f5c2d09>Monitoring</a></li><li>6: <a href=#pg-5bcac294a078899a139a79dc1fb2b009>Metrics</a></li><li>7: <a href=#pg-b2e89e0d2e5fa7361edacff6f86e00ea>FAQ</a></li></ul><div class=content><p>Redis is a widely popular open-source high-performance in-memory data structure server, and a great companion to PostgreSQL.
Redis in Pigsty is a production-ready complete solution supporting master-slave replication, sentinel high availability, and native cluster mode, with integrated monitoring and logging capabilities, along with automated installation, configuration, and operation playbooks.</p></div></div><div class=td-content><h1 id=pg-fc15b08dead0af0ef0581be1e78f1089>1 - Configuration</h1><div class=lead>Choose the appropriate Redis mode for your use case and express your requirements through the inventory</div><hr><h2 id=concept>Concept</h2><p>The entity model of Redis is almost the same as that of <a href=/docs/pgsql/config#er-diagram>PostgreSQL</a>, which also includes the concepts of <strong>Cluster</strong> and <strong>Instance</strong>. Note that the Cluster here does not refer to the native Redis Cluster mode.</p><p>The core difference between the REDIS module and the PGSQL module is that Redis uses a <strong>single-node multi-instance</strong> deployment rather than the 1:1 deployment: multiple Redis instances are typically deployed on a physical/virtual machine node to utilize multi-core CPUs fully. Therefore, the ways to <a href=#configuration>configure</a> and <a href=#administration>administer</a> Redis instances are slightly different from PGSQL.</p><p>In Redis managed by Pigsty, nodes are entirely subordinate to the cluster, which means that currently, it is not allowed to deploy Redis instances of two different clusters on one node. However, this does not affect deploying multiple independent Redis primary-replica instances on one node. Of course, there are some limitations; for example, in this case, you cannot specify different passwords for different instances on the same node.</p><hr><h2 id=identity-parameters>Identity Parameters</h2><p>Redis <a href=param#redis_id><strong>identity parameters</strong></a> are required parameters when defining a Redis cluster.</p><table><thead><tr><th style=text-align:center>Name</th><th style=text-align:center>Attribute</th><th style=text-align:center>Description</th><th style=text-align:center>Example</th></tr></thead><tbody><tr><td style=text-align:center><a href=param#redis_cluster><code>redis_cluster</code></a></td><td style=text-align:center><strong>REQUIRED</strong>, cluster level</td><td style=text-align:center>Cluster name</td><td style=text-align:center><code>redis-test</code></td></tr><tr><td style=text-align:center><a href=param#redis_node><code>redis_node</code></a></td><td style=text-align:center><strong>REQUIRED</strong>, node level</td><td style=text-align:center>Node sequence number</td><td style=text-align:center><code>1</code>,<code>2</code></td></tr><tr><td style=text-align:center><a href=param#redis_instances><code>redis_instances</code></a></td><td style=text-align:center><strong>REQUIRED</strong>, node level</td><td style=text-align:center>Instance definition</td><td style=text-align:center><code>{ 6001 : {} ,6002 : {}}</code></td></tr></tbody></table><ul><li><a href=param#redis_cluster><code>redis_cluster</code></a>: Redis cluster name, serves as the top-level namespace for cluster resources.</li><li><a href=param#redis_node><code>redis_node</code></a>: Redis node number, an integer unique within the cluster to distinguish different nodes.</li><li><a href=param#redis_instances><code>redis_instances</code></a>: JSON object where keys are instance port numbers and values are JSON objects containing other instance configurations.</li></ul><hr><h2 id=redis-mode>Redis Mode</h2><p>There are three different working modes for Redis, specified by the <a href=param#redis_mode><code>redis_mode</code></a> parameter:</p><ul><li><code>standalone</code>: Default standalone master-slave mode</li><li><code>cluster</code>: Redis native distributed cluster mode</li><li><code>sentinel</code>: Sentinel mode, providing high availability for standalone master-slave Redis</li></ul><p>Here are three examples of Redis cluster definitions:</p><ul><li>A 1-node, one master & one slave Redis Standalone cluster: <code>redis-ms</code></li><li>A 1-node, 3-instance Redis Sentinel cluster: <code>redis-sentinel</code></li><li>A 2-node, 6-instance Redis Cluster: <code>redis-cluster</code></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-ms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># redis classic primary &amp; replica</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_cluster: redis-ms ,redis_password: &#39;redis.ms&#39; ,redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>64MB }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># redis sentinel x 3</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>26379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,26380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,26381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;redis.meta&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sentinel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>16MB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_sentinel_monitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># primary list for redis sentinel, use cls as name, primary ip:port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-ms, host: 10.10.10.10, port: 6379 ,password: redis.ms, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-test: # redis native cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>3m x 3s</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 ,redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 ,redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_cluster: redis-test ,redis_password: &#39;redis.test&#39; ,redis_mode: cluster, redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>32MB }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=limitations>Limitations</h2><ul><li>A Redis node can only belong to one Redis cluster, which means you cannot assign a node to two different Redis clusters simultaneously.</li><li>On each Redis node, you need to assign a unique port number to each Redis instance to avoid port conflicts.</li><li>Typically, the same Redis cluster will use the same password, but multiple Redis instances on a Redis node cannot have different passwords (because redis_exporter only allows one password).</li><li>Redis Cluster has built-in HA, while standalone master-slave HA requires additional manual configuration in Sentinel since we don&rsquo;t know if you have deployed Sentinel.</li><li>Fortunately, configuring HA for standalone Redis is straightforward through Sentinel. For details, see <a href=admin#configure-ha-with-sentinel>Administration - Configure HA with Sentinel</a>.</li></ul><hr><h2 id=typical-configuration-examples>Typical Configuration Examples</h2><p>Here are some common Redis configuration examples for different scenarios:</p><h3 id=cache-cluster-pure-in-memory>Cache Cluster (Pure In-Memory)</h3><p>For pure caching scenarios with no data persistence requirements:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-cache</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-cache</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;cache.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>2GB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mem_policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>allkeys-lru   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># evict LRU keys when memory is full</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8>               </span><span style=color:#8f5902;font-style:italic># disable RDB persistence</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>         </span><span style=color:#8f5902;font-style:italic># disable AOF persistence</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=session-store-cluster>Session Store Cluster</h3><p>For web application session storage with some persistence needs:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-session</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-session</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;session.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1GB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mem_policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>volatile-lru  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># only evict keys with expire set</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;300 1&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># save every 5 minutes if at least 1 change</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=message-queue-cluster>Message Queue Cluster</h3><p>For simple message queue scenarios requiring higher data reliability:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-queue</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-queue</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;queue.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>4GB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mem_policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>noeviction    </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># reject writes when memory full, don&#39;t evict</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;60 1&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>         </span><span style=color:#8f5902;font-style:italic># save every minute if at least 1 change</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>          </span><span style=color:#8f5902;font-style:italic># enable AOF for better persistence</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=high-availability-master-slave-cluster>High Availability Master-Slave Cluster</h3><p>Master-slave cluster with Sentinel automatic failover:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Master-slave cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-ha</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>                              </span><span style=color:#8f5902;font-style:italic># primary</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># replica 1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 3 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># replica 2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-ha</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;ha.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>8GB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Sentinel cluster (manages the above master-slave cluster)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-sentinel</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>26379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>26379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 3 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>26379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-sentinel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;sentinel.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>sentinel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>64MB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_sentinel_monitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-ha, host: 10.10.10.10, port: 6379, password: &#39;ha.password&#39;, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=large-scale-native-cluster>Large-Scale Native Cluster</h3><p>For high-volume, high-throughput scenarios using native distributed cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 3 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 4 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;cluster.password&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster_replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># 1 replica per primary shard</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>16GB          </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># max memory per instance</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;900 1&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This creates a 6-primary, 6-replica native cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Total capacity ~96GB (6 * 16GB)</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=security-hardening-configuration>Security Hardening Configuration</h3><p>Recommended security configuration for production environments:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-secure</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis-secure</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;StrongP@ssw0rd!&#39;</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># use strong password</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_bind_address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># bind to internal IP instead of 0.0.0.0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>4GB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rename_commands</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># rename dangerous commands</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>FLUSHDB</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;DANGEROUS_FLUSHDB&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>FLUSHALL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;DANGEROUS_FLUSHALL&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>DEBUG</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#f8f8f8>                        </span><span style=color:#8f5902;font-style:italic># disable command</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>CONFIG</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;ADMIN_CONFIG&#39;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-107d691b6855a16e3959ebbb20893769>2 - Parameters</h1><div class=lead>REDIS module provides 18 deployment parameters + 3 removal parameters</div><p>Parameter list for the REDIS module.</p><hr><h2 id=parameter-overview>Parameter Overview</h2><p>The <a href=#redis><code>REDIS</code></a> parameter group is used for Redis cluster deployment and configuration, including identity, instance definitions, operating mode, memory configuration, persistence, and monitoring.</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:center>Type</th><th style=text-align:center>Level</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><a href=#redis_cluster><code>redis_cluster</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis cluster name, required identity parameter</td></tr><tr><td style=text-align:left><a href=#redis_instances><code>redis_instances</code></a></td><td style=text-align:center><code>dict</code></td><td style=text-align:center><code>I</code></td><td style=text-align:left>Redis instance definitions on this node</td></tr><tr><td style=text-align:left><a href=#redis_node><code>redis_node</code></a></td><td style=text-align:center><code>int</code></td><td style=text-align:center><code>I</code></td><td style=text-align:left>Redis node number, unique positive integer in cluster</td></tr><tr><td style=text-align:left><a href=#redis_fs_main><code>redis_fs_main</code></a></td><td style=text-align:center><code>path</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis main data directory, <code>/data</code> by default</td></tr><tr><td style=text-align:left><a href=#redis_exporter_enabled><code>redis_exporter_enabled</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Enable Redis Exporter?</td></tr><tr><td style=text-align:left><a href=#redis_exporter_port><code>redis_exporter_port</code></a></td><td style=text-align:center><code>port</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis Exporter listen port</td></tr><tr><td style=text-align:left><a href=#redis_exporter_options><code>redis_exporter_options</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C/I</code></td><td style=text-align:left>Redis Exporter CLI arguments</td></tr><tr><td style=text-align:left><a href=#redis_mode><code>redis_mode</code></a></td><td style=text-align:center><code>enum</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis mode: standalone, cluster, sentinel</td></tr><tr><td style=text-align:left><a href=#redis_conf><code>redis_conf</code></a></td><td style=text-align:center><code>string</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis config template, except sentinel</td></tr><tr><td style=text-align:left><a href=#redis_bind_address><code>redis_bind_address</code></a></td><td style=text-align:center><code>ip</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis bind address, empty uses host IP</td></tr><tr><td style=text-align:left><a href=#redis_max_memory><code>redis_max_memory</code></a></td><td style=text-align:center><code>size</code></td><td style=text-align:center><code>C/I</code></td><td style=text-align:left>Max memory for each Redis instance</td></tr><tr><td style=text-align:left><a href=#redis_mem_policy><code>redis_mem_policy</code></a></td><td style=text-align:center><code>enum</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis memory eviction policy</td></tr><tr><td style=text-align:left><a href=#redis_password><code>redis_password</code></a></td><td style=text-align:center><code>password</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis password, empty disables password</td></tr><tr><td style=text-align:left><a href=#redis_rdb_save><code>redis_rdb_save</code></a></td><td style=text-align:center><code>string[]</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Redis RDB save directives, empty list disables RDB</td></tr><tr><td style=text-align:left><a href=#redis_aof_enabled><code>redis_aof_enabled</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Enable Redis AOF?</td></tr><tr><td style=text-align:left><a href=#redis_rename_commands><code>redis_rename_commands</code></a></td><td style=text-align:center><code>dict</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Rename dangerous Redis commands</td></tr><tr><td style=text-align:left><a href=#redis_cluster_replicas><code>redis_cluster_replicas</code></a></td><td style=text-align:center><code>int</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Replicas per master in Redis native cluster</td></tr><tr><td style=text-align:left><a href=#redis_sentinel_monitor><code>redis_sentinel_monitor</code></a></td><td style=text-align:center><code>master[]</code></td><td style=text-align:center><code>C</code></td><td style=text-align:left>Master list for Redis Sentinel to monitor</td></tr></tbody></table><p>The <a href=#redis_remove><code>REDIS_REMOVE</code></a> parameter group controls Redis instance removal behavior.</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:center>Type</th><th style=text-align:center>Level</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><a href=#redis_safeguard><code>redis_safeguard</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>Prevent removing running Redis instances?</td></tr><tr><td style=text-align:left><a href=#redis_rm_data><code>redis_rm_data</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>Remove Redis data directory when removing?</td></tr><tr><td style=text-align:left><a href=#redis_rm_pkg><code>redis_rm_pkg</code></a></td><td style=text-align:center><code>bool</code></td><td style=text-align:center><code>G/C/A</code></td><td style=text-align:left>Uninstall Redis packages when removing?</td></tr></tbody></table><p>The <a href=/docs/redis>Redis</a> module contains 18 deployment parameters and 3 removal parameters.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#redis_cluster:             &lt;CLUSTER&gt; # Redis cluster name, required identity parameter</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#redis_node: 1              &lt;NODE&gt;    # Redis node number, unique in cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#redis_instances: {}        &lt;NODE&gt;    # Redis instance definitions on this node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_fs_main</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>/data                 </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Redis main data directory, `/data` by default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_exporter_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>          </span><span style=color:#8f5902;font-style:italic># Enable Redis Exporter?</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_exporter_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>9121</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># Redis Exporter listen port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_exporter_options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># Redis Exporter CLI arguments</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_mode: standalone                # Redis mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>standalone, cluster, sentinel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis.conf               </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Redis config template, except sentinel</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_bind_address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;0.0.0.0&#39;</span><span style=color:#f8f8f8>         </span><span style=color:#8f5902;font-style:italic># Redis bind address, empty uses host IP</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1GB                </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Max memory for each Redis instance</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_mem_policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>allkeys-lru        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Redis memory eviction policy</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#f8f8f8>                    </span><span style=color:#8f5902;font-style:italic># Redis password, empty disables password</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;1200 1&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># Redis RDB save directives, empty disables RDB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># Enable Redis AOF?</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_rename_commands</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># Rename dangerous Redis commands</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_cluster_replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># Replicas per master in Redis native cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_sentinel_monitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8>            </span><span style=color:#8f5902;font-style:italic># Master list for Sentinel, sentinel mode only</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># REDIS_REMOVE</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_safeguard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>                </span><span style=color:#8f5902;font-style:italic># Prevent removing running Redis instances?</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_rm_data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>                   </span><span style=color:#8f5902;font-style:italic># Remove Redis data directory when removing?</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_rm_pkg</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>                   </span><span style=color:#8f5902;font-style:italic># Uninstall Redis packages when removing?</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=redis_cluster><code>redis_cluster</code></h3><p>Parameter: <code>redis_cluster</code>, Type: <code>string</code>, Level: <code>C</code></p><p>Redis cluster name, a required identity parameter that must be explicitly configured at the cluster level. It serves as the namespace for resources within the cluster.</p><p>Must follow the naming pattern <code>[a-z][a-z0-9-]*</code> to comply with various identity constraints. Using <code>redis-</code> as a cluster name prefix is recommended.</p><h3 id=redis_node><code>redis_node</code></h3><p>Parameter: <code>redis_node</code>, Type: <code>int</code>, Level: <code>I</code></p><p>Redis node sequence number, a required identity parameter that must be explicitly configured at the node (Host) level.</p><p>A positive integer that should be unique within the cluster, used to distinguish and identify different nodes. Assign starting from 0 or 1.</p><h3 id=redis_instances><code>redis_instances</code></h3><p>Parameter: <code>redis_instances</code>, Type: <code>dict</code>, Level: <code>I</code></p><p>Redis instance definitions on the current node, a required parameter that must be explicitly configured at the node (Host) level.</p><p>Format is a JSON key-value object where keys are numeric port numbers and values are instance-specific JSON configuration items.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-test: # redis native cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>3m x 3s</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 ,redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 ,redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>} ,6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_cluster: redis-test ,redis_password: &#39;redis.test&#39; ,redis_mode: cluster, redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>32MB }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Each Redis instance listens on a unique port on its node. The <code>replica_of</code> field in instance configuration sets the upstream master address to establish replication:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.13 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>6381</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.13 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=redis_fs_main><code>redis_fs_main</code></h3><p>Parameter: <code>redis_fs_main</code>, Type: <code>path</code>, Level: <code>C</code></p><p>Main data disk mount point for Redis, default is <code>/data</code>. Pigsty creates a <code>redis</code> directory under this path to store Redis data.</p><p>The actual data storage directory is <code>/data/redis</code>, owned by the <code>redis</code> OS user. See <a href=/docs/ref/fhs#redis-fhs>FHS: Redis</a> for internal structure details.</p><h3 id=redis_exporter_enabled><code>redis_exporter_enabled</code></h3><p>Parameter: <code>redis_exporter_enabled</code>, Type: <code>bool</code>, Level: <code>C</code></p><p>Enable Redis Exporter monitoring component?</p><p>Enabled by default, deploying one exporter per Redis node, listening on <a href=#redis_exporter_port><code>redis_exporter_port</code></a> <code>9121</code> by default. It scrapes metrics from all Redis instances on the node.</p><p>When set to <code>false</code>, <code>roles/redis/tasks/exporter.yml</code> still renders config files but skips starting the <code>redis_exporter</code> systemd service (the <code>redis_exporter_launch</code> task has <code>when: redis_exporter_enabled|bool</code>), allowing manually configured exporters to remain.</p><h3 id=redis_exporter_port><code>redis_exporter_port</code></h3><p>Parameter: <code>redis_exporter_port</code>, Type: <code>port</code>, Level: <code>C</code></p><p>Redis Exporter listen port, default value: <code>9121</code></p><h3 id=redis_exporter_options><code>redis_exporter_options</code></h3><p>Parameter: <code>redis_exporter_options</code>, Type: <code>string</code>, Level: <code>C/I</code></p><p>Extra CLI arguments for Redis Exporter, rendered to <code>/etc/default/redis_exporter</code> (see <code>roles/redis/tasks/exporter.yml</code>), default is empty string. <code>REDIS_EXPORTER_OPTS</code> is appended to the systemd service&rsquo;s <code>ExecStart=/bin/redis_exporter $REDIS_EXPORTER_OPTS</code>, useful for configuring extra scrape targets or filtering behavior.</p><h3 id=redis_mode><code>redis_mode</code></h3><p>Parameter: <code>redis_mode</code>, Type: <code>enum</code>, Level: <code>C</code></p><p>Redis cluster operating mode, three options: <code>standalone</code>, <code>cluster</code>, <code>sentinel</code>. Default: <code>standalone</code></p><ul><li><code>standalone</code>: Default, independent Redis master-slave mode</li><li><code>cluster</code>: Redis native cluster mode</li><li><code>sentinel</code>: Redis high availability component: Sentinel</li></ul><p>When using <code>standalone</code> mode, Pigsty sets up Redis replication based on the <code>replica_of</code> parameter.</p><p>When using <code>cluster</code> mode, Pigsty creates a native Redis cluster using all defined instances based on the <a href=#redis_cluster_replicas><code>redis_cluster_replicas</code></a> parameter.</p><p>When <code>redis_mode=sentinel</code>, <code>redis.yml</code> executes the <code>redis-ha</code> phase (lines 80-130 of <code>redis.yml</code>) to distribute targets from <a href=#redis_sentinel_monitor><code>redis_sentinel_monitor</code></a> to all sentinels. When <code>redis_mode=cluster</code>, it also executes the <code>redis-join</code> phase (lines 134-180) calling <code>redis-cli --cluster create --cluster-yes ... --cluster-replicas {{ redis_cluster_replicas }}</code>. Both phases are automatically triggered in normal <code>./redis.yml -l &lt;cluster></code> runs, or can be run separately with <code>-t redis-ha</code> or <code>-t redis-join</code>.</p><h3 id=redis_conf><code>redis_conf</code></h3><p>Parameter: <code>redis_conf</code>, Type: <code>string</code>, Level: <code>C</code></p><p>Redis config template path, except for Sentinel.</p><p>Default: <code>redis.conf</code>, a template file at <a href=https://github.com/pgsty/pigsty/blob/main/roles/redis/templates/redis.conf><code>roles/redis/templates/redis.conf</code></a>.</p><p>To use your own Redis config template, place it in the <code>templates/</code> directory and set this parameter to the template filename.</p><p>Note: Redis Sentinel uses a different template file: <a href=https://github.com/pgsty/pigsty/blob/main/roles/redis/templates/redis-sentinel.conf><code>roles/redis/templates/redis-sentinel.conf</code></a>.</p><h3 id=redis_bind_address><code>redis_bind_address</code></h3><p>Parameter: <code>redis_bind_address</code>, Type: <code>ip</code>, Level: <code>C</code></p><p>IP address Redis server binds to. Empty string uses the hostname defined in the inventory.</p><p>Default: <code>0.0.0.0</code>, binding to all available IPv4 addresses on the host.</p><p>For security in production environments, bind only to internal IPs by setting this to empty string <code>''</code>.</p><p>When empty, the template <a href=https://github.com/pgsty/pigsty/blob/main/roles/redis/templates/redis.conf><code>roles/redis/templates/redis.conf</code></a> uses <code>inventory_hostname</code> to render <code>bind &lt;ip></code>, binding to the management address declared in the inventory.</p><h3 id=redis_max_memory><code>redis_max_memory</code></h3><p>Parameter: <code>redis_max_memory</code>, Type: <code>size</code>, Level: <code>C/I</code></p><p>Maximum memory for each Redis instance, default: <code>1GB</code>.</p><h3 id=redis_mem_policy><code>redis_mem_policy</code></h3><p>Parameter: <code>redis_mem_policy</code>, Type: <code>enum</code>, Level: <code>C</code></p><p>Redis memory eviction policy, default: <code>allkeys-lru</code></p><ul><li><code>noeviction</code>: Don&rsquo;t save new values when memory limit is reached; only applies to primary when using replication</li><li><code>allkeys-lru</code>: Keep most recently used keys; remove least recently used (LRU) keys</li><li><code>allkeys-lfu</code>: Keep frequently used keys; remove least frequently used (LFU) keys</li><li><code>volatile-lru</code>: Remove least recently used keys with expire field set</li><li><code>volatile-lfu</code>: Remove least frequently used keys with expire field set</li><li><code>allkeys-random</code>: Randomly remove keys to make space for new data</li><li><code>volatile-random</code>: Randomly remove keys with expire field set</li><li><code>volatile-ttl</code>: Remove keys with expire field set and shortest remaining TTL</li></ul><p>See <a href=https://redis.io/docs/reference/eviction/>Redis Eviction Policy</a> for details.</p><h3 id=redis_password><code>redis_password</code></h3><p>Parameter: <code>redis_password</code>, Type: <code>password</code>, Level: <code>C/N</code></p><p>Redis password. Empty string disables password, which is the default behavior.</p><p>Note that due to redis_exporter implementation limitations, you can only set one <code>redis_password</code> per node. This is usually not a problem since Pigsty doesn&rsquo;t allow deploying two different Redis clusters on the same node.</p><p>Pigsty automatically writes this password to <code>/etc/default/redis_exporter</code> (<code>REDIS_PASSWORD=...</code>) and uses it in the <code>redis-ha</code> phase with <code>redis-cli -a &lt;password></code>, so no need to separately configure exporter or Sentinel authentication.</p><blockquote><p>Use a strong password in production environments</p></blockquote><h3 id=redis_rdb_save><code>redis_rdb_save</code></h3><p>Parameter: <code>redis_rdb_save</code>, Type: <code>string[]</code>, Level: <code>C</code></p><p>Redis RDB save directives. Use empty list to disable RDB.</p><p>Default is <code>["1200 1"]</code>: dump dataset to disk every 20 minutes if at least 1 key changed.</p><p>See <a href=https://redis.io/docs/management/persistence/>Redis Persistence</a> for details.</p><h3 id=redis_aof_enabled><code>redis_aof_enabled</code></h3><p>Parameter: <code>redis_aof_enabled</code>, Type: <code>bool</code>, Level: <code>C</code></p><p>Enable Redis AOF? Default is <code>false</code>, meaning AOF is not used.</p><h3 id=redis_rename_commands><code>redis_rename_commands</code></h3><p>Parameter: <code>redis_rename_commands</code>, Type: <code>dict</code>, Level: <code>C</code></p><p>Rename dangerous Redis commands. A k:v dictionary where <code>old</code> is the command to rename and <code>new</code> is the new name.</p><p>Default: <code>{}</code>. You can hide dangerous commands like <code>FLUSHDB</code> and <code>FLUSHALL</code>. Example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>{<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>&#34;keys&#34;: </span><span style=color:#4e9a06>&#34;op_keys&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>&#34;flushdb&#34;: </span><span style=color:#4e9a06>&#34;op_flushdb&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>&#34;flushall&#34;: </span><span style=color:#4e9a06>&#34;op_flushall&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>&#34;config&#34;: </span><span style=color:#4e9a06>&#34;op_config&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=redis_cluster_replicas><code>redis_cluster_replicas</code></h3><p>Parameter: <code>redis_cluster_replicas</code>, Type: <code>int</code>, Level: <code>C</code></p><p>Number of replicas per master/primary in Redis native cluster. Default: <code>1</code>, meaning one replica per master.</p><h3 id=redis_sentinel_monitor><code>redis_sentinel_monitor</code></h3><p>Parameter: <code>redis_sentinel_monitor</code>, Type: <code>master[]</code>, Level: <code>C</code></p><p>List of masters for Redis Sentinel to monitor, used only on sentinel clusters. Each managed master is defined as:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_sentinel_monitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># primary list for redis sentinel, use cls as name, primary ip:port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-src, host: 10.10.10.45, port: 6379 ,password: redis.src, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-dst, host: 10.10.10.48, port: 6379 ,password: redis.dst, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><code>name</code> and <code>host</code> are required; <code>port</code>, <code>password</code>, and <code>quorum</code> are optional. <code>quorum</code> sets the number of sentinels needed to agree on master failure, typically more than half of sentinel instances (default is 1).</p><p>Starting from Pigsty 4.0, you can add <code>remove: true</code> to an entry, causing the <code>redis-ha</code> phase to only execute <code>SENTINEL REMOVE &lt;name></code>, useful for cleaning up targets no longer needed.</p><hr><h2 id=redis_remove>REDIS_REMOVE</h2><p>The following parameters are used by the <a href=https://github.com/pgsty/pigsty/tree/main/roles/redis_remove><code>redis_remove</code></a> role, invoked by the <a href=/docs/redis/playbook#redis-rmyml><code>redis-rm.yml</code></a> playbook, controlling Redis instance removal behavior.</p><h3 id=redis_safeguard><code>redis_safeguard</code></h3><p>Parameter: <code>redis_safeguard</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Redis safety guard to prevent accidental removal: when enabled, the <code>redis-rm.yml</code> playbook cannot remove running Redis instances.</p><p>Default is <code>false</code>. When set to <code>true</code>, the <code>redis-rm.yml</code> playbook refuses to execute, preventing accidental deletion of running Redis instances.</p><p>Override with CLI argument <code>-e redis_safeguard=false</code> to force removal.</p><h3 id=redis_rm_data><code>redis_rm_data</code></h3><p>Parameter: <code>redis_rm_data</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Remove Redis data directory when removing Redis instances? Default is <code>true</code>.</p><p>The data directory (<code>/data/redis/</code>) contains Redis RDB and AOF files. If not removed, newly deployed Redis instances will load data from these backup files.</p><p>Set to <code>false</code> to preserve data directories for later recovery.</p><h3 id=redis_rm_pkg><code>redis_rm_pkg</code></h3><p>Parameter: <code>redis_rm_pkg</code>, Type: <code>bool</code>, Level: <code>G/C/A</code></p><p>Uninstall Redis and redis_exporter packages when removing Redis instances? Default is <code>false</code>.</p><p>Typically not needed to uninstall packages; only enable when completely cleaning up a node.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a4ac99db4d7e939afec8be333eb8e254>3 - Playbook</h1><div class=lead>Manage Redis clusters with Ansible playbooks and quick command reference.</div><p>The REDIS module provides two playbooks for deploying/removing Redis clusters/nodes/instances:</p><ul><li><a href=#redisyml><code>redis.yml</code></a>: Deploy Redis cluster/node/instance</li><li><a href=#redis-rmyml><code>redis-rm.yml</code></a>: Remove Redis cluster/node/instance</li></ul><hr><h2 id=redisyml><code>redis.yml</code></h2><p>The <a href=https://github.com/pgsty/pigsty/blob/main/redis.yml><code>redis.yml</code></a> playbook for deploying Redis contains the following subtasks:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis_node        : Init redis node
</span></span><span style=display:flex><span>  - redis_install : Install redis <span style=color:#000;font-weight:700>&amp;</span> redis_exporter
</span></span><span style=display:flex><span>  - redis_user    : Create OS user redis
</span></span><span style=display:flex><span>  - redis_dir     : Configure redis FHS directory structure
</span></span><span style=display:flex><span>redis_exporter    : Configure redis_exporter monitoring
</span></span><span style=display:flex><span>  - redis_exporter_config  : Generate redis_exporter config
</span></span><span style=display:flex><span>  - redis_exporter_launch  : Launch redis_exporter
</span></span><span style=display:flex><span>redis_instance    : Init and restart redis cluster/node/instance
</span></span><span style=display:flex><span>  - redis_config  : Generate redis instance config
</span></span><span style=display:flex><span>  - redis_launch  : Launch redis instance
</span></span><span style=display:flex><span>redis_register    : Register redis to infrastructure
</span></span><span style=display:flex><span>redis_ha          : Configure redis sentinel <span style=color:#ce5c00;font-weight:700>(</span>sentinel mode only<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>redis_join        : Join redis native cluster <span style=color:#ce5c00;font-weight:700>(</span>cluster mode only<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=operation-levels>Operation Levels</h3><p><code>redis.yml</code> supports three operation levels, controlled by <code>-l</code> to limit target scope and <code>-e redis_port=&lt;port></code> to specify a single instance:</p><table><thead><tr><th style=text-align:left>Level</th><th style=text-align:left>Parameters</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><strong>Cluster</strong></td><td style=text-align:left><code>-l &lt;cluster></code></td><td style=text-align:left>Deploy all nodes and instances of the entire Redis cluster</td></tr><tr><td style=text-align:left><strong>Node</strong></td><td style=text-align:left><code>-l &lt;ip></code></td><td style=text-align:left>Deploy all Redis instances on the specified node</td></tr><tr><td style=text-align:left><strong>Instance</strong></td><td style=text-align:left><code>-l &lt;ip> -e redis_port=&lt;port></code></td><td style=text-align:left>Deploy only a single instance on the specified node</td></tr></tbody></table><h3 id=cluster-level-operations>Cluster-Level Operations</h3><p>Deploy an entire Redis cluster, including all instances on all nodes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l redis-ms           <span style=color:#8f5902;font-style:italic># deploy the entire redis-ms cluster</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-test         <span style=color:#8f5902;font-style:italic># deploy the entire redis-test cluster</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-sentinel     <span style=color:#8f5902;font-style:italic># deploy sentinel cluster</span>
</span></span></code></pre></div><p>Cluster-level operations will:</p><ul><li>Install Redis packages on all nodes</li><li>Create redis user and directory structure on all nodes</li><li>Start redis_exporter on all nodes</li><li>Deploy and start all defined Redis instances</li><li>Register all instances to the monitoring system</li><li>If <code>sentinel</code> mode, configure sentinel monitoring targets</li><li>If <code>cluster</code> mode, form the native cluster</li></ul><h3 id=node-level-operations>Node-Level Operations</h3><p>Deploy only all Redis instances on the specified node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l 10.10.10.10        <span style=color:#8f5902;font-style:italic># deploy all instances on this node</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.11        <span style=color:#8f5902;font-style:italic># deploy another node</span>
</span></span></code></pre></div><p>Node-level operations are useful for:</p><ul><li><strong>Scaling up</strong> by adding new nodes to an existing cluster</li><li>Redeploying all instances on a specific node</li><li>Reinitializing after node failure recovery</li></ul><blockquote><p><strong>Note</strong>: Node-level operations do not execute the <code>redis-ha</code> and <code>redis-join</code> stages. If you need to add a new node to a native cluster, you must manually run <code>redis-cli --cluster add-node</code></p></blockquote><h3 id=instance-level-operations>Instance-Level Operations</h3><p>Use the <code>-e redis_port=&lt;port></code> parameter to operate on a single instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Deploy only the 6379 port instance on 10.10.10.10</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.10 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Deploy only the 6380 port instance on 10.10.10.11</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.11 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6380</span>
</span></span></code></pre></div><p>Instance-level operations are useful for:</p><ul><li><strong>Adding new instances</strong> to an existing node</li><li>Redeploying a single failed instance</li><li>Updating a single instance&rsquo;s configuration</li></ul><p>When <code>redis_port</code> is specified:</p><ul><li>Only renders the config file for that port</li><li>Only starts/restarts the systemd service for that port</li><li>Only registers that instance to the monitoring system</li><li><strong>Does not</strong> affect other instances on the same node</li></ul><h3 id=common-tags>Common Tags</h3><p>Use the <code>-t &lt;tag></code> parameter to selectively execute certain tasks:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install packages only, don&#39;t start services</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-ms -t redis_node
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update config and restart instances only</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-ms -t redis_config,redis_launch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update monitoring registration only</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-ms -t redis_register
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Configure sentinel monitoring targets only (sentinel mode)</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-sentinel -t redis-ha
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Form native cluster only (cluster mode, auto-runs after first deployment)</span>
</span></span><span style=display:flex><span>./redis.yml -l redis-cluster -t redis-join
</span></span></code></pre></div><h3 id=idempotency>Idempotency</h3><p><code>redis.yml</code> is <strong>idempotent</strong> and safe to run repeatedly:</p><ul><li>Repeated execution <strong>overwrites</strong> existing config files</li><li>Repeated execution <strong>restarts</strong> Redis instances</li><li>Does not check if instances already exist; directly renders config and restarts</li><li>Suitable for batch updates after configuration changes</li></ul><blockquote><p><strong>Tip</strong>: If you only want to update configs without restarting all instances, use <code>-t redis_config</code> to render configs only, then manually restart the instances you need.</p></blockquote><hr><h2 id=redis-rmyml><code>redis-rm.yml</code></h2><p>The <a href=https://github.com/pgsty/pigsty/blob/main/redis-rm.yml><code>redis-rm.yml</code></a> playbook for removing Redis contains the following subtasks:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis_safeguard  : Safety check, abort <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>redis_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>redis_deregister : Remove registration from monitoring system
</span></span><span style=display:flex><span>  - rm_metrics   : Delete /infra/targets/redis/*.yml
</span></span><span style=display:flex><span>  - rm_logs      : Revoke /etc/vector/redis.yaml
</span></span><span style=display:flex><span>redis_exporter   : Stop and disable redis_exporter
</span></span><span style=display:flex><span>redis            : Stop and disable redis instances
</span></span><span style=display:flex><span>redis_data       : Delete data directories <span style=color:#ce5c00;font-weight:700>(</span>when <span style=color:#000>redis_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>redis_pkg        : Uninstall packages <span style=color:#ce5c00;font-weight:700>(</span>when <span style=color:#000>redis_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=operation-levels-1>Operation Levels</h3><p><code>redis-rm.yml</code> also supports three operation levels:</p><table><thead><tr><th style=text-align:left>Level</th><th style=text-align:left>Parameters</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><strong>Cluster</strong></td><td style=text-align:left><code>-l &lt;cluster></code></td><td style=text-align:left>Remove all nodes and instances of the entire Redis cluster</td></tr><tr><td style=text-align:left><strong>Node</strong></td><td style=text-align:left><code>-l &lt;ip></code></td><td style=text-align:left>Remove all Redis instances on the specified node</td></tr><tr><td style=text-align:left><strong>Instance</strong></td><td style=text-align:left><code>-l &lt;ip> -e redis_port=&lt;port></code></td><td style=text-align:left>Remove only a single instance on the specified node</td></tr></tbody></table><h3 id=cluster-level-removal>Cluster-Level Removal</h3><p>Remove an entire Redis cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis-rm.yml -l redis-ms        <span style=color:#8f5902;font-style:italic># remove entire redis-ms cluster</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-test      <span style=color:#8f5902;font-style:italic># remove entire redis-test cluster</span>
</span></span></code></pre></div><p>Cluster-level removal will:</p><ul><li>Deregister all instances on all nodes from the monitoring system</li><li>Stop redis_exporter on all nodes</li><li>Stop and disable all Redis instances</li><li>Delete all data directories (if <code>redis_rm_data=true</code>)</li><li>Uninstall packages (if <code>redis_rm_pkg=true</code>)</li></ul><h3 id=node-level-removal>Node-Level Removal</h3><p>Remove only all Redis instances on the specified node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis-rm.yml -l 10.10.10.10     <span style=color:#8f5902;font-style:italic># remove all instances on this node</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.11     <span style=color:#8f5902;font-style:italic># remove another node</span>
</span></span></code></pre></div><p>Node-level removal is useful for:</p><ul><li><strong>Scaling down</strong> by removing an entire node</li><li>Cleanup before node decommission</li><li>Preparation before node migration</li></ul><p>Node-level removal will:</p><ul><li>Deregister all instances on that node from the monitoring system</li><li>Stop redis_exporter on that node</li><li>Stop all Redis instances on that node</li><li>Delete all data directories on that node</li><li>Delete Vector logging config on that node</li></ul><h3 id=instance-level-removal>Instance-Level Removal</h3><p>Use the <code>-e redis_port=&lt;port></code> parameter to remove a single instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove only the 6379 port instance on 10.10.10.10</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.10 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove only the 6380 port instance on 10.10.10.11</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.11 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6380</span>
</span></span></code></pre></div><p>Instance-level removal is useful for:</p><ul><li>Removing a <strong>single replica</strong> from a node</li><li>Removing instances no longer needed</li><li>Removing the original primary after failover</li></ul><p>Behavioral differences when <code>redis_port</code> is specified:</p><table><thead><tr><th style=text-align:left>Component</th><th style=text-align:left>Node-Level (no redis_port)</th><th style=text-align:left>Instance-Level (with redis_port)</th></tr></thead><tbody><tr><td style=text-align:left>Monitoring registration</td><td style=text-align:left>Delete entire node&rsquo;s registration file</td><td style=text-align:left>Only remove that instance from registration file</td></tr><tr><td style=text-align:left>redis_exporter</td><td style=text-align:left>Stop and disable</td><td style=text-align:left><strong>No operation</strong> (other instances still need it)</td></tr><tr><td style=text-align:left>Redis instances</td><td style=text-align:left>Stop all instances</td><td style=text-align:left>Only stop the specified port&rsquo;s instance</td></tr><tr><td style=text-align:left>Data directory</td><td style=text-align:left>Delete entire <code>/data/redis/</code> directory</td><td style=text-align:left>Only delete <code>/data/redis/&lt;cluster>-&lt;node>-&lt;port>/</code></td></tr><tr><td style=text-align:left>Vector config</td><td style=text-align:left>Delete <code>/etc/vector/redis.yaml</code></td><td style=text-align:left><strong>No operation</strong> (other instances still need it)</td></tr><tr><td style=text-align:left>Packages</td><td style=text-align:left>Optionally uninstall</td><td style=text-align:left><strong>No operation</strong></td></tr></tbody></table><h3 id=control-parameters>Control Parameters</h3><p><code>redis-rm.yml</code> provides the following control parameters:</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:left>Default</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>redis_safeguard</code></td><td style=text-align:left><code>false</code></td><td style=text-align:left>Safety guard; when <code>true</code>, refuses to execute removal</td></tr><tr><td style=text-align:left><code>redis_rm_data</code></td><td style=text-align:left><code>true</code></td><td style=text-align:left>Whether to delete data directories (RDB/AOF files)</td></tr><tr><td style=text-align:left><code>redis_rm_pkg</code></td><td style=text-align:left><code>false</code></td><td style=text-align:left>Whether to uninstall Redis packages</td></tr></tbody></table><p>Usage examples:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove cluster but keep data directories</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-ms -e <span style=color:#000>redis_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove cluster and uninstall packages</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-ms -e <span style=color:#000>redis_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Bypass safeguard to force removal</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-ms -e <span style=color:#000>redis_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span></code></pre></div><h3 id=safeguard-mechanism>Safeguard Mechanism</h3><p>When a cluster has <code>redis_safeguard: true</code> configured, <code>redis-rm.yml</code> will refuse to execute:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-production</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_safeguard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># enable protection for production</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./redis-rm.yml -l redis-production
</span></span><span style=display:flex><span>TASK <span style=color:#ce5c00;font-weight:700>[</span>ABORT due to redis_safeguard enabled<span style=color:#ce5c00;font-weight:700>]</span> ***
</span></span><span style=display:flex><span>fatal: <span style=color:#ce5c00;font-weight:700>[</span>10.10.10.10<span style=color:#ce5c00;font-weight:700>]</span>: FAILED! <span style=color:#ce5c00;font-weight:700>=</span>&gt; <span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;msg&#34;</span>: <span style=color:#4e9a06>&#34;Abort due to redis_safeguard...&#34;</span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Explicit override is required to execute:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis-rm.yml -l redis-production -e <span style=color:#000>redis_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span></code></pre></div><hr><h2 id=quick-reference>Quick Reference</h2><h3 id=deployment-quick-reference>Deployment Quick Reference</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Deploy entire cluster</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;cluster&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Scale up: deploy new node</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;new-node-ip&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Scale up: add new instance to existing node (add definition to config first)</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;ip&gt; -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;new-port&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update config and restart</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;cluster&gt; -t redis_config,redis_launch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update single instance config only</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;ip&gt; -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;port&gt; -t redis_config,redis_launch
</span></span></code></pre></div><h3 id=removal-quick-reference>Removal Quick Reference</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove entire cluster</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l &lt;cluster&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Scale down: remove entire node</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l &lt;ip&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Scale down: remove single instance</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l &lt;ip&gt; -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;port&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove but keep data</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l &lt;cluster&gt; -e <span style=color:#000>redis_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Complete cleanup (including packages)</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l &lt;cluster&gt; -e <span style=color:#000>redis_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><h3 id=wrapper-scripts>Wrapper Scripts</h3><p>Pigsty provides convenient wrapper scripts:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Deploy</span>
</span></span><span style=display:flex><span>bin/redis-add &lt;cluster&gt;           <span style=color:#8f5902;font-style:italic># deploy cluster</span>
</span></span><span style=display:flex><span>bin/redis-add &lt;ip&gt;                <span style=color:#8f5902;font-style:italic># deploy node</span>
</span></span><span style=display:flex><span>bin/redis-add &lt;ip&gt; &lt;port&gt;         <span style=color:#8f5902;font-style:italic># deploy instance</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove</span>
</span></span><span style=display:flex><span>bin/redis-rm &lt;cluster&gt;            <span style=color:#8f5902;font-style:italic># remove cluster</span>
</span></span><span style=display:flex><span>bin/redis-rm &lt;ip&gt;                 <span style=color:#8f5902;font-style:italic># remove node</span>
</span></span><span style=display:flex><span>bin/redis-rm &lt;ip&gt; &lt;port&gt;          <span style=color:#8f5902;font-style:italic># remove instance</span>
</span></span></code></pre></div><hr><h2 id=demo>Demo</h2><p>Initialize Redis cluster with Redis playbook:</p><p><a href=https://asciinema.org/a/568808><img src=https://asciinema.org/a/568808.svg alt=asciicast></a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-d30f775631874dbea209c56a3cf88d88>4 - Administration</h1><div class=lead>Redis cluster management SOPs for creating, destroying, scaling, and configuring high availability</div><p>Here are some common Redis administration task SOPs (Standard Operating Procedures):</p><p><strong>Basic Operations</strong></p><ul><li><a href=#initialize-redis>Initialize Redis</a></li><li><a href=#remove-redis>Remove Redis</a></li><li><a href=#reconfigure-redis>Reconfigure Redis</a></li><li><a href=#using-redis-client>Using Redis Client</a></li></ul><p><strong>High Availability</strong></p><ul><li><a href=#configure-redis-replica>Configure Redis Replica</a></li><li><a href=#configure-ha-with-sentinel>Configure HA with Sentinel</a></li><li><a href=#initialize-redis-native-cluster>Initialize Redis Native Cluster</a></li></ul><p><strong>Scaling & Migration</strong></p><ul><li><a href=#scale-up-redis-nodes>Scale Up Redis Nodes</a></li><li><a href=#scale-down-redis-nodes>Scale Down Redis Nodes</a></li><li><a href=#backup-and-restore>Backup and Restore</a></li></ul><p><strong>Troubleshooting</strong></p><ul><li><a href=#common-issue-diagnosis>Common Issue Diagnosis</a></li><li><a href=#performance-tuning>Performance Tuning</a></li></ul><p>For more questions, please refer to <a href=faq>FAQ: REDIS</a>.</p><hr><h3 id=initialize-redis>Initialize Redis</h3><p>You can use the <a href=playbook#redisyml><code>redis.yml</code></a> playbook to initialize Redis clusters, nodes, or instances:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Initialize all Redis instances in the cluster</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;cluster&gt;      <span style=color:#8f5902;font-style:italic># init redis cluster</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Initialize all Redis instances on a specific node</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.10    <span style=color:#8f5902;font-style:italic># init redis node</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Initialize a specific Redis instance: 10.10.10.11:6379</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.11 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span> -t redis
</span></span></code></pre></div><p>You can also use wrapper scripts to initialize:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/redis-add redis-ms          <span style=color:#8f5902;font-style:italic># create redis cluster &#39;redis-ms&#39;</span>
</span></span><span style=display:flex><span>bin/redis-add 10.10.10.10       <span style=color:#8f5902;font-style:italic># create redis node &#39;10.10.10.10&#39;</span>
</span></span><span style=display:flex><span>bin/redis-add 10.10.10.10 <span style=color:#0000cf;font-weight:700>6379</span>  <span style=color:#8f5902;font-style:italic># create redis instance &#39;10.10.10.10:6379&#39;</span>
</span></span></code></pre></div><hr><h3 id=remove-redis>Remove Redis</h3><p>You can use the <a href=playbook#redis-rmyml><code>redis-rm.yml</code></a> playbook to remove Redis clusters, nodes, or instances:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove Redis cluster `redis-test`</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove Redis cluster `redis-test` and uninstall Redis packages</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l redis-test -e <span style=color:#000>redis_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove all instances on Redis node 10.10.10.13</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.13
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove a specific Redis instance 10.10.10.13:6379</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.13 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span>
</span></span></code></pre></div><p>You can also use wrapper scripts to remove Redis clusters/nodes/instances:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/redis-rm redis-ms          <span style=color:#8f5902;font-style:italic># remove redis cluster &#39;redis-ms&#39;</span>
</span></span><span style=display:flex><span>bin/redis-rm 10.10.10.10       <span style=color:#8f5902;font-style:italic># remove redis node &#39;10.10.10.10&#39;</span>
</span></span><span style=display:flex><span>bin/redis-rm 10.10.10.10 <span style=color:#0000cf;font-weight:700>6379</span>  <span style=color:#8f5902;font-style:italic># remove redis instance &#39;10.10.10.10:6379&#39;</span>
</span></span></code></pre></div><hr><h3 id=reconfigure-redis>Reconfigure Redis</h3><p>You can partially run the <a href=playbook#redisyml><code>redis.yml</code></a> playbook to reconfigure Redis clusters, nodes, or instances:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l &lt;cluster&gt; -t redis_config,redis_launch
</span></span></code></pre></div><p>Note that Redis cannot reload configuration online. You must restart Redis using the launch task to make configuration changes take effect.</p><hr><h2 id=using-redis-client>Using Redis Client</h2><p>Access Redis instances with <code>redis-cli</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> <span style=color:#8f5902;font-style:italic># &lt;--- connect with host and port</span>
</span></span><span style=display:flex><span>10.10.10.10:6379&gt; auth redis.ms    <span style=color:#8f5902;font-style:italic># &lt;--- authenticate with password</span>
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>10.10.10.10:6379&gt; <span style=color:#204a87>set</span> a <span style=color:#0000cf;font-weight:700>10</span>         <span style=color:#8f5902;font-style:italic># &lt;--- set a key</span>
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>10.10.10.10:6379&gt; get a            <span style=color:#8f5902;font-style:italic># &lt;--- get the key value</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;10&#34;</span>
</span></span></code></pre></div><p>Redis provides the <code>redis-benchmark</code> tool, which can be used for Redis performance evaluation or to generate load for testing.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis-benchmark -h 10.10.10.13 -p <span style=color:#0000cf;font-weight:700>6379</span>
</span></span></code></pre></div><hr><h3 id=configure-redis-replica>Configure Redis Replica</h3><p><a href=https://redis.io/commands/replicaof/>https://redis.io/commands/replicaof/</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Promote a Redis instance to primary</span>
</span></span><span style=display:flex><span>&gt; REPLICAOF NO ONE
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;OK&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Make a Redis instance a replica of another instance</span>
</span></span><span style=display:flex><span>&gt; REPLICAOF 127.0.0.1 <span style=color:#0000cf;font-weight:700>6799</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;OK&#34;</span>
</span></span></code></pre></div><hr><h3 id=configure-ha-with-sentinel>Configure HA with Sentinel</h3><p>Redis standalone master-slave clusters can be configured for automatic high availability through Redis Sentinel. For detailed information, please refer to the <a href=https://redis.io/docs/management/sentinel/>Sentinel official documentation</a>.</p><p>Using the four-node <a href=/docs/deploy/install#sandbox>sandbox environment</a> as an example, a Redis Sentinel cluster <code>redis-meta</code> can be used to manage multiple standalone Redis master-slave clusters.</p><p>Taking the one-master-one-slave Redis standalone cluster <code>redis-ms</code> as an example, you need to add the target on each Sentinel instance using <code>SENTINEL MONITOR</code> and provide the password using <code>SENTINEL SET</code>, and the high availability is configured.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># For each sentinel, add the redis master to sentinel management: (26379,26380,26381)</span>
</span></span><span style=display:flex><span>$ redis-cli -h 10.10.10.11 -p <span style=color:#0000cf;font-weight:700>26379</span> -a redis.meta
</span></span><span style=display:flex><span>10.10.10.11:26379&gt; SENTINEL MONITOR redis-ms 10.10.10.10 <span style=color:#0000cf;font-weight:700>6379</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>10.10.10.11:26379&gt; SENTINEL SET redis-ms auth-pass redis.ms      <span style=color:#8f5902;font-style:italic># if auth enabled, password needs to be configured</span>
</span></span></code></pre></div><p>If you want to remove a Redis master-slave cluster managed by Sentinel, use <code>SENTINEL REMOVE &lt;name></code>.</p><p>You can use the <a href=/docs/redis/param#redis_sentinel_monitor><code>redis_sentinel_monitor</code></a> parameter defined on the Sentinel cluster to automatically configure the list of masters managed by Sentinel.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis_sentinel_monitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># list of masters to be monitored, port, password, quorum (should be more than 1/2 of sentinels) are optional</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-src, host: 10.10.10.45, port: 6379 ,password: redis.src, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: redis-dst, host: 10.10.10.48, port: 6379 ,password: redis.dst, quorum</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>The <code>redis-ha</code> stage in <code>redis.yml</code> will render <code>/tmp/&lt;cluster>.monitor</code> on each sentinel instance based on this list and execute <code>SENTINEL REMOVE</code> and <code>SENTINEL MONITOR</code> commands sequentially, ensuring the sentinel management state remains consistent with the inventory. If you only want to remove a target without re-adding it, set <code>remove: true</code> on the monitor object, and the playbook will skip re-registration after <code>SENTINEL REMOVE</code>.</p><p>Use the following command to refresh the managed master list on the Redis Sentinel cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l redis-meta -t redis-ha   <span style=color:#8f5902;font-style:italic># replace redis-meta if your Sentinel cluster has a different name</span>
</span></span></code></pre></div><hr><h3 id=initialize-redis-native-cluster>Initialize Redis Native Cluster</h3><p>When <a href=/docs/redis/param#redis_mode><code>redis_mode</code></a> is set to <code>cluster</code>, <code>redis.yml</code> will additionally execute the <code>redis-join</code> stage: it uses <code>redis-cli --cluster create --cluster-yes ... --cluster-replicas {{ redis_cluster_replicas }}</code> in <code>/tmp/&lt;cluster>-join.sh</code> to join all instances into a native cluster.</p><p>This step runs automatically during the first deployment. Subsequently re-running <code>./redis.yml -l &lt;cluster> -t redis-join</code> will regenerate and execute the same command. Since <code>--cluster create</code> is not idempotent, you should only trigger this stage separately when you are sure you need to rebuild the entire native cluster.</p><hr><h3 id=scale-up-redis-nodes>Scale Up Redis Nodes</h3><h4 id=scale-up-standalone-cluster>Scale Up Standalone Cluster</h4><p>When adding new nodes/instances to an existing Redis master-slave cluster, first add the new definition in the inventory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-ms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 1 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>}, 6380</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_node: 2 , redis_instances</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>6379</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>replica_of</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;10.10.10.10 6379&#39;</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># new node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>redis_cluster: redis-ms ,redis_password: &#39;redis.ms&#39; ,redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>64MB }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then deploy only the new node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l 10.10.10.11   <span style=color:#8f5902;font-style:italic># deploy only the new node</span>
</span></span></code></pre></div><h4 id=scale-up-native-cluster>Scale Up Native Cluster</h4><p>Adding new nodes to a Redis native cluster requires additional steps:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Add the new node definition in the inventory</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Deploy the new node</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.14
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Add the new node to the cluster (manual execution)</span>
</span></span><span style=display:flex><span>redis-cli --cluster add-node 10.10.10.14:6379 10.10.10.12:6379
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Reshard slots if needed</span>
</span></span><span style=display:flex><span>redis-cli --cluster reshard 10.10.10.12:6379
</span></span></code></pre></div><h4 id=scale-up-sentinel-cluster>Scale Up Sentinel Cluster</h4><p>To add new instances to a Sentinel cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add new sentinel instances in the inventory, then execute:</span>
</span></span><span style=display:flex><span>./redis.yml -l &lt;sentinel-cluster&gt; -t redis_instance
</span></span></code></pre></div><hr><h3 id=scale-down-redis-nodes>Scale Down Redis Nodes</h3><h4 id=scale-down-standalone-cluster>Scale Down Standalone Cluster</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. If removing a replica, just remove it directly</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.11 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. If removing the primary, first perform a failover</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6380</span> REPLICAOF NO ONE      <span style=color:#8f5902;font-style:italic># promote replica</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> REPLICAOF 10.10.10.10 <span style=color:#0000cf;font-weight:700>6380</span>  <span style=color:#8f5902;font-style:italic># demote original primary</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Then remove the original primary</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.10 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Update the inventory to remove the definition</span>
</span></span></code></pre></div><h4 id=scale-down-native-cluster>Scale Down Native Cluster</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. First migrate data slots</span>
</span></span><span style=display:flex><span>redis-cli --cluster reshard 10.10.10.12:6379 <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span>  --cluster-from &lt;node-id&gt; --cluster-to &lt;target-node-id&gt; --cluster-slots &lt;count&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Remove node from cluster</span>
</span></span><span style=display:flex><span>redis-cli --cluster del-node 10.10.10.12:6379 &lt;node-id&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Remove the instance</span>
</span></span><span style=display:flex><span>./redis-rm.yml -l 10.10.10.14
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Update the inventory</span>
</span></span></code></pre></div><hr><h3 id=backup-and-restore>Backup and Restore</h3><h4 id=manual-backup>Manual Backup</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Trigger RDB snapshot</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> -a &lt;password&gt; BGSAVE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check snapshot status</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> -a &lt;password&gt; LASTSAVE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Copy RDB file (default location)</span>
</span></span><span style=display:flex><span>cp /data/redis/redis-ms-1-6379/dump.rdb /backup/redis-ms-<span style=color:#204a87;font-weight:700>$(</span>date +%Y%m%d<span style=color:#204a87;font-weight:700>)</span>.rdb
</span></span></code></pre></div><h4 id=data-restore>Data Restore</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Stop Redis instance</span>
</span></span><span style=display:flex><span>sudo systemctl stop redis-ms-1-6379
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Replace RDB file</span>
</span></span><span style=display:flex><span>cp /backup/redis-ms-20241231.rdb /data/redis/redis-ms-1-6379/dump.rdb
</span></span><span style=display:flex><span>chown redis:redis /data/redis/redis-ms-1-6379/dump.rdb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Start Redis instance</span>
</span></span><span style=display:flex><span>sudo systemctl start redis-ms-1-6379
</span></span></code></pre></div><h4 id=using-aof-persistence>Using AOF Persistence</h4><p>If you need higher data safety, enable AOF:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-ms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;900 1&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;300 10&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;60 10000&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># keep RDB as well</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Redeploy to apply AOF configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./redis.yml -l redis-ms -t redis_config,redis_launch
</span></span></code></pre></div><hr><h3 id=common-issue-diagnosis>Common Issue Diagnosis</h3><h4 id=connection-troubleshooting>Connection Troubleshooting</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Redis service status</span>
</span></span><span style=display:flex><span>systemctl status redis-ms-1-6379
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check port listening</span>
</span></span><span style=display:flex><span>ss -tlnp <span style=color:#000;font-weight:700>|</span> grep <span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check firewall</span>
</span></span><span style=display:flex><span>sudo iptables -L -n <span style=color:#000;font-weight:700>|</span> grep <span style=color:#0000cf;font-weight:700>6379</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Test connection</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> PING
</span></span></code></pre></div><h4 id=memory-troubleshooting>Memory Troubleshooting</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check memory usage</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> INFO memory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Find big keys</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> --bigkeys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Memory analysis report</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> MEMORY DOCTOR
</span></span></code></pre></div><h4 id=performance-troubleshooting>Performance Troubleshooting</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check slow query log</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> SLOWLOG GET <span style=color:#0000cf;font-weight:700>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Real-time command monitoring</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> MONITOR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check client connections</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> CLIENT LIST
</span></span></code></pre></div><h4 id=replication-troubleshooting>Replication Troubleshooting</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check replication status</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6379</span> INFO replication
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check replication lag</span>
</span></span><span style=display:flex><span>redis-cli -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>6380</span> INFO replication <span style=color:#000;font-weight:700>|</span> grep lag
</span></span></code></pre></div><hr><h3 id=performance-tuning>Performance Tuning</h3><h4 id=memory-optimization>Memory Optimization</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-cache</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_max_memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>4GB          </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># set based on available memory</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_mem_policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>allkeys-lru  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># LRU recommended for cache scenarios</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_conf</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis.conf</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h4 id=persistence-optimization>Persistence Optimization</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Pure cache scenario: disable persistence</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-cache</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8>              </span><span style=color:#8f5902;font-style:italic># disable RDB</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic># disable AOF</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Data safety scenario: enable both RDB and AOF</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>redis-data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_rdb_save</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;900 1&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;300 10&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;60 10000&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>redis_aof_enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h4 id=connection-pool-recommendations>Connection Pool Recommendations</h4><p>When connecting to Redis from client applications:</p><ul><li>Use connection pooling to avoid frequent connection creation</li><li>Set reasonable timeout values (recommended 1-3 seconds)</li><li>Enable TCP keepalive</li><li>For high-concurrency scenarios, consider using Pipeline for batch operations</li></ul><h4 id=key-monitoring-metrics>Key Monitoring Metrics</h4><p>Monitor these metrics through Grafana dashboards:</p><ul><li><strong>Memory usage</strong>: Pay attention when <code>redis:ins:mem_usage</code> > 80%</li><li><strong>CPU usage</strong>: Pay attention when <code>redis:ins:cpu_usage</code> > 70%</li><li><strong>QPS</strong>: Watch for spikes and abnormal fluctuations</li><li><strong>Response time</strong>: Investigate when <code>redis:ins:rt</code> > 1ms</li><li><strong>Connection count</strong>: Monitor connection growth trends</li><li><strong>Replication lag</strong>: Important for master-slave replication scenarios</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-81482490a3974d936d1dca668f5c2d09>5 - Monitoring</h1><div class=lead>How to monitor Redis? What alert rules are worth paying attention to?</div><hr><h2 id=dashboards>Dashboards</h2><p>The REDIS module provides 3 monitoring dashboards:</p><ul><li>Redis Overview: Overview of all Redis clusters</li><li>Redis Cluster: Details of a single Redis cluster</li><li>Redis Instance: Details of a single Redis instance</li></ul><hr><h2 id=monitoring>Monitoring</h2><p>Pigsty provides three monitoring dashboards for the <a href=/docs/redis><code>REDIS</code></a> module:</p><hr><h3 id=redis-overview>Redis Overview</h3><p><a href=https://demo.pigsty.io/d/redis-overview>Redis Overview</a>: Overview of all Redis clusters/instances</p><p><a href=https://demo.pigsty.io/d/redis-overview><img src=/img/dashboard/redis-overview.jpg alt=redis-overview.jpg></a></p><hr><h3 id=redis-cluster>Redis Cluster</h3><p><a href=https://demo.pigsty.io/d/redis-cluster>Redis Cluster</a>: Details of a single Redis cluster</p><details><summary>Redis Cluster Dashboard</summary><p><a href=https://demo.pigsty.io/d/redis-cluster><img src=/img/dashboard/redis-cluster.jpg alt=redis-cluster.jpg></a></p></details><br><hr><h3 id=redis-instance>Redis Instance</h3><p><a href=https://demo.pigsty.io/d/redis-instance>Redis Instance</a>: Details of a single Redis instance</p><details><summary>Redis Instance Dashboard</summary><p><a href=https://demo.pigsty.io/d/redis-instance><img src=/img/dashboard/redis-instance.jpg alt=redis-instance></a></p></details><br><hr><h2 id=alert-rules>Alert Rules</h2><p>Pigsty provides the following six predefined alert rules for Redis, defined in <a href=https://github.com/pgsty/pigsty/blob/main/files/victoria/rules/redis.yml><code>files/victoria/rules/redis.yml</code></a>:</p><ul><li><code>RedisDown</code>: Redis instance is down</li><li><code>RedisRejectConn</code>: Redis instance rejecting connections</li><li><code>RedisRTHigh</code>: Redis instance response time is too high</li><li><code>RedisCPUHigh</code>: Redis instance CPU usage is too high</li><li><code>RedisMemHigh</code>: Redis instance memory usage is too high</li><li><code>RedisQPSHigh</code>: Redis instance QPS is too high</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                         Error                                #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis down triggers a P0 alert</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisDown</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis_up &lt; 1</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 0, severity: CRIT, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CRIT RedisDown: {{ $labels.ins }} {{ $labels.instance }} {{ $value }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      redis_up[ins={{ $labels.ins }}, instance={{ $labels.instance }}] = {{ $value }} == 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-5m&amp;to=now&amp;var-ins={{$labels.ins}}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis reject connection in last 5m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisRejectConn</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis:ins:conn_reject &gt; 0</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 0, severity: CRIT, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;CRIT RedisRejectConn: {{ $labels.ins }} {{ $labels.instance }} {{ $value }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      redis:ins:conn_reject[cls={{ $labels.cls }}, ins={{ $labels.ins }}][5m] = {{ $value }} &gt; 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-10m&amp;to=now&amp;viewPanel=88&amp;fullscreen&amp;var-ins={{ $labels.ins }}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                         Latency                              #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis avg query response time &gt; 160 µs</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisRTHigh</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis:ins:rt &gt; 0.00016</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 1, severity: WARN, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;WARN RedisRTHigh: {{ $labels.cls }} {{ $labels.ins }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      pg:ins:query_rt[cls={{ $labels.cls }}, ins={{ $labels.ins }}] = {{ $value }} &gt; 160µs
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-10m&amp;to=now&amp;viewPanel=97&amp;fullscreen&amp;var-ins={{ $labels.ins }}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                        Saturation                            #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis cpu usage more than 70% for 1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisCPUHigh</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis:ins:cpu_usage &gt; 0.70</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 1, severity: WARN, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;WARN RedisCPUHigh: {{ $labels.cls }} {{ $labels.ins }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      redis:ins:cpu_all[cls={{ $labels.cls }}, ins={{ $labels.ins }}] = {{ $value }} &gt; 60%
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-10m&amp;to=now&amp;viewPanel=43&amp;fullscreen&amp;var-ins={{ $labels.ins }}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis mem usage more than 70% for 1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisMemHigh</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis:ins:mem_usage &gt; 0.70</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>1m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 1, severity: WARN, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;WARN RedisMemHigh: {{ $labels.cls }} {{ $labels.ins }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      redis:ins:mem_usage[cls={{ $labels.cls }}, ins={{ $labels.ins }}] = {{ $value }} &gt; 80%
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-10m&amp;to=now&amp;viewPanel=7&amp;fullscreen&amp;var-ins={{ $labels.ins }}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#                         Traffic                              #</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># redis qps more than 32000 for 5m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>RedisQPSHigh</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis:ins:qps &gt; 32000</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>5m</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>level: 2, severity: INFO, category</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>redis }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;INFO RedisQPSHigh: {{ $labels.cls }} {{ $labels.ins }}&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      redis:ins:qps[cls={{ $labels.cls }}, ins={{ $labels.ins }}] = {{ $value }} &gt; 16000
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      http://g.pigsty/d/redis-instance?from=now-10m&amp;to=now&amp;viewPanel=96&amp;fullscreen&amp;var-ins={{ $labels.ins }}</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-5bcac294a078899a139a79dc1fb2b009>6 - Metrics</h1><div class=lead>Complete list of monitoring metrics provided by the Pigsty REDIS module with explanations</div><p>The <a href=/docs/redis><strong><code>REDIS</code></strong></a> module contains 275 available monitoring metrics.</p><table><thead><tr><th>Metric Name</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td>ALERTS</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>level</code>, <code>severity</code>, <code>instance</code>, <code>category</code>, <code>ins</code>, <code>alertname</code>, <code>job</code>, <code>alertstate</code></td><td>N/A</td></tr><tr><td>ALERTS_FOR_STATE</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>level</code>, <code>severity</code>, <code>instance</code>, <code>category</code>, <code>ins</code>, <code>alertname</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:aof_rewrite_time</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:blocked_clients</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:clients</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cmd_qps</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cmd_rt</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cmd_time</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:conn_rate</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:conn_reject</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_sys</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_sys_child</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_usage</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_usage_child</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_user</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:cpu_user_child</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:fork_time</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:key_evict</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:key_expire</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:key_hit</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:key_hit_rate</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:key_miss</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:mem_max</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:mem_usage</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:mem_usage_max</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:mem_used</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:net_traffic</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:qps</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:qps_mu</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:qps_realtime</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:qps_sigma</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:rt</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:rt_mu</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:rt_sigma</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:rx</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:size</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:cls:tx</td><td>Unknown</td><td><code>cls</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:env:blocked_clients</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:clients</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:cmd_qps</td><td>Unknown</td><td><code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:env:cmd_rt</td><td>Unknown</td><td><code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:env:cmd_time</td><td>Unknown</td><td><code>cmd</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:env:conn_rate</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:conn_reject</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:cpu_usage</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:cpu_usage_child</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:key_evict</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:key_expire</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:key_hit</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:key_hit_rate</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:key_miss</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:mem_usage</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:net_traffic</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:qps</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:qps_mu</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:qps_realtime</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:qps_sigma</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:rt</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:rt_mu</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:rt_sigma</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:rx</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:env:tx</td><td>Unknown</td><td><code>job</code></td><td>N/A</td></tr><tr><td>redis:ins</td><td>Unknown</td><td><code>cls</code>, <code>id</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:blocked_clients</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:clients</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cmd_qps</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cmd_rt</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cmd_time</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:conn_rate</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:conn_reject</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_sys</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_sys_child</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_usage</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_usage_child</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_user</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:cpu_user_child</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:key_evict</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:key_expire</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:key_hit</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:key_hit_rate</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:key_miss</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:lsn_rate</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:mem_usage</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:net_traffic</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:qps</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:qps_mu</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:qps_realtime</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:qps_sigma</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:rt</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:rt_mu</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:rt_sigma</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:rx</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:ins:tx</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:node:ip</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:node:mem_alloc</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:node:mem_total</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:node:mem_used</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis:node:qps</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_active_defrag_running</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>active_defrag_running metric</td></tr><tr><td>redis_allocator_active_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_active_bytes metric</td></tr><tr><td>redis_allocator_allocated_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_allocated_bytes metric</td></tr><tr><td>redis_allocator_frag_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_frag_bytes metric</td></tr><tr><td>redis_allocator_frag_ratio</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_frag_ratio metric</td></tr><tr><td>redis_allocator_resident_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_resident_bytes metric</td></tr><tr><td>redis_allocator_rss_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_rss_bytes metric</td></tr><tr><td>redis_allocator_rss_ratio</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>allocator_rss_ratio metric</td></tr><tr><td>redis_aof_current_rewrite_duration_sec</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_current_rewrite_duration_sec metric</td></tr><tr><td>redis_aof_enabled</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_enabled metric</td></tr><tr><td>redis_aof_last_bgrewrite_status</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_last_bgrewrite_status metric</td></tr><tr><td>redis_aof_last_cow_size_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_last_cow_size_bytes metric</td></tr><tr><td>redis_aof_last_rewrite_duration_sec</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_last_rewrite_duration_sec metric</td></tr><tr><td>redis_aof_last_write_status</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_last_write_status metric</td></tr><tr><td>redis_aof_rewrite_in_progress</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_rewrite_in_progress metric</td></tr><tr><td>redis_aof_rewrite_scheduled</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>aof_rewrite_scheduled metric</td></tr><tr><td>redis_blocked_clients</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>blocked_clients metric</td></tr><tr><td>redis_client_recent_max_input_buffer_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>client_recent_max_input_buffer_bytes metric</td></tr><tr><td>redis_client_recent_max_output_buffer_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>client_recent_max_output_buffer_bytes metric</td></tr><tr><td>redis_clients_in_timeout_table</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>clients_in_timeout_table metric</td></tr><tr><td>redis_cluster_connections</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_connections metric</td></tr><tr><td>redis_cluster_current_epoch</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_current_epoch metric</td></tr><tr><td>redis_cluster_enabled</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_enabled metric</td></tr><tr><td>redis_cluster_known_nodes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_known_nodes metric</td></tr><tr><td>redis_cluster_messages_received_total</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_messages_received_total metric</td></tr><tr><td>redis_cluster_messages_sent_total</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_messages_sent_total metric</td></tr><tr><td>redis_cluster_my_epoch</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_my_epoch metric</td></tr><tr><td>redis_cluster_size</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_size metric</td></tr><tr><td>redis_cluster_slots_assigned</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_slots_assigned metric</td></tr><tr><td>redis_cluster_slots_fail</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_slots_fail metric</td></tr><tr><td>redis_cluster_slots_ok</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_slots_ok metric</td></tr><tr><td>redis_cluster_slots_pfail</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_slots_pfail metric</td></tr><tr><td>redis_cluster_state</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_state metric</td></tr><tr><td>redis_cluster_stats_messages_meet_received</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_meet_received metric</td></tr><tr><td>redis_cluster_stats_messages_meet_sent</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_meet_sent metric</td></tr><tr><td>redis_cluster_stats_messages_ping_received</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_ping_received metric</td></tr><tr><td>redis_cluster_stats_messages_ping_sent</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_ping_sent metric</td></tr><tr><td>redis_cluster_stats_messages_pong_received</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_pong_received metric</td></tr><tr><td>redis_cluster_stats_messages_pong_sent</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cluster_stats_messages_pong_sent metric</td></tr><tr><td>redis_commands_duration_seconds_total</td><td>counter</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total amount of time in seconds spent per command</td></tr><tr><td>redis_commands_failed_calls_total</td><td>counter</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total number of errors prior command execution per command</td></tr><tr><td>redis_commands_latencies_usec_bucket</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>le</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_commands_latencies_usec_count</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_commands_latencies_usec_sum</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_commands_processed_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>commands_processed_total metric</td></tr><tr><td>redis_commands_rejected_calls_total</td><td>counter</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total number of errors within command execution per command</td></tr><tr><td>redis_commands_total</td><td>counter</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total number of calls per command</td></tr><tr><td>redis_config_io_threads</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>config_io_threads metric</td></tr><tr><td>redis_config_maxclients</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>config_maxclients metric</td></tr><tr><td>redis_config_maxmemory</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>config_maxmemory metric</td></tr><tr><td>redis_connected_clients</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>connected_clients metric</td></tr><tr><td>redis_connected_slave_lag_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>slave_ip</code>, <code>instance</code>, <code>slave_state</code>, <code>ins</code>, <code>slave_port</code>, <code>job</code></td><td>Lag of connected slave</td></tr><tr><td>redis_connected_slave_offset_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>slave_ip</code>, <code>instance</code>, <code>slave_state</code>, <code>ins</code>, <code>slave_port</code>, <code>job</code></td><td>Offset of connected slave</td></tr><tr><td>redis_connected_slaves</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>connected_slaves metric</td></tr><tr><td>redis_connections_received_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>connections_received_total metric</td></tr><tr><td>redis_cpu_sys_children_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_sys_children_seconds_total metric</td></tr><tr><td>redis_cpu_sys_main_thread_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_sys_main_thread_seconds_total metric</td></tr><tr><td>redis_cpu_sys_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_sys_seconds_total metric</td></tr><tr><td>redis_cpu_user_children_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_user_children_seconds_total metric</td></tr><tr><td>redis_cpu_user_main_thread_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_user_main_thread_seconds_total metric</td></tr><tr><td>redis_cpu_user_seconds_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>cpu_user_seconds_total metric</td></tr><tr><td>redis_db_keys</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>db</code>, <code>job</code></td><td>Total number of keys by DB</td></tr><tr><td>redis_db_keys_expiring</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>db</code>, <code>job</code></td><td>Total number of expiring keys by DB</td></tr><tr><td>redis_defrag_hits</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>defrag_hits metric</td></tr><tr><td>redis_defrag_key_hits</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>defrag_key_hits metric</td></tr><tr><td>redis_defrag_key_misses</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>defrag_key_misses metric</td></tr><tr><td>redis_defrag_misses</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>defrag_misses metric</td></tr><tr><td>redis_dump_payload_sanitizations</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>dump_payload_sanitizations metric</td></tr><tr><td>redis_errors_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>err</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total number of errors per error type</td></tr><tr><td>redis_evicted_keys_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>evicted_keys_total metric</td></tr><tr><td>redis_expired_keys_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>expired_keys_total metric</td></tr><tr><td>redis_expired_stale_percentage</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>expired_stale_percentage metric</td></tr><tr><td>redis_expired_time_cap_reached_total</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>expired_time_cap_reached_total metric</td></tr><tr><td>redis_exporter_build_info</td><td>gauge</td><td><code>cls</code>, <code>golang_version</code>, <code>ip</code>, <code>commit_sha</code>, <code>instance</code>, <code>version</code>, <code>ins</code>, <code>job</code>, <code>build_date</code></td><td>redis exporter build_info</td></tr><tr><td>redis_exporter_last_scrape_connect_time_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>exporter_last_scrape_connect_time_seconds metric</td></tr><tr><td>redis_exporter_last_scrape_duration_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>exporter_last_scrape_duration_seconds metric</td></tr><tr><td>redis_exporter_last_scrape_error</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>The last scrape error status.</td></tr><tr><td>redis_exporter_scrape_duration_seconds_count</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_exporter_scrape_duration_seconds_sum</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_exporter_scrapes_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Current total redis scrapes.</td></tr><tr><td>redis_instance_info</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>os</code>, <code>role</code>, <code>instance</code>, <code>run_id</code>, <code>redis_version</code>, <code>tcp_port</code>, <code>process_id</code>, <code>ins</code>, <code>redis_mode</code>, <code>maxmemory_policy</code>, <code>redis_build_id</code>, <code>job</code></td><td>Information about the Redis instance</td></tr><tr><td>redis_io_threaded_reads_processed</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>io_threaded_reads_processed metric</td></tr><tr><td>redis_io_threaded_writes_processed</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>io_threaded_writes_processed metric</td></tr><tr><td>redis_io_threads_active</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>io_threads_active metric</td></tr><tr><td>redis_keyspace_hits_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>keyspace_hits_total metric</td></tr><tr><td>redis_keyspace_misses_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>keyspace_misses_total metric</td></tr><tr><td>redis_last_key_groups_scrape_duration_milliseconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Duration of the last key group metrics scrape in milliseconds</td></tr><tr><td>redis_last_slow_execution_duration_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>The amount of time needed for last slow execution, in seconds</td></tr><tr><td>redis_latency_percentiles_usec</td><td>summary</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>quantile</code>, <code>ins</code>, <code>job</code></td><td>A summary of latency percentile distribution per command</td></tr><tr><td>redis_latency_percentiles_usec_count</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_latency_percentiles_usec_sum</td><td>Unknown</td><td><code>cls</code>, <code>cmd</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>redis_latest_fork_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>latest_fork_seconds metric</td></tr><tr><td>redis_lazyfree_pending_objects</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>lazyfree_pending_objects metric</td></tr><tr><td>redis_loading_dump_file</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>loading_dump_file metric</td></tr><tr><td>redis_master_last_io_seconds_ago</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_host</code>, <code>instance</code>, <code>ins</code>, <code>job</code>, <code>master_port</code></td><td>Master last io seconds ago</td></tr><tr><td>redis_master_link_up</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_host</code>, <code>instance</code>, <code>ins</code>, <code>job</code>, <code>master_port</code></td><td>Master link status on Redis slave</td></tr><tr><td>redis_master_repl_offset</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>master_repl_offset metric</td></tr><tr><td>redis_master_sync_in_progress</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_host</code>, <code>instance</code>, <code>ins</code>, <code>job</code>, <code>master_port</code></td><td>Master sync in progress</td></tr><tr><td>redis_mem_clients_normal</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>mem_clients_normal metric</td></tr><tr><td>redis_mem_clients_slaves</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>mem_clients_slaves metric</td></tr><tr><td>redis_mem_fragmentation_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>mem_fragmentation_bytes metric</td></tr><tr><td>redis_mem_fragmentation_ratio</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>mem_fragmentation_ratio metric</td></tr><tr><td>redis_mem_not_counted_for_eviction_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>mem_not_counted_for_eviction_bytes metric</td></tr><tr><td>redis_memory_max_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_max_bytes metric</td></tr><tr><td>redis_memory_used_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_bytes metric</td></tr><tr><td>redis_memory_used_dataset_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_dataset_bytes metric</td></tr><tr><td>redis_memory_used_lua_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_lua_bytes metric</td></tr><tr><td>redis_memory_used_overhead_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_overhead_bytes metric</td></tr><tr><td>redis_memory_used_peak_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_peak_bytes metric</td></tr><tr><td>redis_memory_used_rss_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_rss_bytes metric</td></tr><tr><td>redis_memory_used_scripts_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_scripts_bytes metric</td></tr><tr><td>redis_memory_used_startup_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>memory_used_startup_bytes metric</td></tr><tr><td>redis_migrate_cached_sockets_total</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>migrate_cached_sockets_total metric</td></tr><tr><td>redis_module_fork_in_progress</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>module_fork_in_progress metric</td></tr><tr><td>redis_module_fork_last_cow_size</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>module_fork_last_cow_size metric</td></tr><tr><td>redis_net_input_bytes_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>net_input_bytes_total metric</td></tr><tr><td>redis_net_output_bytes_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>net_output_bytes_total metric</td></tr><tr><td>redis_number_of_cached_scripts</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>number_of_cached_scripts metric</td></tr><tr><td>redis_process_id</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>process_id metric</td></tr><tr><td>redis_pubsub_channels</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>pubsub_channels metric</td></tr><tr><td>redis_pubsub_patterns</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>pubsub_patterns metric</td></tr><tr><td>redis_pubsubshard_channels</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>pubsubshard_channels metric</td></tr><tr><td>redis_rdb_bgsave_in_progress</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_bgsave_in_progress metric</td></tr><tr><td>redis_rdb_changes_since_last_save</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_changes_since_last_save metric</td></tr><tr><td>redis_rdb_current_bgsave_duration_sec</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_current_bgsave_duration_sec metric</td></tr><tr><td>redis_rdb_last_bgsave_duration_sec</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_last_bgsave_duration_sec metric</td></tr><tr><td>redis_rdb_last_bgsave_status</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_last_bgsave_status metric</td></tr><tr><td>redis_rdb_last_cow_size_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_last_cow_size_bytes metric</td></tr><tr><td>redis_rdb_last_save_timestamp_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rdb_last_save_timestamp_seconds metric</td></tr><tr><td>redis_rejected_connections_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>rejected_connections_total metric</td></tr><tr><td>redis_repl_backlog_first_byte_offset</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>repl_backlog_first_byte_offset metric</td></tr><tr><td>redis_repl_backlog_history_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>repl_backlog_history_bytes metric</td></tr><tr><td>redis_repl_backlog_is_active</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>repl_backlog_is_active metric</td></tr><tr><td>redis_replica_partial_resync_accepted</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>replica_partial_resync_accepted metric</td></tr><tr><td>redis_replica_partial_resync_denied</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>replica_partial_resync_denied metric</td></tr><tr><td>redis_replica_resyncs_full</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>replica_resyncs_full metric</td></tr><tr><td>redis_replication_backlog_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>replication_backlog_bytes metric</td></tr><tr><td>redis_second_repl_offset</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>second_repl_offset metric</td></tr><tr><td>redis_sentinel_master_ckquorum_status</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>message</code>, <code>instance</code>, <code>ins</code>, <code>master_name</code>, <code>job</code></td><td>Master ckquorum status</td></tr><tr><td>redis_sentinel_master_ok_sentinels</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>The number of okay sentinels monitoring this master</td></tr><tr><td>redis_sentinel_master_ok_slaves</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>The number of okay slaves of the master</td></tr><tr><td>redis_sentinel_master_sentinels</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>The number of sentinels monitoring this master</td></tr><tr><td>redis_sentinel_master_setting_ckquorum</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>Show the current ckquorum config for each master</td></tr><tr><td>redis_sentinel_master_setting_down_after_milliseconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>Show the current down-after-milliseconds config for each master</td></tr><tr><td>redis_sentinel_master_setting_failover_timeout</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>Show the current failover-timeout config for each master</td></tr><tr><td>redis_sentinel_master_setting_parallel_syncs</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>Show the current parallel-syncs config for each master</td></tr><tr><td>redis_sentinel_master_slaves</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>The number of slaves of the master</td></tr><tr><td>redis_sentinel_master_status</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_status</code>, <code>instance</code>, <code>ins</code>, <code>master_address</code>, <code>master_name</code>, <code>job</code></td><td>Master status on Sentinel</td></tr><tr><td>redis_sentinel_masters</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>The number of masters this sentinel is watching</td></tr><tr><td>redis_sentinel_running_scripts</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Number of scripts in execution right now</td></tr><tr><td>redis_sentinel_scripts_queue_length</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Queue of user scripts to execute</td></tr><tr><td>redis_sentinel_simulate_failure_flags</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Failures simulations</td></tr><tr><td>redis_sentinel_tilt</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Sentinel is in TILT mode</td></tr><tr><td>redis_slave_expires_tracked_keys</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>slave_expires_tracked_keys metric</td></tr><tr><td>redis_slave_info</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_host</code>, <code>instance</code>, <code>read_only</code>, <code>ins</code>, <code>job</code>, <code>master_port</code></td><td>Information about the Redis slave</td></tr><tr><td>redis_slave_priority</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>slave_priority metric</td></tr><tr><td>redis_slave_repl_offset</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>master_host</code>, <code>instance</code>, <code>ins</code>, <code>job</code>, <code>master_port</code></td><td>Slave replication offset</td></tr><tr><td>redis_slowlog_last_id</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Last id of slowlog</td></tr><tr><td>redis_slowlog_length</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Total slowlog</td></tr><tr><td>redis_start_time_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Start time of the Redis instance since unix epoch in seconds.</td></tr><tr><td>redis_target_scrape_request_errors_total</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Errors in requests to the exporter</td></tr><tr><td>redis_total_error_replies</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>total_error_replies metric</td></tr><tr><td>redis_total_reads_processed</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>total_reads_processed metric</td></tr><tr><td>redis_total_system_memory_bytes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>total_system_memory_bytes metric</td></tr><tr><td>redis_total_writes_processed</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>total_writes_processed metric</td></tr><tr><td>redis_tracking_clients</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>tracking_clients metric</td></tr><tr><td>redis_tracking_total_items</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>tracking_total_items metric</td></tr><tr><td>redis_tracking_total_keys</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>tracking_total_keys metric</td></tr><tr><td>redis_tracking_total_prefixes</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>tracking_total_prefixes metric</td></tr><tr><td>redis_unexpected_error_replies</td><td>counter</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>unexpected_error_replies metric</td></tr><tr><td>redis_up</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>Information about the Redis instance</td></tr><tr><td>redis_uptime_in_seconds</td><td>gauge</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>uptime_in_seconds metric</td></tr><tr><td>scrape_duration_seconds</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>scrape_samples_post_metric_relabeling</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>scrape_samples_scraped</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>scrape_series_added</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr><tr><td>up</td><td>Unknown</td><td><code>cls</code>, <code>ip</code>, <code>instance</code>, <code>ins</code>, <code>job</code></td><td>N/A</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-b2e89e0d2e5fa7361edacff6f86e00ea>7 - FAQ</h1><div class=lead>Frequently asked questions about the Pigsty REDIS module</div><hr><h2 id=abort-due-to-redis_safeguard-enabled>ABORT due to redis_safeguard enabled</h2><p>This means the Redis instance you are trying to remove has the safeguard enabled: this happens when attempting to remove a Redis instance with <a href=/docs/redis/param#redis_safeguard><code>redis_safeguard</code></a> set to <code>true</code>. The <code>redis-rm.yml</code> playbook refuses to execute to prevent accidental deletion of running Redis instances.</p><p>You can override this protection with the CLI argument <code>-e redis_safeguard=false</code> to force removal of the Redis instance. This is what <code>redis_safeguard</code> is designed for.</p><hr><h2 id=how-to-add-a-new-redis-instance-on-a-node>How to add a new Redis instance on a node?</h2><p>Use <code>bin/redis-add &lt;ip> &lt;port></code> to deploy a new Redis instance on the node.</p><hr><h2 id=how-to-remove-a-specific-instance-from-a-node>How to remove a specific instance from a node?</h2><p>Use <code>bin/redis-rm &lt;ip> &lt;port></code> to remove a single Redis instance from the node.</p><hr><h2 id=are-there-plans-to-upgrade-to-valkey-or-the-latest-version>Are there plans to upgrade to Valkey or the latest version?</h2><p>Since Redis is not a core component of this project, there are currently no plans to update to the latest Redis RSAL / AGPLv3 version or Valkey.
The Redis version in Pigsty is locked to 7.2.6, the last version using the BSD license.</p><p>This version has been validated in large-scale production environments, and Pigsty no longer has such scenarios to re-validate the stability and reliability of newer versions.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email - Vonng" aria-label="Email - Vonng"><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label="Email - Vonng"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=WeChat aria-label=WeChat><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=WeChat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=Discussion><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Repo aria-label=Repo><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=Repo><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
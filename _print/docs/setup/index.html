<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><link rel=canonical type=text/html href=https://pigsty.io/docs/setup/><link rel=alternate type=application/rss+xml href=https://pigsty.io/docs/setup/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Get Started | PIGSTY</title><meta name=description content="Deploy Pigsty single-node version on your laptop/cloud server, access DB and Web UI"><meta property="og:url" content="https://pigsty.io/docs/setup/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="Get Started"><meta property="og:description" content="Deploy Pigsty single-node version on your laptop/cloud server, access DB and Web UI"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Get Started"><meta itemprop=description content="Deploy Pigsty single-node version on your laptop/cloud server, access DB and Web UI"><meta itemprop=dateModified content="2026-01-15T00:52:33+08:00"><meta itemprop=wordCount content="309"><meta itemprop=keywords content="Tutorial,PIGSTY"><meta name=twitter:card content="summary"><meta name=twitter:title content="Get Started"><meta name=twitter:description content="Deploy Pigsty single-node version on your laptop/cloud server, access DB and Web UI"><link rel=preload href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css as=style integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><link href=/scss/main.min.f6da858eb22dc48110abb983f095554930a5a614c30190b4e32ee7b08a496331.css rel=stylesheet integrity="sha256-9tqFjrItxIEQq7mD8JVVSTClphTDAZC04y7nsIpJYzE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Ver</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.cc>Pigsty 中文网站</a></li><li><a class=dropdown-item href=https://doc.pgsty.com>Pigsty v3.7 Doc</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc>Pigsty v3.4 Doc</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 Doc</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 Doc</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch Language / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d757e151050fd40088751a74721d74f6.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:window.location.href="https://pigsty.cc"+e}</script></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/setup/>Return to the regular view of this page</a>.</p></div><h1 class=title>Get Started</h1><div class=lead>Deploy Pigsty single-node version on your laptop/cloud server, access DB and Web UI</div><ul><li>1: <a href=#pg-feb220ce98138be93707bc30fc029cd1>Single-Node Installation</a></li><li>2: <a href=#pg-fcae07fc2570b34306c20c69a4aab512>Web Interface</a></li><li>3: <a href=#pg-b74607462cd5472ff13684ffc71d526f>Getting Started with PostgreSQL</a></li><li>4: <a href=#pg-d96b1765e9d967725a0824edd07fe95d>Customize Pigsty with Configuration</a></li><li>5: <a href=#pg-98758ad7ef56ab0b1a9ad8320b14506b>Run Playbooks with Ansible</a></li><li>6: <a href=#pg-01b2a33b37e8e7124df9aa116794fa36>Offline Installation</a></li><li>7: <a href=#pg-c38b3e7bce8cb65ffd26ccafa496eb5e>Slim Installation</a></li><li>8: <a href=#pg-d6a656f7f8306b7de558a78bf1164ae0>Security Tips</a></li></ul><div class=content><p>Pigsty uses a scalable architecture design, suitable for both <a href=/docs/deploy><strong>large-scale production environments</strong></a> and <a href=/docs/setup/install><strong>single-node development/demo environments</strong></a>. This guide focuses on the latter.</p><p>If you intend to learn about Pigsty, you can start with the <a href=/docs/setup/install/><strong>Quick Start</strong></a> single-node deployment. A Linux virtual machine with 1C/2G is sufficient to run Pigsty.</p><p>You can use a Linux MiniPC, free/discounted virtual machines provided by cloud providers, Windows WSL, or create a virtual machine on your own laptop for Pigsty deployment.
Pigsty provides out-of-the-box <a href=/docs/deploy/vagrant/><strong>Vagrant</strong></a> templates and <a href=/docs/deploy/terraform/><strong>Terraform</strong></a> templates to help you provision Linux VMs with one click locally or in the cloud.</p><p><a href=/docs/concept/arch><img src=/img/pigsty/arch.png alt=pigsty-arch></a></p><p>The single-node version of Pigsty includes all core features: <strong>440+</strong> <a href=/docs/pgsql/ext><strong>PG extensions</strong></a>, self-contained Grafana/Victoria monitoring, <a href=/docs/concept/iac><strong>IaC</strong></a> provisioning capabilities,
and local <a href=/docs/concept/pitr><strong>PITR</strong></a> point-in-time recovery. If you have external object storage (for PostgreSQL PITR backup), then for scenarios like demos, personal websites, and small services,
even a single-node environment can provide a certain degree of <a href=/docs/concept/pitr><strong>data persistence</strong></a> guarantee.
However, single-node cannot achieve <a href=/docs/concept/ha><strong>High Availability</strong></a>—automatic failover requires at least 3 nodes.</p><p>If you want to install Pigsty in an environment without internet connection, please refer to the <a href=/docs/setup/offline/><strong>Offline Install</strong></a> mode.
If you only need the PostgreSQL database itself, please refer to the <a href=/docs/setup/slim/><strong>Slim Install</strong></a> mode.
If you are ready to start serious multi-node production deployment, please refer to the <a href=/docs/deploy/><strong>Deployment Guide</strong></a>.</p><hr><h2 id=quick-start>Quick Start</h2><p><a href=/docs/deploy/prepare><strong>Prepare</strong></a> a <a href=/docs/deploy/prepare#node><strong>node</strong></a> with <a href=/docs/ref/linux/><strong>compatible Linux system</strong></a>, and execute as an <a href=/docs/deploy/admin><strong>admin user</strong></a> with passwordless <a href=/docs/deploy/admin#ssh><strong><code>ssh</code></strong></a> and <a href=/docs/deploy/admin#sudo><strong><code>sudo</code></strong></a> privileges:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash  <span style=color:#8f5902;font-style:italic># Install Pigsty and dependencies</span>
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty<span style=color:#000;font-weight:700>;</span> ./configure -g                   <span style=color:#8f5902;font-style:italic># Generate config (with 1-node template, -g generates random passwords)</span>
</span></span><span style=display:flex><span>./deploy.yml                                  <span style=color:#8f5902;font-style:italic># Execute deployment playbook</span>
</span></span></code></pre></div><p>Yes, it&rsquo;s that simple. You can use <a href=/docs/concept/iac/template><strong>pre-configured templates</strong></a> to bring up Pigsty with one click without understanding any details.</p><p>Next, you can explore the <a href=/docs/setup/webui/><strong>Graphical User Interface</strong></a>, access <a href=/docs/setup/pgsql/><strong>PostgreSQL database services</strong></a>; or perform <a href=/docs/setup/config><strong>configuration customization</strong></a> and <a href=/docs/setup/playbook><strong>execute playbooks</strong></a> to deploy more clusters.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-feb220ce98138be93707bc30fc029cd1>1 - Single-Node Installation</h1><div class=lead>Get started with Pigsty—complete single-node install on a fresh Linux host!</div><p>This is the Pigsty single-node install guide. For multi-node HA prod deployment, refer to the <a href=/docs/deploy/><strong>Deployment</strong></a> docs.</p><p>Pigsty single-node installation consists of three steps: <a href=#install><strong>Install</strong></a>, <a href=#configure><strong>Configure</strong></a>, and <a href=#deploy><strong>Deploy</strong></a>.</p><hr><h2 id=summary>Summary</h2><p><a href=/docs/deploy/prepare><strong>Prepare</strong></a> a <a href=/docs/deploy/prepare#node><strong>node</strong></a> with <a href=/docs/ref/linux/><strong>compatible OS</strong></a>, and run as an <a href=/docs/deploy/admin><strong>admin user</strong></a> with nopass <a href=/docs/deploy/admin#ssh><strong><code>ssh</code></strong></a> and <a href=/docs/deploy/admin#sudo><strong><code>sudo</code></strong></a>:</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-00-00-tab data-bs-toggle=tab data-bs-target=#tabs-00-00 role=tab data-td-tp-persist="pigsty.io (global)" aria-controls=tabs-00-00 aria-selected=true>
pigsty.io (Global)</button></li><li class=nav-item><button class=nav-link id=tabs-00-01-tab data-bs-toggle=tab data-bs-target=#tabs-00-01 role=tab data-td-tp-persist="pigsty.cc (mirror)" aria-controls=tabs-00-01 aria-selected=false>
pigsty.cc (Mirror)</button></li></ul><div class=tab-content id=tabs-0-content><div class="tab-body tab-pane fade show active" id=tabs-00-00 role=tabpanel aria-labelled-by=tabs-00-00-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-01 role=tabpanel aria-labelled-by=tabs-00-01-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.cc/get <span style=color:#000;font-weight:700>|</span> bash<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div></div></div><p>This command runs the <a href=#install><strong>install</strong></a> script, downloads and extracts Pigsty source to your home directory and installs dependencies. Then complete <a href=#configure><strong>Configure</strong></a> and <a href=#deploy><strong>Deploy</strong></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/pigsty      <span style=color:#8f5902;font-style:italic># Enter Pigsty directory</span>
</span></span><span style=display:flex><span>./configure -g   <span style=color:#8f5902;font-style:italic># Generate config file (optional, skip if you know how to configure)</span>
</span></span><span style=display:flex><span>./deploy.yml     <span style=color:#8f5902;font-style:italic># Execute deployment playbook based on generated config</span>
</span></span></code></pre></div><p>After installation, access the <a href=/docs/setup/webui/><strong>Web UI</strong></a> via IP/domain + port <code>80/443</code> through Nginx,
and access the default <a href=/docs/setup/pgsql/><strong>PostgreSQL service</strong></a> via port <code>5432</code>.</p><p>The complete process takes 3–10 minutes depending on server specs/network. <a href=/docs/setup/offline/><strong>Offline installation</strong></a> speeds this up significantly; for monitoring-free setups, use <a href=/docs/setup/slim/><strong>Slim Install</strong></a> for even faster deployment.</p><p><strong>Video Example: Online Single-Node Installation (Debian 13, x86_64)</strong></p><div id=asciinema-5b46e71dbcd3d8fb39b11e5f19e7933f class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-5b46e71dbcd3d8fb39b11e5f19e7933f",o="/demo/install-hero.cast",e="solarized-light",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[4.5,"Install"],[20,"Configure"],[24,"Deploy"],[170,"Complete"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=prepare>Prepare</h2><p>Installing Pigsty involves some <a href=/docs/deploy/><strong>preparation work</strong></a>. Here&rsquo;s a checklist.</p><p>For single-node installations, many constraints can be relaxed—typically you only need to know your <strong>IP address</strong>. If you don&rsquo;t have a static IP, use <code>127.0.0.1</code>.</p><table class=full-width><thead><tr><th style=text-align:center>Item</th><th style=text-align:left>Requirement</th><th style=text-align:center>Item</th><th style=text-align:left>Requirement</th></tr></thead><tbody><tr><td style=text-align:center><a href=/docs/deploy/prepare#node><strong>Node</strong></a></td><td style=text-align:left><strong>1-node</strong>, at least <code>1C2G</code>, no upper limit</td><td style=text-align:center><a href=/docs/deploy/prepare#disk><strong>Disk</strong></a></td><td style=text-align:left><code>/data</code> mount point, <code>xfs</code> recommended</td></tr><tr><td style=text-align:center><a href=/docs/deploy/prepare#linux><strong>OS</strong></a></td><td style=text-align:left><code>Linux</code> <code>x86_64</code> / <code>aarch64</code>, EL/Debian/Ubuntu</td><td style=text-align:center><a href=/docs/deploy/prepare#network><strong>Network</strong></a></td><td style=text-align:left>Static IPv4; single-node without fixed IP can use <code>127.0.0.1</code></td></tr><tr><td style=text-align:center><a href=/docs/deploy/admin#ssh><strong>SSH</strong></a></td><td style=text-align:left><code>nopass</code> SSH login via public key</td><td style=text-align:center><a href=/docs/deploy/admin#sudo><strong>SUDO</strong></a></td><td style=text-align:left>sudo privilege, preferably with <code>nopass</code> option</td></tr></tbody></table><p>Typically, you only need to focus on your <strong>local IP address</strong>—as an exception, for single-node deployment, use <code>127.0.0.1</code> if no static IP available.</p><hr><h2 id=install>Install</h2><p>Use the following commands to auto-install Pigsty source to <code>~/pigsty</code> (recommended). Deployment dependencies (Ansible) are installed automatically.</p><ul class="nav nav-tabs" id=tabs-2 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-02-00-tab data-bs-toggle=tab data-bs-target=#tabs-02-00 role=tab data-td-tp-persist="pigsty.io (global)" aria-controls=tabs-02-00 aria-selected=true>
pigsty.io (Global)</button></li><li class=nav-item><button class=nav-link id=tabs-02-01-tab data-bs-toggle=tab data-bs-target=#tabs-02-01 role=tab data-td-tp-persist="pigsty.cc (mirror)" aria-controls=tabs-02-01 aria-selected=false>
pigsty.cc (Mirror)</button></li></ul><div class=tab-content id=tabs-2-content><div class="tab-body tab-pane fade show active" id=tabs-02-00 role=tabpanel aria-labelled-by=tabs-02-00-tab tabindex=2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash            <span style=color:#8f5902;font-style:italic># Install latest stable version</span>
</span></span><span style=display:flex><span>curl -fsSL https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash -s v4.0.0  <span style=color:#8f5902;font-style:italic># Install specific version</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-02-01 role=tabpanel aria-labelled-by=tabs-02-01-tab tabindex=2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://repo.pigsty.cc/get <span style=color:#000;font-weight:700>|</span> bash            <span style=color:#8f5902;font-style:italic># Install latest stable version</span>
</span></span><span style=display:flex><span>curl -fsSL https://repo.pigsty.cc/get <span style=color:#000;font-weight:700>|</span> bash -s v4.0.0  <span style=color:#8f5902;font-style:italic># Install specific version</span>
</span></span></code></pre></div></div></div><p>If you prefer not to run a remote script, you can manually <a href=https://github.com/pgsty/pigsty/releases><strong>download</strong></a> or clone the source. When using <code>git</code>, always checkout a specific version before use.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/pgsty/pigsty<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>cd</span> pigsty<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>git checkout v4.0.0-b4<span style=color:#000;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic># Always checkout a specific version when using git</span>
</span></span></code></pre></div><p>For manual download/clone installations, run the <a href=/docs/setup/offline#bootstrap><strong><code>bootstrap</code></strong></a> script to install Ansible and other dependencies. You can also <a href=/docs/setup/playbook#install-ansible><strong>install them yourself</strong></a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./bootstrap           <span style=color:#8f5902;font-style:italic># Install ansible for subsequent deployment</span>
</span></span></code></pre></div><hr><h2 id=configure>Configure</h2><p>In Pigsty, deployment blueprints are defined by the <a href=/docs/setup/config/><strong>inventory</strong></a>, the <a href=https://github.com/pgsty/pigsty/blob/main/pigsty.yml><strong><code>pigsty.yml</code></strong></a> configuration file. You can customize through declarative configuration.</p><p>Pigsty provides the <a href=https://github.com/pgsty/pigsty/blob/main/configure><strong><code>configure</code></strong></a> script as an optional <a href=/docs/concept/iac/configure><strong>configuration wizard</strong></a>,
which generates an <a href=/docs/concept/iac/inventory/><strong>inventory</strong></a> with good defaults based on your environment and input:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure -g                <span style=color:#8f5902;font-style:italic># Use config wizard to generate config with random passwords</span>
</span></span></code></pre></div><p>The generated config file is at <code>~/pigsty/pigsty.yml</code> by default. Review and customize as needed before installation.</p><p>Many <a href=/docs/concept/iac/template/><strong>configuration templates</strong></a> are available for reference. You can skip the wizard and directly edit <code>pigsty.yml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure                  <span style=color:#8f5902;font-style:italic># Default template, install PG 18 with essential extensions</span>
</span></span><span style=display:flex><span>./configure -v <span style=color:#0000cf;font-weight:700>17</span>            <span style=color:#8f5902;font-style:italic># Use PG 17 instead of default PG 18</span>
</span></span><span style=display:flex><span>./configure -c rich          <span style=color:#8f5902;font-style:italic># Create local repo, download all extensions, install major ones</span>
</span></span><span style=display:flex><span>./configure -c slim          <span style=color:#8f5902;font-style:italic># Minimal install template, use with ./slim.yml playbook</span>
</span></span><span style=display:flex><span>./configure -c app/supa      <span style=color:#8f5902;font-style:italic># Use app/supa self-hosted Supabase template</span>
</span></span><span style=display:flex><span>./configure -c ivory         <span style=color:#8f5902;font-style:italic># Use IvorySQL kernel instead of native PG</span>
</span></span><span style=display:flex><span>./configure -i 10.11.12.13   <span style=color:#8f5902;font-style:italic># Explicitly specify primary IP address</span>
</span></span><span style=display:flex><span>./configure -r china         <span style=color:#8f5902;font-style:italic># Use China mirrors instead of default repos</span>
</span></span><span style=display:flex><span>./configure -c ha/full -s    <span style=color:#8f5902;font-style:italic># Use 4-node sandbox template, skip IP replacement/detection</span>
</span></span></code></pre></div><details><summary>Example configure output</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./configure
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>configure pigsty v4.0.0 begin
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>region</span>  <span style=color:#ce5c00;font-weight:700>=</span> default
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>kernel</span>  <span style=color:#ce5c00;font-weight:700>=</span> Linux
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>machine</span> <span style=color:#ce5c00;font-weight:700>=</span> x86_64
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>package</span> <span style=color:#ce5c00;font-weight:700>=</span> rpm,dnf
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>vendor</span>  <span style=color:#ce5c00;font-weight:700>=</span> rocky <span style=color:#ce5c00;font-weight:700>(</span>Rocky Linux<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>version</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>9</span> <span style=color:#ce5c00;font-weight:700>(</span>9.6<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>sudo</span> <span style=color:#ce5c00;font-weight:700>=</span> vagrant ok
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>ssh</span> <span style=color:#ce5c00;font-weight:700>=</span> vagrant@127.0.0.1 ok
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>WARN<span style=color:#ce5c00;font-weight:700>]</span> Multiple IP address candidates found:
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>(</span>1<span style=color:#ce5c00;font-weight:700>)</span> 192.168.121.24	inet 192.168.121.24/24 brd 192.168.121.255 scope global dynamic noprefixroute eth0
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>(</span>2<span style=color:#ce5c00;font-weight:700>)</span> 10.10.10.12	    inet 10.10.10.12/24 brd 10.10.10.255 scope global noprefixroute eth1
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> IN <span style=color:#ce5c00;font-weight:700>]</span> INPUT primary_ip address <span style=color:#ce5c00;font-weight:700>(</span>of current meta node, e.g 10.10.10.10<span style=color:#ce5c00;font-weight:700>)</span>:
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>=</span>&gt; 10.10.10.12    <span style=color:#8f5902;font-style:italic># &lt;------- INPUT YOUR PRIMARY IPV4 ADDRESS HERE!</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>primary_ip</span> <span style=color:#ce5c00;font-weight:700>=</span> 10.10.10.12 <span style=color:#ce5c00;font-weight:700>(</span>from input<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>admin</span> <span style=color:#ce5c00;font-weight:700>=</span> vagrant@10.10.10.12 ok
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>mode</span> <span style=color:#ce5c00;font-weight:700>=</span> meta <span style=color:#ce5c00;font-weight:700>(</span>el9<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>locale</span>  <span style=color:#ce5c00;font-weight:700>=</span> C.UTF-8
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> configure pigsty <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>proceed with ./deploy.yml
</span></span></code></pre></div></details><br><p><strong>Common configure arguments:</strong></p><table class=full-width><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>-i|--ip</code></td><td style=text-align:left>Primary internal IP of current host, replaces placeholder <code>10.10.10.10</code></td></tr><tr><td style=text-align:left><code>-c|--conf</code></td><td style=text-align:left><a href=/docs/conf/><strong>Config template</strong></a> name relative to <code>conf/</code>, without <code>.yml</code> suffix</td></tr><tr><td style=text-align:left><code>-v|--version</code></td><td style=text-align:left>PostgreSQL major version: <code>13</code>, <code>14</code>, <code>15</code>, <code>16</code>, <code>17</code>, <code>18</code></td></tr><tr><td style=text-align:left><code>-r|--region</code></td><td style=text-align:left>Upstream repo region for faster downloads: (<code>default|china|europe</code>)</td></tr><tr><td style=text-align:left><code>-n|--non-interactive</code></td><td style=text-align:left>Use command-line args for primary IP, skip interactive wizard</td></tr><tr><td style=text-align:left><code>-x|--proxy</code></td><td style=text-align:left>Use current env vars to configure <a href=/docs/infra/param#proxy_env><code>proxy_env</code></a></td></tr></tbody></table><p>If your machine has multiple IPs bound, use <code>-i|--ip &lt;ipaddr></code> to explicitly specify the primary IP, or provide it in the interactive prompt.
The script replaces the placeholder <code>10.10.10.10</code> with your node&rsquo;s primary IPv4 address. Choose a static IP; do not use public IPs.</p><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Change default passwords!</div><p>We strongly recommend modifying default passwords and credentials in the config file before installation. See <a href=/docs/setup/security/><strong>Security Recommendations</strong></a> for details.</p></div><hr><h2 id=deploy>Deploy</h2><p>Pigsty&rsquo;s <a href=/docs/setup/playbook/><strong><code>deploy.yml</code></strong></a> <a href=/docs/setup/playbook/><strong>playbook</strong></a> applies the blueprint from <a href=#configure><strong>Configure</strong></a> to target nodes.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./deploy.yml     <span style=color:#8f5902;font-style:italic># Deploy all defined modules on current node at once</span>
</span></span></code></pre></div><details><summary>Example deployment output</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>......
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#ce5c00;font-weight:700>[</span>pgsql : pgsql init <span style=color:#204a87;font-weight:700>done</span><span style=color:#ce5c00;font-weight:700>]</span> *************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#ce5c00;font-weight:700>[</span>10.10.10.11<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span>&gt; <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;msg&#34;</span>: <span style=color:#4e9a06>&#34;postgres://10.10.10.11/postgres | meta  | dbuser_meta dbuser_view &#34;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>......
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#ce5c00;font-weight:700>[</span>pg_monitor : load grafana datasource meta<span style=color:#ce5c00;font-weight:700>]</span> *******************************
</span></span><span style=display:flex><span>changed: <span style=color:#ce5c00;font-weight:700>[</span>10.10.10.11<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************
</span></span><span style=display:flex><span>10.10.10.11                : <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>302</span>  <span style=color:#000>changed</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>232</span>  <span style=color:#000>unreachable</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>failed</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>skipped</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>65</span>   <span style=color:#000>rescued</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>ignored</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>localhost                  : <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6</span>    <span style=color:#000>changed</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>3</span>    <span style=color:#000>unreachable</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>failed</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>skipped</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>    <span style=color:#000>rescued</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>    <span style=color:#000>ignored</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span></code></pre></div><p>When you see <code>pgsql init done</code>, <code>PLAY RECAP</code> and similar output at the end, installation is complete!</p></details><br><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Upstream repo changes may cause online installation failures!</div><p>Upstream repos used by Pigsty (like Linux/PGDG repos) can sometimes enter a broken state due to improper updates, causing deployment failures (this has happened multiple times)!
You can wait for upstream fixes or use pre-made <a href=/docs/setup/offline#offline-packages><strong>offline packages</strong></a> to solve this.</p></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Avoid re-running the deployment playbook!</div><p>Warning: Running <a href=https://github.com/pgsty/pigsty/blob/main/deploy.yml><strong><code>deploy.yml</code></strong></a> again on an existing deployment may restart services and overwrite configurations!</p></div><hr><h2 id=interface>Interface</h2><p>After single-node installation, you typically have four modules installed on the current node:
<a href=/docs/pgsql/><strong><code>PGSQL</code></strong></a>, <a href=/docs/infra/><strong><code>INFRA</code></strong></a>, <a href=/docs/node/><strong><code>NODE</code></strong></a>, and <a href=/docs/etcd/><strong><code>ETCD</code></strong></a>.</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center><code>pg-meta-1</code></td><td style=text-align:center><code>infra-1</code></td><td style=text-align:center><code>etcd-1</code></td></tr></tbody></table><p>The <a href=/docs/infra><strong><code>INFRA</code></strong></a> module provides a <a href=/docs/setup/webui><strong>graphical management interface</strong></a>, accessible via Nginx on ports <strong>80/443</strong>.</p><p>The <a href=/docs/pgsql/><strong><code>PGSQL</code></strong></a> module provides a <a href=/docs/setup/pgsql><strong>PostgreSQL database server</strong></a>, listening on <strong>5432</strong>, also accessible via Pgbouncer/HAProxy <a href=/docs/pgsql/service><strong>proxies</strong></a>.</p><p><a href=https://demo.pigsty.io/><img src=/img/pigsty/home.png alt></a></p><hr><h2 id=more>More</h2><p>Use the current node as a base to deploy and monitor <a href=/docs/conf/full><strong>more clusters</strong></a>: add cluster definitions to the <a href=/docs/setup/config/><strong>inventory</strong></a> and run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-add   pg-test      <span style=color:#8f5902;font-style:italic># Add the 3 nodes of cluster pg-test to Pigsty management</span>
</span></span><span style=display:flex><span>bin/pgsql-add  pg-test      <span style=color:#8f5902;font-style:italic># Initialize a 3-node pg-test HA PG cluster</span>
</span></span><span style=display:flex><span>bin/redis-add  redis-ms     <span style=color:#8f5902;font-style:italic># Initialize Redis cluster: redis-ms</span>
</span></span></code></pre></div><p>Most modules require the <a href=/docs/node/><strong><code>NODE</code></strong></a> module installed first. See available <a href=/docs/ref/module/><strong>modules</strong></a> for details:</p><p><a href=/docs/pgsql/><strong><code>PGSQL</code></strong></a>, <a href=/docs/infra/><strong><code>INFRA</code></strong></a>, <a href=/docs/node/><strong><code>NODE</code></strong></a>, <a href=/docs/etcd/><strong><code>ETCD</code></strong></a>,
<a href=/docs/minio/><strong><code>MINIO</code></strong></a>, <a href=/docs/redis/><strong><code>REDIS</code></strong></a>, <a href=/docs/ferret/><strong><code>FERRET</code></strong></a>, <a href=/docs/docker/><strong><code>DOCKER</code></strong></a>……</p></div><div class=td-content style=page-break-before:always><h1 id=pg-fcae07fc2570b34306c20c69a4aab512>2 - Web Interface</h1><div class=lead>Explore Pigsty&rsquo;s Web graphical management interface, Grafana dashboards, and how to access them via domain names and HTTPS.</div><p>After <a href=/docs/setup/install><strong>single-node installation</strong></a>, you&rsquo;ll have the <a href=/docs/infra/><strong><code>INFRA</code></strong></a> module installed on the current node, which includes an out-of-the-box Nginx web server.</p><p>The default server configuration provides a WebUI graphical interface for displaying monitoring dashboards and unified proxy access to other component web interfaces.</p><hr><h2 id=access>Access</h2><p>You can access this graphical interface by entering the deployment node&rsquo;s IP address in your browser. By default, Nginx serves on standard ports <code>80/443</code>.</p><table class=full-width><thead><tr><th style=text-align:center>Direct IP Access</th><th style=text-align:center>Domain (HTTP)</th><th style=text-align:center>Domain (HTTPS)</th><th style=text-align:center>Demo</th></tr></thead><tbody><tr><td style=text-align:center><a href=http://10.10.10.10><strong><code>http://10.10.10.10</code></strong></a></td><td style=text-align:center><a href=http://i.pigsty><strong><code>http://i.pigsty</code></strong></a></td><td style=text-align:center><a href=https://i.pigsty><strong><code>https://i.pigsty</code></strong></a></td><td style=text-align:center><a href=https://demo.pigsty.io/zh><strong><code>https://demo.pigsty.io</code></strong></a></td></tr></tbody></table><p><a href=https://demo.pigsty.io/zh><img src=/img/pigsty/home.png alt></a></p><hr><h2 id=monitoring>Monitoring</h2><p>To access Pigsty&rsquo;s monitoring system dashboards (Grafana), visit the <code>/ui</code> endpoint on the server.</p><table class=full-width><thead><tr><th style=text-align:center>Direct IP Access</th><th style=text-align:center>Domain (HTTP)</th><th style=text-align:center>Domain (HTTPS)</th><th style=text-align:center>Demo</th></tr></thead><tbody><tr><td style=text-align:center><a href=http://10.10.10.10/ui><strong><code>http://10.10.10.10/ui</code></strong></a></td><td style=text-align:center><a href=http://i.pigsty/ui><strong><code>http://i.pigsty/ui</code></strong></a></td><td style=text-align:center><a href=https://i.pigsty/ui><strong><code>https://i.pigsty/ui</code></strong></a></td><td style=text-align:center><a href=https://demo.pigsty.io/ui><strong><code>https://demo.pigsty.io/ui</code></strong></a></td></tr></tbody></table><p>If your service is exposed to Internet or office network, we recommend accessing via <a href=/docs/infra/admin/domain/><strong>domain names</strong></a> and enabling <a href=/docs/infra/admin/cert><strong>HTTPS</strong></a> encryption—only minimal configuration is needed.</p><hr><h2 id=endpoints>Endpoints</h2><p>By default, Nginx exposes the following endpoints via different paths on the default server at ports <code>80/443</code>:</p><table class=full-width><thead><tr><th style=text-align:left>Endpoint</th><th style=text-align:left>Component</th><th style=text-align:left>Native Port</th><th style=text-align:left>Description</th><th>Public Demo</th></tr></thead><tbody><tr><td style=text-align:left><code>/</code></td><td style=text-align:left><a href=/docs/infra/><strong>Nginx</strong></a></td><td style=text-align:left><code>80/443</code></td><td style=text-align:left>Homepage, local repo, file service</td><td><a href=https://demo.pigsty.io><code>demo.pigsty.io</code></a></td></tr><tr><td style=text-align:left><code>/ui/</code></td><td style=text-align:left><a href=#grafana><strong>Grafana</strong></a></td><td style=text-align:left><code>3000</code></td><td style=text-align:left>Grafana dashboard portal</td><td><a href=https://demo.pigsty.io/ui/><code>demo.pigsty.io/ui/</code></a></td></tr><tr><td style=text-align:left><code>/vmetrics/</code></td><td style=text-align:left><a href=/docs/infra/><strong>VictoriaMetrics</strong></a></td><td style=text-align:left><code>8428</code></td><td style=text-align:left>Time series database Web UI</td><td><a href=https://demo.pigsty.io/vmetrics/><code>demo.pigsty.io/vmetrics/</code></a></td></tr><tr><td style=text-align:left><code>/vlogs/</code></td><td style=text-align:left><a href=/docs/infra/><strong>VictoriaLogs</strong></a></td><td style=text-align:left><code>9428</code></td><td style=text-align:left>Log database Web UI</td><td><a href=https://demo.pigsty.io/vlogs/><code>demo.pigsty.io/vlogs/</code></a></td></tr><tr><td style=text-align:left><code>/vtraces/</code></td><td style=text-align:left><a href=/docs/infra/><strong>VictoriaTraces</strong></a></td><td style=text-align:left><code>10428</code></td><td style=text-align:left>Distributed tracing Web UI</td><td><a href=https://demo.pigsty.io/vtraces/><code>demo.pigsty.io/vtraces/</code></a></td></tr><tr><td style=text-align:left><code>/vmalert/</code></td><td style=text-align:left><a href=/docs/infra/><strong>VMAlert</strong></a></td><td style=text-align:left><code>8880</code></td><td style=text-align:left>Alert rule management</td><td><a href=https://demo.pigsty.io/vmalert/><code>demo.pigsty.io/vmalert/</code></a></td></tr><tr><td style=text-align:left><code>/alertmgr/</code></td><td style=text-align:left><a href=/docs/infra/><strong>AlertManager</strong></a></td><td style=text-align:left><code>9059</code></td><td style=text-align:left>Alert management Web UI</td><td><a href=https://demo.pigsty.io/alertmgr/><code>demo.pigsty.io/alertmgr/</code></a></td></tr><tr><td style=text-align:left><code>/blackbox/</code></td><td style=text-align:left><a href=/docs/infra/><strong>Blackbox</strong></a></td><td style=text-align:left><code>9115</code></td><td style=text-align:left>Blackbox exporter</td><td></td></tr><tr><td style=text-align:left><code>/haproxy/*</code></td><td style=text-align:left><a href=/docs/node/><strong>HAProxy</strong></a></td><td style=text-align:left><code>9101</code></td><td style=text-align:left>Load balancer admin Web UI</td><td></td></tr><tr><td style=text-align:left><code>/pev</code></td><td style=text-align:left><a href=https://github.com/dalibo/pev2><strong>PEV2</strong></a></td><td style=text-align:left><code>80</code></td><td style=text-align:left>PostgreSQL execution plan visualizer</td><td><a href=https://demo.pigsty.io/pev><code>demo.pigsty.io/pev</code></a></td></tr><tr><td style=text-align:left><code>/nginx</code></td><td style=text-align:left><a href=/docs/infra/><strong>Nginx</strong></a></td><td style=text-align:left><code>80</code></td><td style=text-align:left>Nginx status page (for metrics)</td><td></td></tr></tbody></table><hr><h2 id=domain-access>Domain Access</h2><p>If you have your own domain name, you can point it to Pigsty server&rsquo;s IP address to access various services via domain.</p><p>If you want to enable HTTPS, you should modify the <a href=https://github.com/pgsty/pigsty/blob/main/conf/meta.yml#L139><strong><code>home</code></strong></a> server configuration in the <a href=/docs/infra/param#infra_portal><strong><code>infra_portal</code></strong></a> parameter:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>i.pigsty }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Replace i.pigsty with your domain</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra_portal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># domain specifies the domain name  # certbot parameter specifies certificate name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>home </span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>domain: demo.pigsty.io ,certbot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>mycert }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>You can run <code>make cert</code> command after deployment to apply for a free Let&rsquo;s Encrypt certificate for the domain.
If you don&rsquo;t define the <code>certbot</code> field, Pigsty will use the local CA to issue a self-signed HTTPS certificate by default.
In this case, you must first trust Pigsty&rsquo;s self-signed CA to access normally in your browser.</p><p>You can also mount local directories and other upstream services to Nginx. For more management details, refer to <a href=/docs/infra/admin/portal><strong>INFRA Management - Nginx</strong></a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b74607462cd5472ff13684ffc71d526f>3 - Getting Started with PostgreSQL</h1><div class=lead>Get started with PostgreSQL—connect using CLI and graphical clients</div><p><a href=https://www.postgresql.org/><strong>PostgreSQL</strong></a> (abbreviated as PG) is the world&rsquo;s most advanced and popular open-source relational database. Use it to store and retrieve multi-modal data.</p><p>This guide is for developers with basic Linux CLI experience but not very familiar with PostgreSQL, helping you quickly get started with PG in Pigsty.</p><p>We assume you&rsquo;re a personal user deploying in the default single-node mode. For prod multi-node HA cluster access, refer to <a href=/docs/pgsql/service/><strong>Prod Service Access</strong></a>.</p><hr><h2 id=basics>Basics</h2><p>In the default <a href=/docs/setup/install><strong>single-node installation</strong></a> template, you&rsquo;ll create a PostgreSQL database cluster named <code>pg-meta</code> on the current node, with only one primary instance.</p><p>PostgreSQL listens on port <code>5432</code>, and the cluster has a preset database <code>meta</code> available for use.</p><p>After installation, exit the current admin user ssh session and re-login to refresh environment variables.
Then simply type <code>p</code> and press Enter to access the database cluster via the <code>psql</code> CLI tool:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vagrant@pg-meta-1:~$ p
</span></span><span style=display:flex><span>psql <span style=color:#ce5c00;font-weight:700>(</span>18.1 <span style=color:#ce5c00;font-weight:700>(</span>Ubuntu 18.1-1.pgdg24.04+2<span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>Type <span style=color:#4e9a06>&#34;help&#34;</span> <span style=color:#204a87;font-weight:700>for</span> help.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>postgres</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#8f5902;font-style:italic>#</span>
</span></span></code></pre></div><p>You can also switch to the <code>postgres</code> OS user and execute <code>psql</code> directly to connect to the default <code>postgres</code> admin database.</p><hr><h2 id=connecting-to-database>Connecting to Database</h2><p>To access a PostgreSQL database, use a CLI tool or graphical client and fill in the PostgreSQL <strong>connection string</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>postgres://username:password@host:port/dbname
</span></span></code></pre></div><p>Some drivers and tools may require you to fill in these parameters separately. The following five are typically required:</p><table class=full-width><thead><tr><th>Parameter</th><th>Description</th><th>Example Value</th><th>Notes</th></tr></thead><tbody><tr><td><code>host</code></td><td>Database server address</td><td><code>10.10.10.10</code></td><td>Replace with your node IP or domain; can omit for localhost</td></tr><tr><td><code>port</code></td><td>Port number</td><td><code>5432</code></td><td>PG default port, can be omitted</td></tr><tr><td><code>username</code></td><td>Username</td><td><code>dbuser_dba</code></td><td>Pigsty default database admin</td></tr><tr><td><code>password</code></td><td>Password</td><td><code>DBUser.DBA</code></td><td>Pigsty default admin password (<strong>change this!</strong>)</td></tr><tr><td><code>dbname</code></td><td>Database name</td><td><code>meta</code></td><td>Default template database name</td></tr></tbody></table><p>For personal use, you can directly use the Pigsty default database superuser <code>dbuser_dba</code> for connection and management. The <code>dbuser_dba</code> has full database privileges.
By default, if you specified the <code>configure -g</code> parameter when configuring Pigsty, the password will be randomly generated and saved in <code>~/pigsty/pigsty.yml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/pigsty/pigsty.yml <span style=color:#000;font-weight:700>|</span> grep pg_admin_password
</span></span></code></pre></div><hr><h2 id=default-accounts>Default Accounts</h2><p>Pigsty&rsquo;s default <a href=/docs/conf/meta><strong>single-node template</strong></a> presets the following database users, ready to use out of the box:</p><table class=full-width><thead><tr><th>Username</th><th>Password</th><th>Role</th><th>Purpose</th></tr></thead><tbody><tr><td><code>dbuser_dba</code></td><td><code>DBUser.DBA</code></td><td>Superuser</td><td>Database admin (<strong>change this!</strong>)</td></tr><tr><td><code>dbuser_meta</code></td><td><code>DBUser.Meta</code></td><td>Business admin</td><td>App R/W (<strong>change this!</strong>)</td></tr><tr><td><code>dbuser_view</code></td><td><code>DBUser.Viewer</code></td><td>Read-only user</td><td>Data viewing (<strong>change this!</strong>)</td></tr></tbody></table><p>For example, you can connect to the <code>meta</code> database in the <code>pg-meta</code> cluster using three different connection strings with three different users:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>postgres://dbuser_dba:DBUser.DBA@10.10.10.10:5432/meta
</span></span><span style=display:flex><span>postgres://dbuser_meta:DBUser.Meta@10.10.10.10:5432/meta
</span></span><span style=display:flex><span>postgres://dbuser_view:DBUser.View@10.10.10.10:5432/meta
</span></span></code></pre></div><p>Note: These default passwords are automatically replaced with random strong passwords when using <code>configure -g</code>. Remember to replace the IP address and password with actual values.</p><hr><h2 id=using-cli-tools>Using CLI Tools</h2><p><code>psql</code> is the official PostgreSQL CLI client tool, powerful and the first choice for DBAs and developers.</p><p>On a server with Pigsty deployed, you can directly use <code>psql</code> to connect to the local database:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Simplest way: use postgres system user for local connection (no password needed)</span>
</span></span><span style=display:flex><span>sudo -u postgres psql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Use connection string (recommended, most universal)</span>
</span></span><span style=display:flex><span>psql <span style=color:#4e9a06>&#39;postgres://dbuser_dba:DBUser.DBA@10.10.10.10:5432/meta&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Use parameter form</span>
</span></span><span style=display:flex><span>psql -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>5432</span> -U dbuser_dba -d meta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Use env vars to avoid password appearing in command line</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>PGPASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;DBUser.DBA&#39;</span>
</span></span><span style=display:flex><span>psql -h 10.10.10.10 -p <span style=color:#0000cf;font-weight:700>5432</span> -U dbuser_dba -d meta
</span></span></code></pre></div><p>After successful connection, you&rsquo;ll see a prompt like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql <span style=color:#ce5c00;font-weight:700>(</span>18.1<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>Type <span style=color:#4e9a06>&#34;help&#34;</span> <span style=color:#204a87;font-weight:700>for</span> help.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>meta</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#8f5902;font-style:italic>#</span>
</span></span></code></pre></div><p><strong>Common psql Commands</strong></p><p>After entering psql, you can execute SQL statements or use meta-commands starting with <code>\</code>:</p><table><thead><tr><th>Command</th><th>Description</th><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>Ctrl+C</code></td><td>Interrupt query</td><td><code>Ctrl+D</code></td><td>Exit psql</td></tr><tr><td><code>\?</code></td><td>Show all meta commands</td><td><code>\h</code></td><td>Show SQL command help</td></tr><tr><td><code>\l</code></td><td>List all databases</td><td><code>\c dbname</code></td><td>Switch to database</td></tr><tr><td><code>\d table</code></td><td>View table structure</td><td><code>\d+ table</code></td><td>View table details</td></tr><tr><td><code>\du</code></td><td>List all users/roles</td><td><code>\dx</code></td><td>List installed extensions</td></tr><tr><td><code>\dn</code></td><td>List all schemas</td><td><code>\dt</code></td><td>List all tables</td></tr></tbody></table><p><strong>Executing SQL</strong></p><p>In <code>psql</code>, directly enter SQL statements ending with semicolon <code>;</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Check PostgreSQL version
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Check current time
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#000>now</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Create a test table
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>test</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#f8f8f8> </span><span style=color:#204a87>SERIAL</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>name</span><span style=color:#f8f8f8> </span><span style=color:#204a87>TEXT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>created_at</span><span style=color:#f8f8f8> </span><span style=color:#000>TIMESTAMPTZ</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>DEFAULT</span><span style=color:#f8f8f8> </span><span style=color:#000>now</span><span style=color:#000;font-weight:700>());</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Insert data
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>test</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>VALUES</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;hello&#39;</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;world&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Query data
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>test</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Drop test table
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>DROP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>test</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><hr><h2 id=using-graphical-clients>Using Graphical Clients</h2><p>If you prefer graphical interfaces, here are some popular PostgreSQL clients:</p><p><strong>Grafana</strong></p><p>Pigsty&rsquo;s <a href=/docs/infra><strong><code>INFRA</code></strong></a> module includes <a href=/docs/infra><strong>Grafana</strong></a> with a pre-configured PostgreSQL data source (Meta).
You can directly query the database using SQL from the Grafana Explore panel through the <a href=/docs/setup/webui><strong>browser graphical interface</strong></a>, no additional client tools needed.</p><p>Grafana&rsquo;s default username is <strong><code>admin</code></strong>, and the password can be found in the <a href=/docs/infra/param#grafana_admin_password><strong><code>grafana_admin_password</code></strong></a> field in the <a href=/docs/concept/iac/inventory><strong>inventory</strong></a> (default <code>pigsty</code>).</p><p><strong>DataGrip</strong></p><p><a href=https://www.jetbrains.com/datagrip/><strong>DataGrip</strong></a> is a professional database IDE from JetBrains, with powerful features.
IntelliJ IDEA&rsquo;s built-in Database Console can also connect to PostgreSQL in a similar way.</p><p><strong>DBeaver</strong></p><p><a href=https://dbeaver.io/><strong>DBeaver</strong></a> is a free open-source universal database tool supporting almost all major databases. It&rsquo;s a cross-platform desktop client.</p><p><strong>pgAdmin</strong></p><p><a href=https://www.pgadmin.org/><strong>pgAdmin</strong></a> is the official PostgreSQL-specific GUI tool from PGDG, available through browser or as a desktop client.</p><p>Pigsty provides a configuration template for one-click pgAdmin service deployment using Docker in <a href=/docs/app/pgadmin><strong>Software Template: pgAdmin</strong></a>.</p><hr><h2 id=viewing-monitoring-dashboards>Viewing Monitoring Dashboards</h2><p>Pigsty provides many PostgreSQL <a href=/docs/pgsql/monitor/dashboard><strong>monitoring dashboards</strong></a>, covering everything from cluster overview to single-table analysis.</p><p>We recommend starting with <strong>PGSQL Overview</strong>. Many elements in the dashboards are clickable, allowing you to drill down layer by layer to view details of each cluster, instance, database, and even internal database objects like tables, indexes, and functions.</p><hr><h2 id=trying-extensions>Trying Extensions</h2><p>One of PostgreSQL&rsquo;s most powerful features is its <a href=/docs/pgsql/ext><strong>extension ecosystem</strong></a>. Extensions can add new data types, functions, index methods, and more to the database.</p><p>Pigsty provides an unparalleled <a href=https://pgext.cloud/list><strong>440+ extensions</strong></a> in the PG ecosystem, covering 16 major categories including time-series, geographic, vector, and full-text search—install with one click.
Start with three powerful and commonly used extensions that are automatically installed in Pigsty&rsquo;s <a href=/docs/conf/meta><strong>default template</strong></a>. You can also <a href=/docs/pgsql/ext/install><strong>install</strong></a> more extensions as needed.</p><ul><li><a href=https://pgext.cloud/e/postgis><strong><code>postgis</code></strong></a>: Geographic information system for processing maps and location data</li><li><a href=https://pgext.cloud/e/vector><strong><code>pgvector</code></strong></a>: Vector database supporting AI embedding vector similarity search</li><li><a href=https://pgext.cloud/e/timescaledb><strong><code>timescaledb</code></strong></a>: Time-series database for efficient storage and querying of time-series data</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#a40000>\</span><span style=color:#000>dx</span><span style=color:#f8f8f8>                            </span><span style=color:#8f5902;font-style:italic>-- psql meta command, list installed extensions
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>pg_available_extensions</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic>-- Query installed, available extensions
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#000>EXTENSION</span><span style=color:#f8f8f8> </span><span style=color:#000>postgis</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic>-- Enable postgis extension
</span></span></span></code></pre></div><hr><h2 id=next-steps>Next Steps</h2><p>Congratulations on completing the PostgreSQL basics! Next, you can start <a href=/docs/setup/config><strong>configuring and customizing</strong></a> your database.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d96b1765e9d967725a0824edd07fe95d>4 - Customize Pigsty with Configuration</h1><div class=lead>Express your infra and clusters with declarative config files</div><p>Besides using the <a href=/docs/concept/iac/configure><strong>configuration wizard</strong></a> to auto-generate configs, you can write Pigsty config files from scratch.
This tutorial guides you through building a complex <a href=/docs/concept/iac/inventory><strong>inventory</strong></a> step by step.</p><p>If you define everything in the <a href=/docs/concept/iac/inventory><strong>inventory</strong></a> upfront, a single <code>deploy.yml</code> playbook run completes all deployment—but it hides the details.</p><p>This doc breaks down all modules and playbooks, showing how to incrementally build from a simple config to a complete deployment.</p><hr><h2 id=minimal-configuration>Minimal Configuration</h2><p>The simplest valid config only defines the <a href=/docs/infra/param#admin_ip><strong><code>admin_ip</code></strong></a> variable—the IP address of the node where Pigsty is installed (<strong>admin node</strong>):</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-00-00-tab data-bs-toggle=tab data-bs-target=#tabs-00-00 role=tab data-td-tp-persist=minimal aria-controls=tabs-00-00 aria-selected=true>
Minimal</button></li><li class=nav-item><button class=nav-link id=tabs-00-01-tab data-bs-toggle=tab data-bs-target=#tabs-00-01 role=tab data-td-tp-persist=mirror aria-controls=tabs-00-01 aria-selected=false>
Mirror</button></li></ul><div class=tab-content id=tabs-0-content><div class="tab-body tab-pane fade show active" id=tabs-00-00 role=tabpanel aria-labelled-by=tabs-00-00-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-01 role=tabpanel aria-labelled-by=tabs-00-01-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Set region: china to use mirrors</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>admin_ip: 10.10.10.10, region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>china } }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div></div><p>This config deploys nothing, but running <code>./deploy.yml</code> generates a self-signed <strong>CA</strong> in <code>files/pki/ca</code> for issuing certificates.</p><p>For convenience, you can also set <a href=/docs/infra/param/#region><strong><code>region</code></strong></a> to specify which region&rsquo;s software mirrors to use (<code>default</code>, <code>china</code>, <code>europe</code>).</p><hr><h2 id=add-nodes>Add Nodes</h2><p>Pigsty&rsquo;s <a href=/docs/node/><strong><code>NODE</code></strong></a> module manages cluster nodes. Any IP address in the inventory will be managed by Pigsty with the NODE module installed.</p><ul class="nav nav-tabs" id=tabs-1 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-01-00-tab data-bs-toggle=tab data-bs-target=#tabs-01-00 role=tab data-td-tp-persist=minimal aria-controls=tabs-01-00 aria-selected=true>
Minimal</button></li><li class=nav-item><button class=nav-link id=tabs-01-01-tab data-bs-toggle=tab data-bs-target=#tabs-01-01 role=tab data-td-tp-persist=mirror aria-controls=tabs-01-01 aria-selected=false>
Mirror</button></li></ul><div class=tab-content id=tabs-1-content><div class="tab-body tab-pane fade show active" id=tabs-01-00 role=tabpanel aria-labelled-by=tabs-01-00-tab tabindex=1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Remember to replace 10.10.10.10 with your actual IP</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>nodes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>                   </span><span style=color:#8f5902;font-style:italic># Current node IP</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default                        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Default repos</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra    </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add node, pgsql, infra repos</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-01-01 role=tabpanel aria-labelled-by=tabs-01-01-tab tabindex=1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Remember to replace 10.10.10.10 with your actual IP</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>nodes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>                 </span><span style=color:#8f5902;font-style:italic># Current node IP</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>china                        </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Use mirrors</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add node, pgsql, infra repos</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div></div><p>We added two <a href=/docs/concept/iac/parameter><strong>global parameters</strong></a>:
<a href=/docs/node/param/#node_repo_modules><strong><code>node_repo_modules</code></strong></a> specifies repos to add;
<a href=/docs/infra/param/#region><strong><code>region</code></strong></a> specifies which region&rsquo;s mirrors to use.</p><p>These parameters enable the node to use correct repositories and install required packages.
The NODE module offers many <a href=/docs/node/param><strong>customization options</strong></a>: node names, DNS, repos, packages, NTP, kernel params, tuning templates, monitoring, log collection, etc.
Even without changes, the defaults are sufficient.</p><p>Run <code>deploy.yml</code> or more precisely <code>node.yml</code> to bring the defined node under Pigsty management.</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:left>Add node</td></tr></tbody></table><hr><h2 id=add-infrastructure>Add Infrastructure</h2><p>A full-featured RDS cloud database service needs infrastructure support: monitoring (metrics/log collection, alerting, visualization), NTP, DNS, and other foundational services.</p><p>Define a special group <code>infra</code> to deploy the <a href=/docs/infra/><strong><code>INFRA</code></strong></a> module:</p><ul class="nav nav-tabs" id=tabs-2 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-02-00-tab data-bs-toggle=tab data-bs-target=#tabs-02-00 role=tab data-td-tp-persist=minimal aria-controls=tabs-02-00 aria-selected=true>
Minimal</button></li><li class=nav-item><button class=nav-link id=tabs-02-01-tab data-bs-toggle=tab data-bs-target=#tabs-02-01 role=tab data-td-tp-persist=mirror aria-controls=tabs-02-01 aria-selected=false>
Mirror</button></li></ul><div class=tab-content id=tabs-2-content><div class="tab-body tab-pane fade show active" id=tabs-02-00 role=tabpanel aria-labelled-by=tabs-02-00-tab tabindex=2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Simply changed group name from nodes -&gt; infra and added infra_seq</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-02-01 role=tabpanel aria-labelled-by=tabs-02-01-tab tabindex=2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Simply changed group name from nodes -&gt; infra and added infra_seq</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>china</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div></div><p>We also assigned an <a href=/docs/concept/iac/parameter#identity-parameters><strong>identity parameter</strong></a>: <a href=/docs/infra/param/#infra_seq><strong><code>infra_seq</code></strong></a> to distinguish nodes in multi-node HA <strong>INFRA</strong> deployments.</p><p>Run <code>infra.yml</code> to install <a href=/docs/node/><strong>INFRA<code>**](/docs/infra/) and [**NODE</code></strong></a> modules on <code>10.10.10.10</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./infra.yml   <span style=color:#8f5902;font-style:italic># Install INFRA module on infra group (includes NODE module)</span>
</span></span></code></pre></div><div id=asciinema-391032ce9daca47d8627cb2574fd29b4 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-391032ce9daca47d8627cb2574fd29b4",o="/demo/infra.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[4,"Execute"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><blockquote><p>NODE module is implicitly defined as long as an IP exists. NODE is idempotent—re-running has no side effects.</p></blockquote><p>After completion, you&rsquo;ll have complete observability infrastructure and node monitoring, but PostgreSQL database service is not yet deployed.</p><p>If your goal is just to set up this monitoring system (Grafana + Victoria), you&rsquo;re done! The <a href=/docs/conf/infra><strong><code>infra</code></strong></a> template is designed for this.
Everything in Pigsty is <strong>modular</strong>: you can deploy only monitoring infra without databases;
or vice versa—run HA PostgreSQL clusters without infra—<a href=/docs/setup/slim><strong>Slim Install</strong></a>.</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center><code>infra-1</code></td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:left>Add infrastructure</td></tr></tbody></table><hr><h2 id=deploy-database-cluster>Deploy Database Cluster</h2><p>To provide PostgreSQL service, install the <a href=/docs/pgsql/><strong>PGSQL`</strong></a> module and its dependency <a href=/docs/etcd/><strong>ETCD</strong></a>—just two lines of config:</p><ul class="nav nav-tabs" id=tabs-4 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-04-00-tab data-bs-toggle=tab data-bs-target=#tabs-04-00 role=tab data-td-tp-persist=minimal aria-controls=tabs-04-00 aria-selected=true>
Minimal</button></li><li class=nav-item><button class=nav-link id=tabs-04-01-tab data-bs-toggle=tab data-bs-target=#tabs-04-01 role=tab data-td-tp-persist=mirror aria-controls=tabs-04-01 aria-selected=false>
Mirror</button></li></ul><div class=tab-content id=tabs-4-content><div class="tab-body tab-pane fade show active" id=tabs-04-00 role=tabpanel aria-labelled-by=tabs-04-00-tab tabindex=4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>    </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add etcd cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role: primary } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta } }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add pg cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>admin_ip: 10.10.10.10, region: default, node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-04-01 role=tabpanel aria-labelled-by=tabs-04-01-tab tabindex=4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>    </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add etcd cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role: primary } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta } }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add pg cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>admin_ip: 10.10.10.10, region: china, node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div></div><p>We added two new groups: <code>etcd</code> and <code>pg-meta</code>, defining a single-node etcd cluster and a single-node PostgreSQL cluster.</p><p>Use <code>./deploy.yml</code> to redeploy everything, or incrementally deploy:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./etcd.yml  -l etcd      <span style=color:#8f5902;font-style:italic># Install ETCD module on etcd group</span>
</span></span><span style=display:flex><span>./pgsql.yml -l pg-meta   <span style=color:#8f5902;font-style:italic># Install PGSQL module on pg-meta group</span>
</span></span></code></pre></div><p><a href=/docs/pgsql/><strong>PGSQL</strong></a> depends on <a href=/docs/etcd/><strong>ETCD</strong></a> for HA consensus, so install ETCD first.
After completion, you have a working PostgreSQL service!</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center><code>infra-1</code></td><td style=text-align:center><code>etcd-1</code></td><td style=text-align:center><code>pg-meta-1</code></td><td style=text-align:left>Add etcd and PostgreSQL cluster</td></tr></tbody></table><p>We used <a href=/docs/node/playbook#nodeyml><strong><code>node.yml</code></strong></a>, <a href=/docs/infra/playbook#infrayml><strong><code>infra.yml</code></strong></a>, <a href=/docs/etcd/playbook#etcdyml><strong><code>etcd.yml</code></strong></a>, and <a href=/docs/pgsql/playbook#pgsqlyml><strong><code>pgsql.yml</code></strong></a> to deploy all four core modules on a single machine.</p><hr><h2 id=define-databases-and-users>Define Databases and Users</h2><p>In Pigsty, you can customize PostgreSQL cluster internals like <a href=/docs/pgsql/config/db><strong>databases</strong></a> and <a href=/docs/pgsql/config/user><strong>users</strong></a> through the inventory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># Other groups and variables hidden for brevity</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>       </span><span style=color:#8f5902;font-style:italic># Define database users</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta ,pgbouncer: true ,roles: [dbrole_admin] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>admin user  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Define business databases</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>vector] }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><ul><li><a href=/docs/pgsql/param/#pg_users><strong><code>pg_users</code></strong></a>: Defines a new user <code>dbuser_meta</code> with password <code>DBUser.Meta</code></li><li><a href=/docs/pgsql/param/#pg_databases><strong><code>pg_databases</code></strong></a>: Defines a new database <code>meta</code> with Pigsty <a href=/docs/concept/iac/cmdb><strong>CMDB</strong></a> schema (optional) and <code>vector</code> extension</li></ul><p>Pigsty offers rich customization parameters covering all aspects of databases and users.
If you define these parameters upfront, they&rsquo;re automatically created during <a href=/docs/pgsql/playbook#pgsqlyml><strong><code>./pgsql.yml</code></strong></a> execution.
For existing clusters, you can incrementally create or modify <a href=/docs/pgsql/admin/user><strong>users</strong></a> and <a href=/docs/pgsql/admin/db><strong>databases</strong></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-user pg-meta dbuser_meta      <span style=color:#8f5902;font-style:italic># Ensure user dbuser_meta exists in pg-meta</span>
</span></span><span style=display:flex><span>bin/pgsql-db   pg-meta meta             <span style=color:#8f5902;font-style:italic># Ensure database meta exists in pg-meta</span>
</span></span></code></pre></div><hr><h2 id=configure-pg-version-and-extensions>Configure PG Version and Extensions</h2><p>You can install <a href=/docs/pgsql/config/kernel><strong>different major versions</strong></a> of PostgreSQL, and up to <a href=https://pgext.cloud/list><strong>440</strong></a> <a href=/docs/pgsql/ext><strong>extensions</strong></a>. Let&rsquo;s remove the current default PG 18 and install PG 17:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-rm.yml -l pg-meta   <span style=color:#8f5902;font-style:italic># Remove old pg-meta cluster (it&#39;s PG 18)</span>
</span></span></code></pre></div><p>We can customize parameters to install and enable common extensions by default: <code>timescaledb</code>, <code>postgis</code>, and <code>pgvector</code>:</p><ul><li><a href=/docs/pgsql/param/#pg_extensions><strong><code>pg_extensions</code></strong></a>: <a href=/docs/pgsql/ext/install><strong>Install</strong></a> <code>timescaledb</code>, <code>postgis</code>, <code>pgvector</code> extensions.</li><li><a href=/docs/pgsql/param/#pg_libs><strong><code>pg_libs</code></strong></a>: <a href=/docs/pgsql/ext/config><strong>Configure loading</strong></a> <code>timescaledb</code>, <code>pg_stat_statements</code>, <code>auto_explain</code> dynamic libraries.</li><li><a href=/docs/pgsql/param/#pg_databases><strong><code>pg_databases</code></strong></a>: <a href=/docs/pgsql/ext/create><strong>Create and enable</strong></a> <code>vector</code>, <code>postgis</code>, <code>timescaledb</code> extensions for the <code>meta</code> database.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>    </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>  </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Add etcd cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>17</span><span style=color:#f8f8f8>   </span><span style=color:#8f5902;font-style:italic># Specify PG version as 17</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>timescaledb, postgis, pgvector ]     </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Install these extensions</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_libs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;timescaledb,pg_stat_statements,auto_explain&#39;</span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Preload these extension libraries</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta ,baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>vector, postgis, timescaledb ] } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta ,pgbouncer: true ,roles: [dbrole_admin] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>admin user } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,pgsql,infra</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l pg-meta   <span style=color:#8f5902;font-style:italic># Install PG17 and extensions, recreate pg-meta cluster</span>
</span></span></code></pre></div><hr><h2 id=add-more-nodes>Add More Nodes</h2><p>Add more nodes to the deployment, bring them under Pigsty management, deploy monitoring, configure repos, install software&mldr;</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add entire cluster at once, or add nodes individually</span>
</span></span><span style=display:flex><span>bin/node-add pg-test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bin/node-add 10.10.10.11
</span></span><span style=display:flex><span>bin/node-add 10.10.10.12
</span></span><span style=display:flex><span>bin/node-add 10.10.10.13
</span></span></code></pre></div><div id=asciinema-51d52490efbdd966365988956f52b35f class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-51d52490efbdd966365988956f52b35f",o="/demo/node.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[4,"Execute"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=deploy-ha-postgresql-cluster>Deploy HA PostgreSQL Cluster</h2><p>Now deploy a new database cluster <code>pg-test</code> on the three newly added nodes, using a three-node HA architecture:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>infra</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>   </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>infra_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>    </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq: 1 } } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>etcd } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role: primary } }, vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-test</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 3, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><div id=asciinema-942dc186323899bcee0f4643447fbd01 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-942dc186323899bcee0f4643447fbd01",o="/demo/pgsql.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[4,"Execute"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=deploy-redis-cluster>Deploy Redis Cluster</h2><p>Pigsty provides optional Redis support as a caching service in front of PostgreSQL:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/redis-add redis-ms
</span></span><span style=display:flex><span>bin/redis-add redis-meta
</span></span><span style=display:flex><span>bin/redis-add redis-test
</span></span></code></pre></div><p>Redis HA requires cluster mode or sentinel mode. See <a href=/docs/redis/config/><strong>Redis Configuration</strong></a>.</p><hr><h2 id=deploy-minio-cluster>Deploy MinIO Cluster</h2><p>Pigsty provides optional open-source object storage, S3 alternative—<a href=/docs/minio><strong>MinIO</strong></a> support, as <a href=/docs/pgsql/backup/repository><strong>backup repository</strong></a> for PostgreSQL.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./minio.yml -l minio
</span></span></code></pre></div><p>Serious prod MinIO deployments typically require at least 4 nodes with 4 disks each (4N/16D).</p><hr><h2 id=deploy-docker-module>Deploy Docker Module</h2><p>If you want to use containers to run <a href=/docs/app><strong>tools for managing PG</strong></a> or <a href=/docs/app><strong>software using PostgreSQL</strong></a>, install the <a href=/docs/docker/><strong><code>DOCKER</code></strong></a> module:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./docker.yml -l infra
</span></span></code></pre></div><p>Use pre-made application templates to launch common software tools with one click, such as the GUI tool for PG management: <a href=/docs/app/pgadmin/><strong>Pgadmin</strong></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./app.yml    -l infra -e <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>pgadmin
</span></span></code></pre></div><p>You can even self-host <strong>enterprise-grade</strong> <a href=/docs/app/supabase/><strong>Supabase</strong></a> with Pigsty, using external HA PostgreSQL clusters as the foundation and running stateless components in containers.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-98758ad7ef56ab0b1a9ad8320b14506b>5 - Run Playbooks with Ansible</h1><div class=lead>Use Ansible playbooks to deploy and manage Pigsty clusters</div><p>Pigsty uses <a href=https://docs.ansible.com/><strong>Ansible</strong></a> to manage clusters, a very popular large-scale/batch/automation ops tool in the SRE community.</p><p>Ansible can use <strong>declarative</strong> approach for server configuration management. All module deployments are implemented through a series of idempotent <a href=/docs/ref/playbook><strong>Ansible playbooks</strong></a>.</p><p>For example, in single-node deployment, you&rsquo;ll use the <a href=#deploy-playbook><strong><code>deploy.yml</code></strong></a> playbook. Pigsty has more <a href=/docs/ref/playbook><strong>built-in playbooks</strong></a>, you can choose to use as needed.</p><p>Understanding Ansible basics helps with better use of Pigsty, but this is <strong>not required</strong>, especially for single-node deployment.</p><hr><h2 id=deploy-playbook>Deploy Playbook</h2><p>Pigsty provides a &ldquo;one-stop&rdquo; deploy playbook <strong><code>deploy.yml</code></strong>, installing all modules on the current env in one go (if defined in config):</p><table class=full-width><thead><tr><th>Playbook</th><th>Command</th><th>Group</th><th style=text-align:center><code>infra</code></th><th style=text-align:center><code>[nodes]</code></th><th style=text-align:center><code>etcd</code></th><th style=text-align:center><code>minio</code></th><th style=text-align:center><code>[pgsql]</code></th></tr></thead><tbody><tr><td><code>infra.yml</code></td><td><code>./infra.yml</code></td><td><code>-l infra</code></td><td style=text-align:center>✓</td><td style=text-align:center>✓</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td><code>node.yml</code></td><td><code>./node.yml</code></td><td></td><td style=text-align:center></td><td style=text-align:center>✓</td><td style=text-align:center>✓</td><td style=text-align:center>✓</td><td style=text-align:center>✓</td></tr><tr><td><code>etcd.yml</code></td><td><code>./etcd.yml</code></td><td><code>-l etcd</code></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>✓</td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td><code>minio.yml</code></td><td><code>./minio.yml</code></td><td><code>-l minio</code></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>✓</td><td style=text-align:center></td></tr><tr><td><code>pgsql.yml</code></td><td><code>./pgsql.yml</code></td><td></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>✓</td></tr></tbody></table><p>This is the simplest deployment method. You can also follow instructions in <a href=/docs/setup/config/><strong>Customization Guide</strong></a> to incrementally complete deployment of all modules and nodes step by step.</p><hr><h2 id=install-ansible>Install Ansible</h2><p>When using the <a href=/docs/setup/install#install><strong>Pigsty installation script</strong></a>, or the <a href=/docs/setup/offline#bootstrap><strong><code>bootstrap</code></strong></a> phase of offline installation, Pigsty will automatically install <code>ansible</code> and its dependencies for you.</p><p>If you want to manually install Ansible, refer to the following instructions. The minimum supported Ansible version is 2.9.</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-00-00-tab data-bs-toggle=tab data-bs-target=#tabs-00-00 role=tab aria-controls=tabs-00-00 aria-selected=true>
Debian / Ubuntu</button></li><li class=nav-item><button class=nav-link id=tabs-00-01-tab data-bs-toggle=tab data-bs-target=#tabs-00-01 role=tab aria-controls=tabs-00-01 aria-selected=false>
EL</button></li><li class=nav-item><button class=nav-link id=tabs-00-02-tab data-bs-toggle=tab data-bs-target=#tabs-00-02 role=tab aria-controls=tabs-00-02 aria-selected=false>
MacOS</button></li></ul><div class=tab-content id=tabs-0-content><div class="tab-body tab-pane fade show active" id=tabs-00-00 role=tabpanel aria-labelled-by=tabs-00-00-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install -y ansible python3-jmespath
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-01 role=tabpanel aria-labelled-by=tabs-00-01-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dnf install -y ansible python-jmespath         <span style=color:#8f5902;font-style:italic># EL 10</span>
</span></span><span style=display:flex><span>sudo dnf install -y ansible python3.12-jmespath     <span style=color:#8f5902;font-style:italic># EL 9/8</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-02 role=tabpanel aria-labelled-by=tabs-00-02-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install ansible
</span></span><span style=display:flex><span>pip3 install jmespath
</span></span></code></pre></div></div></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Change default passwords!</div><p>Please note that EL10 EPEL repo doesn&rsquo;t yet provide a complete Ansible package. <a href=/docs/repo/pgsql><strong>Pigsty PGSQL</strong></a> EL10 repo supplements this.</p></div><p>Ansible is also available on macOS. You can use <a href=https://brew.sh/><strong>Homebrew</strong></a> to install Ansible on Mac,
and use it as an admin node to manage remote cloud servers. This is convenient for single-node Pigsty deployment on cloud VPS, but not recommended in prod envs.</p><hr><h2 id=execute-playbook>Execute Playbook</h2><p>Ansible playbooks are executable YAML files containing a series of task definitions to execute.
Running playbooks requires the <code>ansible-playbook</code> executable in your environment variable <code>PATH</code>.
Running <code>./node.yml</code> playbook is essentially executing the <code>ansible-playbook node.yml</code> command.</p><p>You can use some parameters to fine-tune playbook execution. The following <strong>4 parameters</strong> are essential for effective Ansible use:</p><table class=full-width><thead><tr><th style=text-align:center>Purpose</th><th style=text-align:left>Parameter</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center><a href=#limit-hosts><strong>Target</strong></a></td><td style=text-align:left><code>-l|--limit &lt;pattern></code></td><td style=text-align:left>Limit execution to specific groups/hosts/patterns</td></tr><tr><td style=text-align:center><a href=#limit-tasks><strong>Tasks</strong></a></td><td style=text-align:left><code>-t|--tags &lt;tags></code></td><td style=text-align:left>Only run tasks with specific tags</td></tr><tr><td style=text-align:center><a href=#extra-vars><strong>Params</strong></a></td><td style=text-align:left><code>-e|--extra-vars &lt;vars></code></td><td style=text-align:left>Extra command-line parameters</td></tr><tr><td style=text-align:center><a href=#specify-inventory><strong>Config</strong></a></td><td style=text-align:left><code>-i|--inventory &lt;path></code></td><td style=text-align:left>Use a specific inventory file</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml                         <span style=color:#8f5902;font-style:italic># Run node playbook on all hosts</span>
</span></span><span style=display:flex><span>./pgsql.yml -l pg-test             <span style=color:#8f5902;font-style:italic># Run pgsql playbook on pg-test cluster</span>
</span></span><span style=display:flex><span>./infra.yml -t repo_build          <span style=color:#8f5902;font-style:italic># Run infra.yml subtask repo_build</span>
</span></span><span style=display:flex><span>./pgsql-rm.yml -e <span style=color:#000>pg_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>  <span style=color:#8f5902;font-style:italic># Remove pgsql, but keep packages (don&#39;t uninstall software)</span>
</span></span><span style=display:flex><span>./infra.yml -i conf/mynginx.yml    <span style=color:#8f5902;font-style:italic># Use another location&#39;s config file</span>
</span></span></code></pre></div><hr><h2 id=limit-hosts>Limit Hosts</h2><p>Playbook <strong>execution targets</strong> can be limited with <code>-l|--limit &lt;selector></code>.
This is convenient when running playbooks on specific hosts/nodes or groups/clusters.
Here are some host limit examples:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml                              <span style=color:#8f5902;font-style:italic># Run on all hosts (dangerous!)</span>
</span></span><span style=display:flex><span>./pgsql.yml -l pg-test                   <span style=color:#8f5902;font-style:italic># Run on pg-test cluster</span>
</span></span><span style=display:flex><span>./pgsql.yml -l 10.10.10.10               <span style=color:#8f5902;font-style:italic># Run on single host 10.10.10.10</span>
</span></span><span style=display:flex><span>./pgsql.yml -l pg-*                      <span style=color:#8f5902;font-style:italic># Run on hosts/groups matching glob `pg-*`</span>
</span></span><span style=display:flex><span>./pgsql.yml -l <span style=color:#4e9a06>&#39;10.10.10.11,&amp;pg-test&#39;</span>    <span style=color:#8f5902;font-style:italic># Run on 10.10.10.11 in pg-test group</span>
</span></span><span style=display:flex><span>./pgsql-rm.yml -l <span style=color:#4e9a06>&#39;pg-test,!10.10.10.11&#39;</span> <span style=color:#8f5902;font-style:italic># Run on pg-test, except 10.10.10.11</span>
</span></span></code></pre></div><p>See all details in Ansible documentation: <a href=https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html>Patterns: targeting hosts and groups</a></p><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Use caution when running playbooks without host limits!</div><p>Missing this value can be dangerous—most playbooks execute on <code>all</code> hosts. <strong>Use with caution</strong>.</p></div><hr><h2 id=limit-tasks>Limit Tasks</h2><p><strong>Execution tasks</strong> can be controlled with <code>-t|--tags &lt;tags></code>.
If specified, only tasks with the given tags will execute instead of the entire playbook.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./infra.yml -t repo          <span style=color:#8f5902;font-style:italic># Create repo</span>
</span></span><span style=display:flex><span>./node.yml  -t node_pkg      <span style=color:#8f5902;font-style:italic># Install node packages</span>
</span></span><span style=display:flex><span>./pgsql.yml -t pg_install    <span style=color:#8f5902;font-style:italic># Install PG packages and extensions</span>
</span></span><span style=display:flex><span>./etcd.yml  -t etcd_purge    <span style=color:#8f5902;font-style:italic># Destroy ETCD cluster</span>
</span></span><span style=display:flex><span>./minio.yml -t minio_alias   <span style=color:#8f5902;font-style:italic># Write MinIO CLI config</span>
</span></span></code></pre></div><p>To run multiple tasks, specify multiple tags separated by commas <code>-t tag1,tag2</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml  -t node_repo,node_pkg   <span style=color:#8f5902;font-style:italic># Add repos, then install packages</span>
</span></span><span style=display:flex><span>./pgsql.yml -t pg_hba,pg_reload     <span style=color:#8f5902;font-style:italic># Configure, then reload pg hba rules</span>
</span></span></code></pre></div><hr><h2 id=extra-vars>Extra Vars</h2><p>You can override config parameters at runtime using CLI arguments, which have <a href=https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#understanding-variable-precedence><strong>highest priority</strong></a>.</p><p>Extra command-line parameters are passed via <code>-e|--extra-vars KEY=VALUE</code>, usable multiple times:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create admin using another admin user</span>
</span></span><span style=display:flex><span>./node.yml -e <span style=color:#000>ansible_user</span><span style=color:#ce5c00;font-weight:700>=</span>admin -k -K -t node_admin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Initialize a specific Redis instance: 10.10.10.11:6379</span>
</span></span><span style=display:flex><span>./redis.yml -l 10.10.10.10 -e <span style=color:#000>redis_port</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>6379</span> -t redis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remove PostgreSQL but keep packages and data</span>
</span></span><span style=display:flex><span>./pgsql-rm.yml -e <span style=color:#000>pg_rm_pkg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> -e <span style=color:#000>pg_rm_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>
</span></span></code></pre></div><p>For complex parameters, use JSON strings to pass multiple complex parameters at once:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add repo and install packages</span>
</span></span><span style=display:flex><span>./node.yml -t node_install -e <span style=color:#4e9a06>&#39;{&#34;node_repo_modules&#34;:&#34;infra&#34;,&#34;node_packages&#34;:[&#34;duckdb&#34;]}&#39;</span>
</span></span></code></pre></div><hr><h2 id=specify-inventory>Specify Inventory</h2><p>The default config file is <code>pigsty.yml</code> in the Pigsty home directory.</p><p>You can use <code>-i &lt;path></code> to specify a different <a href=/docs/concept/iac/inventory><strong>inventory</strong></a> file path.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -i conf/rich.yml            <span style=color:#8f5902;font-style:italic># Initialize single node with all extensions per rich config</span>
</span></span><span style=display:flex><span>./pgsql.yml -i conf/ha/full.yml         <span style=color:#8f5902;font-style:italic># Initialize 4-node cluster per full config</span>
</span></span><span style=display:flex><span>./pgsql.yml -i conf/app/supa.yml        <span style=color:#8f5902;font-style:italic># Initialize 1-node Supabase deployment per supa.yml</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>Changing the default inventory file</div><p>To permanently change the <strong>default</strong> config file, modify the <code>inventory</code> parameter in <a href=https://github.com/pgsty/pigsty/blob/main/ansible.cfg#L6><code>ansible.cfg</code></a>.</p></div><hr><h2 id=convenience-scripts>Convenience Scripts</h2><p>Pigsty provides a series of convenience scripts to simplify common operations. These scripts are in the <code>bin/</code> directory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-add   &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Add nodes to Pigsty management: ./node.yml -l &lt;cls&gt;</span>
</span></span><span style=display:flex><span>bin/node-rm    &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Remove nodes from Pigsty: ./node-rm.yml -l &lt;cls&gt;</span>
</span></span><span style=display:flex><span>bin/pgsql-add  &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Initialize PG cluster: ./pgsql.yml -l &lt;cls&gt;</span>
</span></span><span style=display:flex><span>bin/pgsql-rm   &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Remove PG cluster: ./pgsql-rm.yml -l &lt;cls&gt;</span>
</span></span><span style=display:flex><span>bin/pgsql-user &lt;cls&gt; &lt;username&gt; <span style=color:#8f5902;font-style:italic># Add business user: ./pgsql-user.yml -l &lt;cls&gt; -e username=&lt;user&gt;</span>
</span></span><span style=display:flex><span>bin/pgsql-db   &lt;cls&gt; &lt;dbname&gt;   <span style=color:#8f5902;font-style:italic># Add business database: ./pgsql-db.yml -l &lt;cls&gt; -e dbname=&lt;db&gt;</span>
</span></span><span style=display:flex><span>bin/redis-add  &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Initialize Redis cluster: ./redis.yml -l &lt;cls&gt;</span>
</span></span><span style=display:flex><span>bin/redis-rm   &lt;cls&gt;            <span style=color:#8f5902;font-style:italic># Remove Redis cluster: ./redis-rm.yml -l &lt;cls&gt;</span>
</span></span></code></pre></div><p>These scripts are simple wrappers around Ansible playbooks, making common operations more convenient.</p><hr><h2 id=playbook-list>Playbook List</h2><p>Below are the <a href=/docs/ref/playbook><strong>built-in playbooks</strong></a> in Pigsty. You can also easily add your own playbooks, or customize and modify playbook implementation logic as needed.</p><table class=full-width><thead><tr><th style=text-align:center>Module</th><th>Playbook</th><th style=text-align:left>Function</th></tr></thead><tbody><tr><td style=text-align:center><a href=/docs/infra/playbook/><strong>INFRA</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/deploy.yml><strong><code>deploy.yml</code></strong></a></td><td style=text-align:left>One-click deploy Pigsty on current node</td></tr><tr><td style=text-align:center><a href=/docs/infra/playbook/><strong>INFRA</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/infra.yml><strong><code>infra.yml</code></strong></a></td><td style=text-align:left>Initialize Pigsty infrastructure on infra nodes</td></tr><tr><td style=text-align:center><a href=/docs/infra/playbook/><strong>INFRA</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/infra-rm.yml><strong><code>infra-rm.yml</code></strong></a></td><td style=text-align:left>Remove infrastructure components from infra nodes</td></tr><tr><td style=text-align:center><a href=/docs/infra/playbook/><strong>INFRA</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/cache.yml><strong><code>cache.yml</code></strong></a></td><td style=text-align:left>Create offline packages from target node</td></tr><tr><td style=text-align:center><a href=/docs/infra/playbook/><strong>INFRA</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/cert.yml><strong><code>cert.yml</code></strong></a></td><td style=text-align:left>Issue certificates using Pigsty self-signed CA</td></tr><tr><td style=text-align:center><a href=/docs/node/playbook/><strong>NODE</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/node.yml><strong><code>node.yml</code></strong></a></td><td style=text-align:left>Initialize node, adjust to desired state</td></tr><tr><td style=text-align:center><a href=/docs/node/playbook/><strong>NODE</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/node-rm.yml><strong><code>node-rm.yml</code></strong></a></td><td style=text-align:left>Remove node from Pigsty</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql.yml><strong><code>pgsql.yml</code></strong></a></td><td style=text-align:left>Initialize HA PostgreSQL cluster or add replica</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-rm.yml><strong><code>pgsql-rm.yml</code></strong></a></td><td style=text-align:left>Remove PostgreSQL cluster or replica</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-db.yml><strong><code>pgsql-db.yml</code></strong></a></td><td style=text-align:left>Add new business database to existing cluster</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-user.yml><strong><code>pgsql-user.yml</code></strong></a></td><td style=text-align:left>Add new business user to existing cluster</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-pitr.yml><strong><code>pgsql-pitr.yml</code></strong></a></td><td style=text-align:left>Perform point-in-time recovery on cluster</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-monitor.yml><strong><code>pgsql-monitor.yml</code></strong></a></td><td style=text-align:left>Monitor remote PostgreSQL with local exporter</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/pgsql-migration.yml><strong><code>pgsql-migration.yml</code></strong></a></td><td style=text-align:left>Generate migration manual and scripts</td></tr><tr><td style=text-align:center><a href=/docs/pgsql/playbook/><strong>PGSQL</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/slim.yml><strong><code>slim.yml</code></strong></a></td><td style=text-align:left>Install Pigsty with minimal components</td></tr><tr><td style=text-align:center><a href=/docs/redis/playbook/><strong>REDIS</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/redis.yml><strong><code>redis.yml</code></strong></a></td><td style=text-align:left>Initialize Redis cluster/node/instance</td></tr><tr><td style=text-align:center><a href=/docs/redis/playbook/><strong>REDIS</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/redis-rm.yml><strong><code>redis-rm.yml</code></strong></a></td><td style=text-align:left>Remove Redis cluster/node/instance</td></tr><tr><td style=text-align:center><a href=/docs/etcd/playbook/><strong>ETCD</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/etcd.yml><strong><code>etcd.yml</code></strong></a></td><td style=text-align:left>Initialize ETCD cluster or add new member</td></tr><tr><td style=text-align:center><a href=/docs/etcd/playbook/><strong>ETCD</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/etcd-rm.yml><strong><code>etcd-rm.yml</code></strong></a></td><td style=text-align:left>Remove ETCD cluster/data or shrink member</td></tr><tr><td style=text-align:center><a href=/docs/minio/playbook/><strong>MINIO</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/minio.yml><strong><code>minio.yml</code></strong></a></td><td style=text-align:left>Initialize MinIO cluster (optional pgBackRest repo)</td></tr><tr><td style=text-align:center><a href=/docs/minio/playbook/><strong>MINIO</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/minio-rm.yml><strong><code>minio-rm.yml</code></strong></a></td><td style=text-align:left>Remove MinIO cluster and data</td></tr><tr><td style=text-align:center><a href=/docs/docker/playbook/><strong>DOCKER</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/docker.yml><strong><code>docker.yml</code></strong></a></td><td style=text-align:left>Install Docker on nodes</td></tr><tr><td style=text-align:center><a href=/docs/docker/playbook/><strong>DOCKER</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/app.yml><strong><code>app.yml</code></strong></a></td><td style=text-align:left>Install applications using Docker Compose</td></tr><tr><td style=text-align:center><a href=/docs/ferret/playbook><strong>FERRET</strong></a></td><td><a href=https://github.com/pgsty/pigsty/blob/main/mongo.yml><strong><code>mongo.yml</code></strong></a></td><td style=text-align:left>Install Mongo/FerretDB on nodes</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-01b2a33b37e8e7124df9aa116794fa36>6 - Offline Installation</h1><div class=lead>Install Pigsty in air-gapped env using offline packages</div><p>Pigsty <a href=/docs/setup/install/><strong>installs</strong></a> from Internet upstream by default, but some envs are isolated from the Internet.
To address this, Pigsty supports offline installation using <a href=#offline-packages><strong>offline packages</strong></a>.
Think of them as Linux-native Docker images.</p><hr><h2 id=overview>Overview</h2><p><strong>Offline packages</strong> bundle all required RPM/DEB packages and dependencies; they are snapshots of the local APT/YUM repo after a normal <a href=/docs/setup/install/><strong>installation</strong></a>.</p><p>In <a href=/docs/deploy><strong>serious prod deployments</strong></a>, we <strong>strongly recommend</strong> using offline packages.
They ensure all future nodes have consistent software versions with the existing env,
and avoid online installation failures caused by upstream changes (quite common!),
guaranteeing you can run it independently forever.</p><div class="alert alert-success" role=alert><div class="h4 alert-heading" role=heading>Advantages of offline packages</div><ul><li>Easy delivery in Internet-isolated envs.</li><li>Pre-download all packages in one pass to speed up installation.</li><li>No need to worry about upstream dependency breakage causing install failures.</li><li>If you have multiple nodes, all packages only need to be downloaded once, saving bandwidth.</li><li>Use local repo to ensure all nodes have consistent software versions for unified version management.</div></li></ul><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Disadvantages of offline packages</div><ul><li>Offline packages are made for <strong>specific OS minor versions</strong>, typically cannot be used across versions.</li><li>It&rsquo;s a snapshot at the time of creation, may not include the latest updates and OS security patches.</li><li>Offline packages are typically about 1GB, while online installation downloads on-demand, saving space.</li></ul></div><hr><h2 id=offline-packages>Offline Packages</h2><p>We typically release offline packages for the following <a href=/docs/ref/linux/><strong>Linux distros</strong></a>, using the latest OS minor version.</p><table><thead><tr><th style=text-align:left>Linux Distribution</th><th style=text-align:left>System Code</th><th style=text-align:left>Minor Version</th><th style=text-align:left>Package</th></tr></thead><tbody><tr><td style=text-align:left>RockyLinux 8 x86_64</td><td style=text-align:left><code>el8.x86_64</code></td><td style=text-align:left><code>8.10</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el8.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.el8.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>RockyLinux 8 aarch64</td><td style=text-align:left><code>el8.aarch64</code></td><td style=text-align:left><code>8.10</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el8.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.el8.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>RockyLinux 9 x86_64</td><td style=text-align:left><code>el9.x86_64</code></td><td style=text-align:left><code>9.6</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el9.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.el9.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>RockyLinux 9 aarch64</td><td style=text-align:left><code>el9.aarch64</code></td><td style=text-align:left><code>9.6</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el9.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.el9.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>RockyLinux 10 x86_64</td><td style=text-align:left><code>el10.x86_64</code></td><td style=text-align:left><code>10.0</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el10.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.el10.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>RockyLinux 10 aarch64</td><td style=text-align:left><code>el10.aarch64</code></td><td style=text-align:left><code>10.0</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.el10.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.el10.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Debian 12 x86_64</td><td style=text-align:left><code>d12.x86_64</code></td><td style=text-align:left><code>12.11</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.d12.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.d12.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Debian 12 aarch64</td><td style=text-align:left><code>d12.aarch64</code></td><td style=text-align:left><code>12.11</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.d12.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.d12.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Debian 13 x86_64</td><td style=text-align:left><code>d13.x86_64</code></td><td style=text-align:left><code>13.2</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.d13.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.d13.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Debian 13 aarch64</td><td style=text-align:left><code>d13.aarch64</code></td><td style=text-align:left><code>13.2</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.d13.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.d13.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Ubuntu 24.04 x86_64</td><td style=text-align:left><code>u24.x86_64</code></td><td style=text-align:left><code>24.04.2</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.u24.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.u24.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Ubuntu 24.04 aarch64</td><td style=text-align:left><code>u24.aarch64</code></td><td style=text-align:left><code>24.04.2</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.u24.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.u24.aarch64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Ubuntu 22.04 x86_64</td><td style=text-align:left><code>u22.x86_64</code></td><td style=text-align:left><code>22.04.5</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.u22.x86_64.tgz><strong><code>pigsty-pkg-v4.0.0.u22.x86_64.tgz</code></strong></a></td></tr><tr><td style=text-align:left>Ubuntu 22.04 aarch64</td><td style=text-align:left><code>u22.aarch64</code></td><td style=text-align:left><code>22.04.5</code></td><td style=text-align:left><a href=https://github.com/pgsty/pigsty/releases/download/v4.0.0/pigsty-pkg-v4.0.0.u22.aarch64.tgz><strong><code>pigsty-pkg-v4.0.0.u22.aarch64.tgz</code></strong></a></td></tr></tbody></table><p>If you use an OS from the list above (exact minor version match), we recommend using offline packages.
Pigsty provides ready-to-use pre-made offline packages for these systems, freely downloadable from GitHub.</p><p>You can find these packages on the <a href=https://github.com/pgsty/pigsty/releases/latest><strong>GitHub release page</strong></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>6a26fa44f90a16c7571d2aaf0e997d07  pigsty-v4.0.0.tgz
</span></span><span style=display:flex><span>537839201c536a1211f0b794482d733b  pigsty-pkg-v4.0.0.el9.x86_64.tgz
</span></span><span style=display:flex><span>85687cb56517acc2dce14245452fdc05  pigsty-pkg-v4.0.0.el9.aarch64.tgz
</span></span><span style=display:flex><span>a333e8eb34bf93f475c85a9652605139  pigsty-pkg-v4.0.0.el10.x86_64.tgz
</span></span><span style=display:flex><span>4b98b463e2ebc104c35ddc94097e5265  pigsty-pkg-v4.0.0.el10.aarch64.tgz
</span></span><span style=display:flex><span>4f62851c9d79a490d403f59deb4823f4  pigsty-pkg-v4.0.0.el8.x86_64.tgz
</span></span><span style=display:flex><span>66e283c9f6bfa80654f7ed3ffb9b53e5  pigsty-pkg-v4.0.0.el8.aarch64.tgz
</span></span><span style=display:flex><span>f7971d9d6aab1f8f307556c2f64b701c  pigsty-pkg-v4.0.0.d12.x86_64.tgz
</span></span><span style=display:flex><span>c4d870e5ef61ed05724c15fbccd1220b  pigsty-pkg-v4.0.0.d12.aarch64.tgz
</span></span><span style=display:flex><span>408991c5ff028b5c0a86fac804d64b93  pigsty-pkg-v4.0.0.d13.x86_64.tgz
</span></span><span style=display:flex><span>8d7c9404b97a11066c00eb7fc1330181  pigsty-pkg-v4.0.0.d13.aarch64.tgz
</span></span><span style=display:flex><span>2a25eff283332d9006854f36af6602b2  pigsty-pkg-v4.0.0.u24.x86_64.tgz
</span></span><span style=display:flex><span>a4fb30148a2d363bbfd3bec0daa14ab6  pigsty-pkg-v4.0.0.u24.aarch64.tgz
</span></span><span style=display:flex><span>87bb91ef703293b6ec5b77ae3bb33d54  pigsty-pkg-v4.0.0.u22.x86_64.tgz
</span></span><span style=display:flex><span>5c81bdaa560dad4751840dec736fe404  pigsty-pkg-v4.0.0.u22.aarch64.tgz
</span></span></code></pre></div><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Offline packages are made for specific Linux OS minor versions</div><p>When OS minor versions don&rsquo;t match, it may work or may fail—we don&rsquo;t recommend taking the risk.</p><p>Please note that Pigsty&rsquo;s EL9/EL10 packages are built on 9.6/10.0 and currently cannot be used for 9.7/10.1 minor versions (due to OpenSSL version changes).
You need to perform an online installation on a matching OS version and create your own offline package, or contact us for custom offline packages.</p></div><hr><h2 id=using-offline-packages>Using Offline Packages</h2><p><strong>Offline installation steps:</strong></p><ol><li>Download Pigsty offline package, place it at <strong><code>/tmp/pkg.tgz</code></strong></li><li>Download Pigsty source package, extract and enter directory (assume extracted to home: <strong><code>cd ~/pigsty</code></strong>)</li><li><a href=#bootstrap><strong><code>./bootstrap</code></strong></a>, it will extract the package and configure using local repo (and install <a href=/docs/setup/playbook><strong><code>ansible</code></strong></a> from it offline)</li><li><strong><code>./configure -g -c rich</code></strong>, you can directly use the <a href=/docs/conf/rich><strong><code>rich</code></strong></a> template configured for offline installation, or configure yourself</li><li>Run <strong><code>./deploy.yml</code></strong> as usual—it will install everything from the local repo</li></ol><div id=asciinema-0c702eafa8d25429ae93129af859ec22 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-0c702eafa8d25429ae93129af859ec22",o="/demo/install-offline.cast",e="solarized-light",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[0,"Upload Package"],[55,"Extract and Use"],[66,"Configure"],[80,"Deploy"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><p>If you want to use the already extracted and configured offline package in your own config, modify and ensure these settings:</p><ul><li><a href=/docs/infra/param#repo_enabled><strong><code>repo_enabled</code></strong></a>: Set to <strong><code>true</code></strong>, will build local software repo (explicitly disabled in most templates)</li><li><a href=/docs/node/param#node_repo_modules><strong><code>node_repo_modules</code></strong></a>: Set to <strong><code>local</code></strong>, then all nodes in the env will install from the local software repo<ul><li>In most templates, this is explicitly set to: <code>node,infra,pgsql</code>, i.e., install directly from these upstream repos.</li><li>Setting it to <code>local</code> will use the local software repo to install all packages, fastest, no interference from other repos.</li><li>If you want to use both local and upstream repos, you can add other repo module names too, e.g., <code>local,node,infra,pgsql</code></li></ul></li></ul><p>The first parameter, if enabled, Pigsty will create a <strong>local software repo</strong>. The second parameter, if contains <code>local</code>, then all nodes in the env will use this local software repo.
If it only contains <code>local</code>, then it becomes the sole repo for all nodes. If you still want to install other packages from other upstream repos, you can add other repo module names too, e.g., <code>local,node,infra,pgsql</code>.</p><p><strong>Hybrid Installation Mode</strong></p><p>If your env has Internet access, there&rsquo;s a hybrid approach combining advantages of offline and online installation.
You can use the offline package as a base, and supplement missing packages online.</p><p>For example, if you&rsquo;re using RockyLinux 9.5 but the official offline package is for RockyLinux 9.6.
You can use the <code>el9</code> offline package (though made for 9.6), then execute <code>make repo-build</code> before formal installation to re-download missing packages for 9.5.
Pigsty will download the required <strong>increments</strong> from upstream repos.</p><hr><h2 id=making-offline-packages>Making Offline Packages</h2><p>If your OS isn&rsquo;t in the default list, you can make your own offline package with the built-in <a href=https://github.com/pgsty/pigsty/blob/main/cache.yml><strong><code>cache.yml</code></strong></a> playbook:</p><ol><li>Find a node running the exact same OS version with Internet access</li><li>Use <a href=/docs/conf/rich><strong><code>rich</code></strong></a> config template to perform <a href=/docs/setup/install/><strong>online installation</strong></a> (<code>configure -c rich</code>)</li><li><code>cd ~/pigsty; ./cache.yml</code>: make and fetch the offline package to <code>~/pigsty/dist/${version}/</code></li><li>Copy the offline package to the env without Internet access (ftp, scp, usb, etc.), extract and use via <code>bootstrap</code></li></ol><p>We offer <a href=/docs/about/service/><strong>paid services</strong></a> providing tested, pre-made offline packages for specific Linux major.minor versions (¥200).</p><hr><h2 id=bootstrap>Bootstrap</h2><p>Pigsty relies on ansible to execute playbooks; this script is responsible for ensuring ansible is correctly installed in various ways.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./bootstrap       <span style=color:#8f5902;font-style:italic># Ensure ansible is correctly installed (if offline package exists, use offline installation and extract first)</span>
</span></span></code></pre></div><p>Usually, you need to run this script in two cases:</p><ul><li>You didn&rsquo;t install Pigsty via the <a href=/docs/setup/install#install><strong>installation script</strong></a>, but by downloading or <code>git clone</code> of the source package, so ansible isn&rsquo;t installed.</li><li>You&rsquo;re preparing to install Pigsty via offline packages and need to use this script to install ansible from the offline package.</li></ul><p>The <code>bootstrap</code> script will automatically detect if the offline package exists (<code>-p</code> to specify, default is <code>/tmp/pkg.tgz</code>).
If it exists, it will extract and use it, then install ansible from it.
If the offline package doesn&rsquo;t exist, it will try to install ansible from the Internet. If that still fails, you&rsquo;re on your own!</p><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Where are my yum/apt repo files?</div><p>The bootloader will by default <strong>move away</strong> existing repo configurations to ensure only required repos are enabled.
You can find them in <code>/etc/yum.repos.d/backup</code> (EL) or <code>/etc/apt/backup</code> (Debian / Ubuntu).</p><p>If you want to keep existing repo configurations during <code>bootstrap</code>, use the <code>-k|--keep</code> parameter.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./bootstrap -k <span style=color:#8f5902;font-style:italic># or --keep</span>
</span></span></code></pre></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-c38b3e7bce8cb65ffd26ccafa496eb5e>7 - Slim Installation</h1><div class=lead>Install only HA PostgreSQL clusters with minimal dependencies</div><p>If you only want HA PostgreSQL database cluster itself without monitoring, infra, etc., consider <strong>Slim Installation</strong>.</p><p>Slim installation has no <a href=/docs/infra/><strong><code>INFRA</code></strong></a> module, no monitoring, no <a href=/docs/setup/offline/><strong>local repo</strong></a>—just <a href=/docs/etcd/><strong><code>ETCD</code></strong></a> and <a href=/docs/pgsql/><strong><code>PGSQL</code></strong></a> and partial <a href=/docs/node/><strong><code>NODE</code></strong></a> functionality.</p><div class="alert alert-success" role=alert><div class="h4 alert-heading" role=heading>Slim installation is suitable for:</div><ul><li>Only needing PostgreSQL database itself, no observability infra required.</li><li>Extremely resource-constrained envs unwilling to bear infra overhead (~0.2 vCPU / 500MB on single node).</li><li>Already having external monitoring system, wanting to use your own unified monitoring framework.</li><li>Not wanting to introduce the AGPLv3-licensed Grafana visualization dashboard component.</div></li></ul><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>Limitations of slim installation:</div><ul><li>No <a href=/docs/infra><strong>INFRA</strong></a> module, cannot use WebUI and local software repo features.</li><li><a href=/docs/setup/offline><strong>Offline Install</strong></a> is limited to single-node mode; multi-node slim install can only be done online.</div></li></ul><hr><h2 id=overview>Overview</h2><p>To use slim installation, you need to:</p><ol><li>Use the <a href=/docs/conf/slim><strong><code>slim.yml</code></strong></a> slim install config template (<code>configure -c slim</code>)</li><li>Run the <code>slim.yml</code> playbook instead of the default <code>deploy.yml</code></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://repo.pigsty.io/get <span style=color:#000;font-weight:700>|</span> bash
</span></span><span style=display:flex><span>./configure -g -c slim
</span></span><span style=display:flex><span>./slim.yml
</span></span></code></pre></div><div id=asciinema-652aef58304c00ff1cb585f667a5397b class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-652aef58304c00ff1cb585f667a5397b",o="/demo/install-slim.cast",e="solarized-light",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[3,"Install"],[13,"Configure"],[22,"Deploy"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=description>Description</h2><p>Slim installation only installs/configures these components:</p><table class=full-width><thead><tr><th style=text-align:center>Component</th><th style=text-align:center>Required</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:center><strong><code>patroni</code></strong></td><td style=text-align:center>⚠️ Required</td><td style=text-align:left>Bootstrap HA PostgreSQL cluster</td></tr><tr><td style=text-align:center><strong><code>etcd</code></strong></td><td style=text-align:center>⚠️ Required</td><td style=text-align:left>Meta database dependency (DCS) for Patroni</td></tr><tr><td style=text-align:center><strong><code>pgbouncer</code></strong></td><td style=text-align:center>✔️ Optional</td><td style=text-align:left>PostgreSQL connection pooler</td></tr><tr><td style=text-align:center><strong><code>vip-manager</code></strong></td><td style=text-align:center>✔️ Optional</td><td style=text-align:left>L2 VIP binding to PostgreSQL cluster primary</td></tr><tr><td style=text-align:center><strong><code>haproxy</code></strong></td><td style=text-align:center>✔️ Optional</td><td style=text-align:left>Auto-routing <a href=/docs/pgsql/service/><strong>services</strong></a> via Patroni health checks</td></tr><tr><td style=text-align:center><strong><code>chronyd</code></strong></td><td style=text-align:center>✔️ Optional</td><td style=text-align:left>Time synchronization with NTP server</td></tr><tr><td style=text-align:center><strong><code>tuned</code></strong></td><td style=text-align:center>✔️ Optional</td><td style=text-align:left>Node tuning template and kernel parameter management</td></tr></tbody></table><p>You can disable all optional components via configuration, keeping only the required <code>patroni</code> and <code>etcd</code>.</p><p>Because there&rsquo;s no INFRA module&rsquo;s Nginx providing local repo service, <a href=/docs/setup/offline/><strong>offline installation</strong></a> only works in single-node mode.</p><hr><h2 id=configuration>Configuration</h2><p>Slim installation config file example: <a href=https://github.com/pgsty/pigsty/blob/main/conf/slim.yml><strong><code>conf/slim.yml</code></strong></a>:</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center><code>pg-meta-1</code></td><td style=text-align:center><strong>No INFRA module</strong></td><td style=text-align:center><code>etcd-1</code></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>---</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># File      :   slim.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Desc      :   Pigsty slim installation config template</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Ctime     :   2020-05-22</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Mtime     :   2025-12-28</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Docs      :   https://doc.pgsty.com/config</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># License   :   Apache-2.0 @ https://pigsty.io/docs/about/license/</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Copyright :   2018-2026  Ruohang Feng / Vonng (rh@vonng.com)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#==============================================================#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This is the config template for slim / minimal installation</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># No monitoring &amp; infra will be installed, just raw postgresql</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Usage:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#   curl https://repo.pigsty.io/get | bash</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#   ./configure -c slim</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#   ./slim.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># dcs service for postgres/patroni ha consensus</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># 1 node for testing, 3 or 5 for production</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># etcd_seq required</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>#10.10.10.11: { etcd_seq: 2 }  # assign from 1 ~ n</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>#10.10.10.12: { etcd_seq: 3 }  # odd number please</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># cluster level parameter override roles/etcd</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>etcd_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>etcd </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># mark etcd cluster name etcd</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># PostgreSQL Cluster</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>#10.10.10.11: { pg_seq: 2, pg_role: replica } # you can add more!</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#8f5902;font-style:italic>#10.10.10.12: { pg_seq: 3, pg_role: replica, pg_offline_query: true }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin   ] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta, baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>vector ]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># make a full backup every 1am</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>v4.0.0                  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pigsty version string</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>admin_ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.10</span><span style=color:#f8f8f8>             </span><span style=color:#8f5902;font-style:italic># admin node ip address</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>region: default                   # upstream mirror region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>default,china,europe</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>nodename_overwrite</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8>           </span><span style=color:#8f5902;font-style:italic># do not overwrite node hostname on single node mode</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_repo_modules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>node,infra,pgsql</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># add these repos directly to the singleton node</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>node_tune: oltp                     # node tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>oltp,olap,tiny,crit</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_conf: oltp.yml                   # pgsql tuning specs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#000>oltp,olap,tiny,crit}.yml</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>18</span><span style=color:#f8f8f8>                      </span><span style=color:#8f5902;font-style:italic># Default PostgreSQL Major Version is 18</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_packages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>pgsql-main, pgsql-common ]  </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># pg kernel and common utils</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#pg_extensions: [ pg18-time ,pg18-gis ,pg18-rag ,pg18-fts ,pg18-olap ,pg18-feat ,pg18-lang ,pg18-type ,pg18-util ,pg18-func ,pg18-admin ,pg18-stat ,pg18-sec ,pg18-fdw ,pg18-sim ,pg18-etl]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># PASSWORD : https://doc.pgsty.com/config/security</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic>#----------------------------------------------#</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>grafana_view_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Viewer</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.DBA</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_monitor_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Monitor</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_replication_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>DBUser.Replicator</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>patroni_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Patroni.API</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>haproxy_admin_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>minio_secret_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>S3User.MinIO</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd_root_password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Etcd.Root</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>...</span></span></span></code></pre></div><hr><h2 id=deployment>Deployment</h2><p>Slim installation uses the <a href=https://github.com/pgsty/pigsty/blob/main/slim.yml><code>slim.yml</code></a> playbook instead of <a href=https://github.com/pgsty/pigsty/blob/main/deploy.yml><code>deploy.yml</code></a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./slim.yml
</span></span></code></pre></div><hr><h2 id=ha-cluster>HA Cluster</h2><p>Slim installation can also deploy HA clusters—just add more nodes to the <code>etcd</code> and <code>pg-meta</code> groups. A three-node deployment example:</p><table class=full-width><thead><tr><th style=text-align:center>ID</th><th style=text-align:center><a href=/docs/node/>NODE</a></th><th style=text-align:center><a href=/docs/pgsql/>PGSQL</a></th><th style=text-align:center><a href=/docs/infra/>INFRA</a></th><th style=text-align:center><a href=/docs/etcd/><strong>ETCD</strong></a></th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center><code>10.10.10.10</code></td><td style=text-align:center><code>pg-meta-1</code></td><td style=text-align:center><strong>No INFRA module</strong></td><td style=text-align:center><code>etcd-1</code></td></tr><tr><td style=text-align:center>2</td><td style=text-align:center><code>10.10.10.11</code></td><td style=text-align:center><code>pg-meta-2</code></td><td style=text-align:center><strong>No INFRA module</strong></td><td style=text-align:center><code>etcd-2</code></td></tr><tr><td style=text-align:center>3</td><td style=text-align:center><code>10.10.10.12</code></td><td style=text-align:center><code>pg-meta-3</code></td><td style=text-align:center><strong>No INFRA module</strong></td><td style=text-align:center><code>etcd-3</code></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>etcd</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># &lt;-- New</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>etcd_seq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># &lt;-- New</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg-meta</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;-- New</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 3, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;-- New</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_users</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_meta ,password: DBUser.Meta   ,pgbouncer: true ,roles: [dbrole_admin   ] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pigsty admin user }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: dbuser_view ,password: DBUser.Viewer ,pgbouncer: true ,roles: [dbrole_readonly] ,comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>read-only viewer  }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>pg_databases</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>          </span>- {<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>name: meta, baseline: cmdb.sql ,comment: pigsty meta database ,schemas: [pigsty] ,extensions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#000>vector ]}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>        </span><span style=color:#204a87;font-weight:700>node_crontab</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;00 01 * * * postgres /pg/bin/pg-backup full&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># make a full backup every 1am</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># omitted ……</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-d6a656f7f8306b7de558a78bf1164ae0>8 - Security Tips</h1><div class=lead>Three security hardening tips for single-node quick-start deployment</div><p>For Demo/Dev single-node deployments, Pigsty&rsquo;s default config is secure enough as long as you <a href=#passwords><strong>change default passwords</strong></a>.</p><p>If your deployment is exposed to Internet or office network, consider adding <a href=#firewall><strong>firewall</strong></a> rules to restrict port access and source IPs for enhanced security.</p><p>Additionally, we recommend protecting Pigsty&rsquo;s <a href=#files><strong>critical files</strong></a> (config files and CA private key) from unauthorized access and backing them up regularly.</p><p>For enterprise prod envs with strict security requirements, refer to the <a href=/docs/deploy/security/><strong>Deployment - Security Hardening</strong></a> documentation for advanced configuration.</p><hr><h2 id=passwords>Passwords</h2><p>Pigsty is an open-source project with <strong>well-known default passwords</strong>. If your deployment is exposed to Internet or office network, you must change all default passwords!</p><table class=full-width><thead><tr><th style=text-align:center>Module</th><th>Parameter</th><th>Default Value</th></tr></thead><tbody><tr><td style=text-align:center><a href=/docs/infra><strong><code>INFRA</code></strong></a></td><td><a href=/docs/infra/param#grafana_admin_password><code>grafana_admin_password</code></a></td><td><code>pigsty</code></td></tr><tr><td style=text-align:center><a href=/docs/infra><strong><code>INFRA</code></strong></a></td><td><a href=/docs/infra/param#grafana_view_password><code>grafana_view_password</code></a></td><td><code>DBUser.Viewer</code></td></tr><tr><td style=text-align:center><a href=/docs/pgsql><strong><code>PGSQL</code></strong></a></td><td><a href=/docs/pgsql/param#pg_admin_password><code>pg_admin_password</code></a></td><td><code>DBUser.DBA</code></td></tr><tr><td style=text-align:center><a href=/docs/pgsql><strong><code>PGSQL</code></strong></a></td><td><a href=/docs/pgsql/param#pg_monitor_password><code>pg_monitor_password</code></a></td><td><code>DBUser.Monitor</code></td></tr><tr><td style=text-align:center><a href=/docs/pgsql><strong><code>PGSQL</code></strong></a></td><td><a href=/docs/pgsql/param#pg_replication_password><code>pg_replication_password</code></a></td><td><code>DBUser.Replicator</code></td></tr><tr><td style=text-align:center><a href=/docs/pgsql><strong><code>PGSQL</code></strong></a></td><td><a href=/docs/pgsql/param#patroni_password><code>patroni_password</code></a></td><td><code>Patroni.API</code></td></tr><tr><td style=text-align:center><a href=/docs/node><strong><code>NODE</code></strong></a></td><td><a href=/docs/node/param#haproxy_admin_password><code>haproxy_admin_password</code></a></td><td><code>pigsty</code></td></tr><tr><td style=text-align:center><a href=/docs/minio><strong><code>MINIO</code></strong></a></td><td><a href=/docs/minio/param#minio_secret_key><code>minio_secret_key</code></a></td><td><code>S3User.MinIO</code></td></tr><tr><td style=text-align:center><a href=/docs/etcd><strong><code>ETCD</code></strong></a></td><td><a href=/docs/etcd/param#etcd_root_password><code>etcd_root_password</code></a></td><td><code>Etcd.Root</code></td></tr></tbody></table><p>To avoid manually modifying passwords, Pigsty&rsquo;s <strong>configuration wizard</strong> provides automatic random strong password generation using the <code>-g</code> argument with <code>configure</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./configure -g
</span></span><span style=display:flex><span>configure pigsty v4.0.0 begin
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>region</span> <span style=color:#ce5c00;font-weight:700>=</span> china
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>WARN<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>kernel</span>  <span style=color:#ce5c00;font-weight:700>=</span> Darwin, can be used as admin node only
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>machine</span> <span style=color:#ce5c00;font-weight:700>=</span> arm64
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>package</span> <span style=color:#ce5c00;font-weight:700>=</span> brew <span style=color:#ce5c00;font-weight:700>(</span>macOS<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>WARN<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>primary_ip</span> <span style=color:#ce5c00;font-weight:700>=</span> default placeholder 10.10.10.10 <span style=color:#ce5c00;font-weight:700>(</span>macOS<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>mode</span> <span style=color:#ce5c00;font-weight:700>=</span> meta <span style=color:#ce5c00;font-weight:700>(</span>unknown distro<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>locale</span>  <span style=color:#ce5c00;font-weight:700>=</span> C.UTF-8
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> generating random passwords...
</span></span><span style=display:flex><span>    grafana_admin_password   : CdG0bDcfm3HFT9H2cvFuv9w7
</span></span><span style=display:flex><span>    pg_admin_password        : 86WqSGdokjol7WAU9fUxY8IG
</span></span><span style=display:flex><span>    pg_monitor_password      : 0X7PtgMmLxuCd2FveaaqBuX9
</span></span><span style=display:flex><span>    pg_replication_password  : 4iAjjXgEY32hbRGVUMeFH460
</span></span><span style=display:flex><span>    patroni_password         : DsD38QLTSq36xejzEbKwEqBK
</span></span><span style=display:flex><span>    haproxy_admin_password   : uhdWhepXrQBrFeAhK9sCSUDo
</span></span><span style=display:flex><span>    minio_secret_key         : z6zrYUN1SbdApQTmfRZlyWMT
</span></span><span style=display:flex><span>    etcd_root_password       : Bmny8op1li1wKlzcaAmvPiWc
</span></span><span style=display:flex><span>    DBUser.Meta              : U5v3CmeXICcMdhMNzP9JN3KY
</span></span><span style=display:flex><span>    DBUser.Viewer            : 9cGQF1QMNCtV3KlDn44AEzpw
</span></span><span style=display:flex><span>    S3User.Backup            : 2gjgSCFYNmDs5tOAiviCqM2X
</span></span><span style=display:flex><span>    S3User.Meta              : XfqkAKY6lBtuDMJ2GZezA15T
</span></span><span style=display:flex><span>    S3User.Data              : OygorcpCbV7DpDmqKe3G6UOj
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> random passwords generated, check and save them
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>ansible</span> <span style=color:#ce5c00;font-weight:700>=</span> ready
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span> OK <span style=color:#ce5c00;font-weight:700>]</span> pigsty configured
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>WARN<span style=color:#ce5c00;font-weight:700>]</span> don<span style=color:#a40000>&#39;</span>t forget to check it and change passwords!
</span></span><span style=display:flex><span>proceed with ./deploy.yml
</span></span></code></pre></div><hr><h2 id=firewall>Firewall</h2><p>For deployments exposed to Internet or office networks, we strongly recommend configuring <strong>firewall rules</strong> to limit access IP ranges and ports.</p><p>You can use your cloud provider&rsquo;s security group features, or Linux distribution firewall services (like <code>firewalld</code>, <code>ufw</code>, <code>iptables</code>, etc.) to implement this.</p><table class=full-width><thead><tr><th style=text-align:center>Direction</th><th style=text-align:center>Protocol</th><th>Port</th><th>Service</th><th>Description</th></tr></thead><tbody><tr><td style=text-align:center>Inbound</td><td style=text-align:center>TCP</td><td><strong>22</strong></td><td>SSH</td><td>Allow SSH login access</td></tr><tr><td style=text-align:center>Inbound</td><td style=text-align:center>TCP</td><td><strong>80</strong></td><td>Nginx</td><td>Allow Nginx HTTP access</td></tr><tr><td style=text-align:center>Inbound</td><td style=text-align:center>TCP</td><td><strong>443</strong></td><td>Nginx</td><td>Allow Nginx HTTPS access</td></tr><tr><td style=text-align:center>Inbound</td><td style=text-align:center>TCP</td><td><strong>5432</strong></td><td>PostgreSQL</td><td>Remote database access, enable as needed</td></tr></tbody></table><p>Pigsty supports configuring firewall rules to allow 22/80/443/5432 from external networks, but this is not enabled by default.</p><hr><h2 id=files>Files</h2><p>In Pigsty, you need to protect the following files:</p><ul><li><strong><code>pigsty.yml</code></strong>: Pigsty main config file, contains access information and passwords for all nodes</li><li><strong><code>files/pki/ca/ca.key</code></strong>: Pigsty self-signed CA private key, used to issue all SSL certificates in the deployment (auto-generated during deployment)</li></ul><p>We recommend strictly controlling access permissions for these two files, regularly backing them up, and storing them in a secure location.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email - Vonng" aria-label="Email - Vonng"><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label="Email - Vonng"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=WeChat aria-label=WeChat><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=WeChat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=Discussion><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Repo aria-label=Repo><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=Repo><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Architecture on PIGSTY</title><link>https://pigsty.io/docs/concept/arch/</link><description>Recent content in Architecture on PIGSTY</description><generator>Hugo</generator><language>en</language><atom:link href="https://pigsty.io/docs/concept/arch/index.xml" rel="self" type="application/rss+xml"/><item><title>Nodes</title><link>https://pigsty.io/docs/concept/arch/node/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pigsty.io/docs/concept/arch/node/</guid><description>&lt;p&gt;A &lt;strong&gt;node&lt;/strong&gt; is an abstraction of hardware resources and operating systems. It can be a physical machine, bare metal, virtual machine, or container/pod.&lt;/p&gt;
&lt;p&gt;Any machine running a &lt;a href="https://pigsty.io/docs/ref/linux"&gt;&lt;strong&gt;Linux OS&lt;/strong&gt;&lt;/a&gt; (with systemd daemon) and standard CPU/memory/disk/network resources can be treated as a node.&lt;/p&gt;
&lt;p&gt;Nodes can have &lt;a href="https://pigsty.io/docs/ref/module"&gt;&lt;strong&gt;modules&lt;/strong&gt;&lt;/a&gt; installed. Pigsty has several node types, distinguished by which modules are deployed:&lt;/p&gt;
&lt;table class="full-width"&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th style="text-align: center"&gt;Type&lt;/th&gt;
 &lt;th style="text-align: left"&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#regular-node"&gt;&lt;strong&gt;Regular Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;A node managed by Pigsty&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#admin-node"&gt;&lt;strong&gt;ADMIN Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;The node that runs Ansible to issue management commands&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#infra-node"&gt;&lt;strong&gt;INFRA Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Nodes with the &lt;a href="https://pigsty.io/docs/infra/"&gt;&lt;strong&gt;INFRA&lt;/strong&gt;&lt;/a&gt; module installed&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#etcd-node"&gt;&lt;strong&gt;ETCD Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Nodes with the &lt;a href="https://pigsty.io/docs/etcd/"&gt;&lt;strong&gt;ETCD&lt;/strong&gt;&lt;/a&gt; module for DCS&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#minio-node"&gt;&lt;strong&gt;MINIO Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Nodes with the &lt;a href="https://pigsty.io/docs/minio/"&gt;&lt;strong&gt;MINIO&lt;/strong&gt;&lt;/a&gt; module for object storage&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&lt;a href="#pgsql-node"&gt;&lt;strong&gt;PGSQL Node&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Nodes with the &lt;a href="https://pigsty.io/docs/pgsql/"&gt;&lt;strong&gt;PGSQL&lt;/strong&gt;&lt;/a&gt; module installed&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;&amp;hellip;&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Nodes with other modules&amp;hellip;&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In a &lt;a href="https://pigsty.io/docs/setup/install"&gt;&lt;strong&gt;singleton&lt;/strong&gt;&lt;/a&gt; Pigsty deployment, multiple roles converge on one node: it serves as the regular node, admin node, infra node, ETCD node, and database node simultaneously.&lt;/p&gt;</description></item><item><title>Infrastructure</title><link>https://pigsty.io/docs/concept/arch/infra/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pigsty.io/docs/concept/arch/infra/</guid><description>&lt;p&gt;Running production-grade, highly available PostgreSQL clusters typically requires a comprehensive set of infrastructure services (foundation) for support, such as monitoring and alerting, log collection, time synchronization, DNS resolution, and local software repositories.
Pigsty provides the &lt;a href="https://pigsty.io/docs/infra"&gt;&lt;strong&gt;INFRA module&lt;/strong&gt;&lt;/a&gt; to address this—it&amp;rsquo;s an &lt;strong&gt;optional module&lt;/strong&gt;, but we strongly recommend enabling it.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The diagram below shows the architecture of a &lt;a href="https://pigsty.io/docs/setup/install"&gt;&lt;strong&gt;single-node deployment&lt;/strong&gt;&lt;/a&gt;. The right half represents the components included in the &lt;a href="https://pigsty.io/docs/infra"&gt;&lt;strong&gt;INFRA module&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th style="text-align: left"&gt;Component&lt;/th&gt;
 &lt;th&gt;Type&lt;/th&gt;
 &lt;th style="text-align: left"&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#nginx"&gt;&lt;strong&gt;Nginx&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Web Server&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Unified entry for &lt;a href="https://pigsty.io/docs/setup/webui"&gt;&lt;strong&gt;WebUI&lt;/strong&gt;&lt;/a&gt;, &lt;a href="#repo"&gt;&lt;strong&gt;local repo&lt;/strong&gt;&lt;/a&gt;, reverse proxy for internal services&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#repo"&gt;&lt;strong&gt;Repo&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Software Repo&lt;/td&gt;
 &lt;td style="text-align: left"&gt;APT/DNF repository with all RPM/DEB packages needed for deployment&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#grafana"&gt;&lt;strong&gt;Grafana&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Visualization&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Displays metrics, logs, and traces; hosts dashboards, reports, and custom data apps&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#victoriametrics"&gt;&lt;strong&gt;VictoriaMetrics&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Time Series DB&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Scrapes all metrics, Prometheus API compatible, provides VMUI query interface&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#victorialogs"&gt;&lt;strong&gt;VictoriaLogs&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Log Platform&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Centralized log storage; all nodes run Vector by default, pushing logs here&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#victoriatraces"&gt;&lt;strong&gt;VictoriaTraces&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Tracing&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Collects slow SQL, service traces, and other tracing data&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#vmalert"&gt;&lt;strong&gt;VMAlert&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Alert Engine&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Evaluates alerting rules, pushes events to Alertmanager&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#alertmanager"&gt;&lt;strong&gt;AlertManager&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Alert Manager&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Aggregates alerts, dispatches notifications via email, Webhook, etc.&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#blackboxexporter"&gt;&lt;strong&gt;BlackboxExporter&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Blackbox Probe&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Probes reachability of IPs/VIPs/URLs&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#dnsmasq"&gt;&lt;strong&gt;DNSMASQ&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;DNS Service&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Provides DNS resolution for domains used within Pigsty [Optional]&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#chronyd"&gt;&lt;strong&gt;Chronyd&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Time Sync&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Provides NTP time synchronization to ensure consistent time across nodes [Optional]&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="https://pigsty.io/docs/concept/sec/ca"&gt;&lt;strong&gt;CA&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Certificate&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Issues encryption certificates within the environment&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="https://pigsty.io/docs/setup/playbook"&gt;&lt;strong&gt;Ansible&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Orchestration&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Batch, declarative, agentless tool for managing large numbers of servers&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href="https://pigsty.io/docs/infra/"&gt;&lt;img src="https://pigsty.io/img/pigsty/arch.png" alt="pigsty-arch"&gt;&lt;/a&gt;&lt;/p&gt;</description></item><item><title>PGSQL Arch</title><link>https://pigsty.io/docs/concept/arch/pgsql/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pigsty.io/docs/concept/arch/pgsql/</guid><description>&lt;p&gt;The PGSQL module organizes PostgreSQL in production as &lt;strong&gt;clusters&lt;/strong&gt;—&lt;strong&gt;logical entities&lt;/strong&gt; composed of a group of database &lt;strong&gt;instances&lt;/strong&gt; associated by &lt;strong&gt;primary-replica&lt;/strong&gt; relationships.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The &lt;a href="https://pigsty.io/docs/pgsql"&gt;&lt;strong&gt;PGSQL module&lt;/strong&gt;&lt;/a&gt; includes the following components, working together to provide production-grade PostgreSQL HA cluster services:&lt;/p&gt;
&lt;table class="full-width"&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th style="text-align: left"&gt;Component&lt;/th&gt;
 &lt;th&gt;Type&lt;/th&gt;
 &lt;th style="text-align: left"&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#postgresql"&gt;&lt;strong&gt;&lt;code&gt;postgres&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Database&lt;/td&gt;
 &lt;td style="text-align: left"&gt;The world&amp;rsquo;s most advanced open-source relational database, PGSQL core&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#patroni"&gt;&lt;strong&gt;&lt;code&gt;patroni&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;HA&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Manages PostgreSQL, coordinates failover, leader election, config changes&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#pgbouncer"&gt;&lt;strong&gt;&lt;code&gt;pgbouncer&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Pool&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Lightweight connection pooling middleware, reduces overhead, adds flexibility&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#pgbackrest"&gt;&lt;strong&gt;&lt;code&gt;pgbackrest&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Backup&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Full/incremental backup and WAL archiving, supports local and object storage&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#pg_exporter"&gt;&lt;strong&gt;&lt;code&gt;pg_exporter&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Metrics&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Exports PostgreSQL monitoring metrics for Prometheus scraping&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#pgbouncer_exporter"&gt;&lt;strong&gt;&lt;code&gt;pgbouncer_exporter&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Metrics&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Exports Pgbouncer connection pool metrics&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#pgbackrest_exporter"&gt;&lt;strong&gt;&lt;code&gt;pgbackrest_exporter&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;Metrics&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Exports backup status metrics&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: left"&gt;&lt;a href="#vip-manager"&gt;&lt;strong&gt;&lt;code&gt;vip-manager&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
 &lt;td&gt;VIP&lt;/td&gt;
 &lt;td style="text-align: left"&gt;Binds L2 VIP to current primary node for transparent failover [Optional]&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The &lt;a href="#vip-manager"&gt;&lt;strong&gt;&lt;code&gt;vip-manager&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; is an on-demand component. Additionally, PGSQL uses components from other modules:&lt;/p&gt;</description></item></channel></rss>
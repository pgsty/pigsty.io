{"version":3,"term":{"cols":120,"rows":30,"type":"xterm-256color","version":"iTerm2 3.5.14","theme":{"fg":"#697a82","bg":"#fcf7e5","palette":"#163540:#cb4238:#89982d:#ae8b2c:#4689cd:#c34380:#519f98:#ede9d7:#0d2a34:#bc5329:#5c6d74:#697a82:#869496:#6d71bf:#96a1a1:#fcf7e5"}},"timestamp":1768185514,"idle_time_limit":0.5,"title":"pgsql-shrink","env":{"SHELL":"/bin/bash"}}
[0.013, "o", "\u001b[?2004h\u001b]0;vonng@vonng-aimax: ~/pigsty\u0007\u001b[01;32mvonng@vonng-aimax\u001b[00m:\u001b[01;34m~/pigsty\u001b[00m$ "]
[0.373, "o", "\u001b[7mbin/pgsql-rm  pg-test 10.10.10.13\u001b[27m"]
[0.242, "o", "\r\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[C\u001b[Cbin/pgsql-rm  pg-test 10.10.10.13\r\n\u001b[?2004l\r"]
[0.005, "o", "\u001b[0;35m[PLANNING] ===========================================\u001b[0m\r\n[\u001b[0;32m OK \u001b[0m] \u001b[0;32mremove pgsql instances from  10.10.10.13 of 'pg-test':\u001b[0m\r\n[\u001b[0;33mWARN\u001b[0m] \u001b[0;33m  remove instances from cluster:\u001b[0m\r\n"]
[0.000, "o", "[\u001b[0;32m OK \u001b[0m] \u001b[0;32m    $ ./pgsql-rm.yml -l '10.10.10.13,&pg-test'\u001b[0m\r\n\u001b[0;35m[EXECUTE] ===========================================\u001b[0m\r\n"]
[0.000, "o", "[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mremove pgsql instances  10.10.10.13 from pg-test\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;34m$ ./pgsql-rm.yml -l '10.10.10.13,&pg-test'\u001b[0m\r\n"]
[0.250, "o", "\r\nPLAY [PGSQL REMOVE] ****************************************************************************************************\r\n"]
[0.009, "o", "\r\nTASK [node_id : get node fact] *****************************************************************************************\r\n"]
[0.624, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : set node fact] *****************************************************************************************\r\n"]
[0.019, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : fill empty nodename with hostname] *********************************************************************\r\n"]
[0.016, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_id : build node identity] ***********************************************************************************\r\n"]
[0.021, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_id : load roles/node_id/vars/u24.x86_64.yml] ****************************************************************\r\n"]
[0.016, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_id : fallback to u24.x86_64.yml if u24.x86_64.yml not exists] ***********************************************\r\n"]
[0.008, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : print node identity] ***********************************************************************************\r\n"]
[0.017, "o", "\u001b[0;32mok: [10.10.10.13] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"nodename: pg-test-3, node_cluster: pg-test, spec: c4m8, os: ubuntu.24.x86_64 u24:deb,   [PGSQL: pg-test] [REDIS: redis-test]    \"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : ABORT due to pg_safeguard enabled] *******************************************************************\r\n"]
[0.013, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pgsql target from victoria] *******************************************************************\r\n"]
[0.647, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : remove ssl patroni target from victoria] *************************************************************\r\n"]
[0.017, "o", "\u001b[0;36mskipping: [10.10.10.13] => (item=10.10.10.10) \u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pg vip ping target from victoria] *************************************************************\r\n"]
[0.164, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : include_tasks] ***************************************************************************************\r\n"]
[0.020, "o", "\u001b[0;36mincluded: /data/pgsty/pigsty/roles/pg_remove/tasks/grafana.yml for 10.10.10.13 => (item={'name': 'postgres'})\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mincluded: /data/pgsty/pigsty/roles/pg_remove/tasks/grafana.yml for 10.10.10.13 => (item={'name': 'test'})\u001b[0m\r\n"]
[0.013, "o", "\r\nTASK [pg_remove : remove grafana datasource postgres] ******************************************************************\r\n"]
[0.173, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.004, "o", "\r\nTASK [pg_remove : remove grafana datasource test] **********************************************************************\r\n"]
[0.171, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : stop and disable pg_exporter service] ****************************************************************\r\n"]
[0.611, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pg_exporter config file] **********************************************************************\r\n"]
[0.120, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/default/pg_exporter)\u001b[0m\r\n"]
[0.110, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/pg_exporter.yml)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : stop and disable pgbouncer_exporter service] *********************************************************\r\n"]
[0.518, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pgbouncer_exporter config file] ***************************************************************\r\n"]
[0.123, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/default/pgbouncer_exporter)\u001b[0m\r\n"]
[0.111, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/pgbouncer_exporter.yml)\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : stop and disable pgbackrest_exporter service] ********************************************************\r\n"]
[0.522, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : remove pgbackrest_exporter config file] **************************************************************\r\n"]
[0.120, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pgsql cluster dns for primary] ****************************************************************\r\n"]
[0.008, "o", "\u001b[0;36mskipping: [10.10.10.13] => (item=10.10.10.10) \u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : remove pgsql instance dns] ***************************************************************************\r\n"]
[0.151, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : stop and disable vip-manager service] ****************************************************************\r\n"]
[1.507, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove vip-manager config file] **********************************************************************\r\n"]
[1.120, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : wipe existing postgres haproxy service] **************************************************************\r\n"]
[1.122, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : check haproxy config before reload] ******************************************************************\r\n"]
[1.155, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : reload haproxy] **************************************************************************************\r\n"]
[1.465, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : wipe existing postgres haproxy service] **************************************************************\r\n"]
[0.006, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : check haproxy config before reload] ******************************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : reload haproxy] **************************************************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : stop and disable pgbouncer service] ******************************************************************\r\n"]
[1.953, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : remove pgbouncer config data] ************************************************************************\r\n"]
[1.115, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : stop postgres replica services with timeout] *********************************************************\r\n"]
[4.232, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : stop postgres primary services with timeout] *********************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove postgres metadata from etcd] ******************************************************************\r\n"]
[0.006, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : stop pgbackrest and delete stanza with timeout] ******************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove local postgres backup dir] ********************************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_remove : remove postgres backup config] ***********************************************************************\r\n"]
[1.116, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/pgbackrest/pgbackrest.conf)\u001b[0m\r\n"]
[1.111, "o", "\u001b[0;32mok: [10.10.10.13] => (item=/etc/pgbackrest/initial.done)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : remove postgres data] ********************************************************************************\r\n"]
[1.184, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/pg/data)\u001b[0m\r\n"]
[1.109, "o", "\u001b[0;32mok: [10.10.10.13] => (item=/data/postgres/postgres)\u001b[0m\r\n"]
[0.003, "o", "\r\nTASK [pg_remove : remove postgres environ] *****************************************************************************\r\n"]
[1.126, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/profile.d/pgsql.sh)\u001b[0m\r\n"]
[1.111, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=/etc/profile.d/pg-alias.sh)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : lookup pg packages & extensions names] ***************************************************************\r\n"]
[0.014, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pg_remove : uninstall pg extensions] *****************************************************************************\r\n"]
[0.009, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : uninstall pg packages] *******************************************************************************\r\n"]
[5.379, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=postgresql-18,postgresql-client-18,postgresql-plpython3-18,postgresql-plperl-18,postgresql-pltcl-18,postgresql-18-repack,postgresql-18-wal2json,postgresql-18-pgvector,patroni,python3-etcd,pgbouncer,pgbackrest,pg-exporter,pgbackrest-exporter,vip-manager)\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : remove pgsql vector logging config] ******************************************************************\r\n"]
[1.119, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_remove : reload vector to discard pgsql log] ******************************************************************\r\n"]
[1.368, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nPLAY RECAP *************************************************************************************************************\r\n"]
[0.000, "o", "\u001b[0;33m10.10.10.13\u001b[0m                : \u001b[0;32mok=33  \u001b[0m \u001b[0;33mchanged=25  \u001b[0m unreachable=0    failed=0    \u001b[0;36mskipped=13  \u001b[0m rescued=0    ignored=0   \r\n"]
[0.000, "o", "\r\n"]
[0.053, "o", "[\u001b[0;32m OK \u001b[0m] \u001b[0;32mremove pgsql instances from ' 10.10.10.13 of pg-test complete\u001b[0m\r\n\u001b[0;35m[SUMMARY] ===========================================\u001b[0m\r\n[\u001b[0;32m OK \u001b[0m] \u001b[0;32mremove pgsql instances from  10.10.10.13 of pg-test success\u001b[0m\r\n[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mnodes will not be removed from pigsty, to do so:\u001b[0m\r\n\u001b[0;34m$ bin/node-rm  10.10.10.13\u001b[0m\r\n"]
[0.000, "o", "[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mplease adjust your inventory accordingly\u001b[0m\r\n\u001b[0;34mremove  10.10.10.13  from inventory: all.children.pg-test.hosts\u001b[0m\r\n"]
[0.000, "o", "[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mthen refresh pg_service with updated inventory\u001b[0m\r\n\u001b[0;34m$ bin/pgsql-svc pg-test\u001b[0m\r\n"]
[0.000, "o", "\u001b[?2004h\u001b]0;vonng@vonng-aimax: ~/pigsty\u0007\u001b[01;32mvonng@vonng-aimax\u001b[00m:\u001b[01;34m~/pigsty\u001b[00m$ "]
[2.926, "o", "\u001b[7mbin/node-rm   10.10.10.13\u001b[27m"]
[0.754, "o", "\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\bbin/node-rm   10.10.10.13"]
[0.876, "o", "\r\n\u001b[?2004l\r"]
[0.005, "o", "\u001b[0;35m[EXECUTE] ===========================================\u001b[0m\r\n[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mMAKE SURE ALL MODULES ON THAT NODE WERE REMOVED!\u001b[0m\r\n[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mremove node  10.10.10.13  from pigsty\u001b[0m\r\n\u001b[0;34m$ ./node.yml -l '10.10.10.13'\u001b[0m\r\n"]
[0.232, "o", "\r\nPLAY [NODE REMOVE] *****************************************************************************************************\r\n"]
[0.006, "o", "\r\nTASK [node_id : get node fact] *****************************************************************************************\r\n"]
[0.189, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : set node fact] *****************************************************************************************\r\n"]
[0.020, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : fill empty nodename with hostname] *********************************************************************\r\n"]
[0.015, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_id : build node identity] ***********************************************************************************\r\n"]
[0.022, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_id : load roles/node_id/vars/u24.x86_64.yml] ****************************************************************\r\n"]
[0.015, "o", "\u001b[0;32mok: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_id : fallback to u24.x86_64.yml if u24.x86_64.yml not exists] ***********************************************\r\n"]
[0.008, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_id : print node identity] ***********************************************************************************\r\n"]
[0.018, "o", "\u001b[0;32mok: [10.10.10.13] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"nodename: pg-test-3, node_cluster: pg-test, spec: c4m8, os: ubuntu.24.x86_64 u24:deb,   [PGSQL: pg-test] [REDIS: redis-test]    \"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove node target from victoria] ******************************************************************\r\n"]
[0.196, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : remove docker target from victoria] ****************************************************************\r\n"]
[0.160, "o", "\u001b[0;32mok: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove node ping target from victoria] *************************************************************\r\n"]
[0.158, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : remove vip ping target from victoria] **************************************************************\r\n"]
[0.018, "o", "\u001b[0;36mskipping: [10.10.10.13] => (item=10.10.10.10) \u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_remove : remove node vip dns record] ************************************************************************\r\n"]
[0.015, "o", "\u001b[0;36mskipping: [10.10.10.13] => (item=10.10.10.10) \u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove haproxy upstream from nginx] ****************************************************************\r\n"]
[0.157, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : remove haproxy url location from nginx] ************************************************************\r\n"]
[0.157, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : reload nginx to remove haproxy upstream] ***********************************************************\r\n"]
[0.504, "o", "\u001b[0;33mchanged: [10.10.10.13 -> 10.10.10.10] => (item=10.10.10.10)\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : stop and disable keepalived service] ***************************************************************\r\n"]
[0.015, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_remove : stop and disable haproxy] **************************************************************************\r\n"]
[1.775, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_remove : remove haproxy config dir] *************************************************************************\r\n"]
[1.118, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : stop and disable node_exporter service] ************************************************************\r\n"]
[1.509, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_remove : stop and disable keepalived_exporter service] ******************************************************\r\n"]
[0.016, "o", "\u001b[0;36mskipping: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove node vector logging config] *****************************************************************\r\n"]
[1.116, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : reload vector to discard node log] *****************************************************************\r\n"]
[1.372, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : stop vector service] *******************************************************************************\r\n"]
[1.509, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove vector persist data] ************************************************************************\r\n"]
[1.128, "o", "\u001b[0;33mchanged: [10.10.10.13]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_remove : remove node etc profile] ***************************************************************************\r\n"]
[1.128, "o", "\u001b[0;33mchanged: [10.10.10.13] => (item=node.sh)\u001b[0m\r\n"]
[1.111, "o", "\u001b[0;32mok: [10.10.10.13] => (item=node.alias.sh)\u001b[0m\r\n"]
[0.002, "o", "\r\nPLAY RECAP *************************************************************************************************************\r\n"]
[0.000, "o", "\u001b[0;33m10.10.10.13\u001b[0m                : \u001b[0;32mok=19  \u001b[0m \u001b[0;33mchanged=14  \u001b[0m unreachable=0    failed=0    \u001b[0;36mskipped=6   \u001b[0m rescued=0    ignored=0   \r\n"]
[0.000, "o", "\r\n"]
[0.044, "o", "\u001b[0;35m[SUMMARY] ===========================================\u001b[0m\r\n[\u001b[0;32m OK \u001b[0m] \u001b[0;32mremove node 10.10.10.13 from pigsty complete\u001b[0m\r\n"]
[0.000, "o", "\u001b[?2004h\u001b]0;vonng@vonng-aimax: ~/pigsty\u0007\u001b[01;32mvonng@vonng-aimax\u001b[00m:\u001b[01;34m~/pigsty\u001b[00m$ "]
[0.851, "o", "\u001b[7mvi pigsty.yml \u001b[27m"]
[0.991, "o", "\b\b\b\b\b\b\b\b\b\b\b\b\b\bvi pigsty.yml "]
[0.290, "o", "\r\n\u001b[?2004l\r"]
[0.009, "o", "\u001b[?1049h\u001b[22;0;0t\u001b[>4;2m\u001b[?1h\u001b=\u001b[?2004h\u001b[?1004h\u001b[1;30r\u001b[?12h\u001b[?12l\u001b[22;2t\u001b[22;1t"]
[0.001, "o", "\u001b[27m\u001b[23m\u001b[29m\u001b[m\u001b[H\u001b[2J\u001b[?25l\u001b[30;1H\"pigsty.yml\""]
[0.000, "o", " 180L, 9815B"]
[0.001, "o", "\u001b[2;1Hâ–½\u001b[6n\u001b[2;1H  \u001b[3;1H\u001bPzz\u001b\\\u001b[0%m\u001b[6n\u001b[3;1H           \u001b[1;1H\u001b[>c\u001b]10;?\u0007\u001b]11;?\u0007"]
[0.007, "o", "\u001b[1;9H\u001b[36mpg_vip_address\u001b[m\u001b[35m:\u001b[m 10.10.10.2/24\r\n        \u001b[36mpg_vip_interface\u001b[m\u001b[35m:\u001b[m eth1\u001b[2;31H\u001b[K\u001b[3;1H        \u001b[36mnode_crontab\u001b[m\u001b[35m:\u001b[m \u001b[34m # make a full backup 1 am everyday\u001b[m\u001b[3;58H\u001b[K\u001b[4;11H\u001b[38;5;130m- \u001b[m\u001b[31m'00 01 * * * postgres /pg/bin/pg-backup full'\u001b[m\u001b[6;4H\u001b[34m # pgsql 3 node ha cluster: pg-test\u001b[m\r\n    \u001b[36mpg-test\u001b[m\u001b[35m:\u001b[m\u001b[8;7H\u001b[36mhosts\u001b[m\u001b[35m:\u001b[m\u001b[9;9H\u001b[36m10.10.10.11\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mpg_seq\u001b[m\u001b[35m:\u001b[m \u001b[31m1\u001b[m, \u001b[36mpg_role\u001b[m\u001b[35m:\u001b[m primary \u001b[35m}\u001b[m  \u001b[34m # primary instance, leader of cluster\u001b[m\u001b[10;9H\u001b[36m10.10.10.12\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mpg_seq\u001b[m\u001b[35m:\u001b[m \u001b[31m2\u001b[m, \u001b[36mpg_role\u001b[m\u001b[35m:\u001b[m replica \u001b[35m}\u001b[m  \u001b[34m # replica instance, follower of leader\u001b[m\u001b[11;9H\u001b[36m10.10.10.13\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mpg_seq\u001b[m\u001b[35m:\u001b[m \u001b[31m3\u001b[m, \u001b[36mpg_role\u001b[m\u001b[35m:\u001b[m replica, \u001b[36mpg_offline_query\u001b[m\u001b[35m:\u001b[m \u001b[31mtrue\u001b[m \u001b[35m}\u001b[m\u001b[34m # replica with offline access\u001b[m\u001b[12;7H\u001b[36mvars\u001b[m\u001b[35m:\u001b[m\u001b[13;9H\u001b[36mpg_cluster\u001b[m\u001b[35m:\u001b[m pg-test\u001b[10C\u001b[34m # define pgsql cluster name\u001b[m\u001b[14;9H\u001b[36mpg_users\u001b[m\u001b[35m:\u001b[m  \u001b[35m[{\u001b[m \u001b[36mname\u001b[m\u001b[35m:\u001b[m test , \u001b[36mpassword\u001b[m\u001b[35m:\u001b[m test , \u001b[36mpgbouncer\u001b[m\u001b[35m:\u001b[m \u001b[31mtrue\u001b[m , \u001b[36mroles\u001b[m\u001b[35m:\u001b[m \u001b[35m[\u001b[m dbrole_admin \u001b[35m]\u001b[m \u001b[35m}]\u001b[m\u001b[15;9H\u001b[36mpg_databases\u001b[m\u001b[35m:\u001b[m \u001b[35m\u001b[106m[\u001b[m\u001b[35m{\u001b[m \u001b[36mname\u001b[m\u001b[35m:\u001b[m test \u001b[35m}\u001b[m\u001b[35m\u001b[106m]\u001b[m\u001b[16;9H\u001b[36mpg_vip_enabled\u001b[m\u001b[35m:\u001b[m \u001b[31mtrue\u001b[m\u001b[17;9H\u001b[36mpg_vip_address\u001b[m\u001b[35m:\u001b[m 10.10.10.3/24\u001b[18;9H\u001b[36mpg_vip_interface\u001b[m\u001b[35m:\u001b[m eth1\u001b[19;9H\u001b[36mnode_crontab\u001b[m\u001b[35m:\u001b[m \u001b[34m # make a full backup on monday 1am, and an incremental backup during weekdays\u001b[m\u001b[20;11H\u001b[38;5;130m- \u001b[m\u001b[31m'00 01 * * 1 postgres /pg/bin/pg-backup full'\u001b[m\u001b[21;11H\u001b[38;5;130m- \u001b[m\u001b[31m'00 01 * * 2,3,4,5,6,7 postgres /pg/bin/pg-backup'\u001b[m\u001b[23;4H\u001b[34m #----------------------------------#\r\n\u001b[m   \u001b[34m # redis ms, sentinel, native cluster\r\n\u001b[m   \u001b[34m #----------------------------------#\u001b[m\r\n    \u001b[36mredis-ms"]
[0.002, "o", "\u001b[m\u001b[35m:\u001b[m\u001b[34m # redis classic primary & replica\u001b[m\u001b[27;7H\u001b[36mhosts\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36m10.10.10.10\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mredis_node\u001b[m\u001b[35m:\u001b[m \u001b[31m1\u001b[m , \u001b[36mredis_instances\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36m6379\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[35m}\u001b[m, \u001b[36m6380\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mreplica_of\u001b[m\u001b[35m:\u001b[m \u001b[31m'10.10.10.10 6379'\u001b[m \u001b[35m}\u001b[m \u001b[35m}\u001b[m \u001b[35m}}\u001b[m\u001b[28;1H \u001b[35m}\u001b[m\u001b[29;7H\u001b[36mvars\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mredis_cluster\u001b[m\u001b[35m:\u001b[m redis-ms ,\u001b[36mredis_password\u001b[m\u001b[35m:\u001b[m \u001b[31m'redis.ms'\u001b[m ,\u001b[36mredis_max_memory\u001b[m\u001b[35m:\u001b[m 64MB \u001b[35m}\u001b[m\u001b[30;103H75,38\u001b[9C39%\u001b[15;38H\u001b[?25h\u001b[?4m"]
[0.066, "o", "\u001bP+q436f\u001b\\\u001bP+q6b75\u001b\\\u001bP+q6b64\u001b\\\u001bP+q6b72\u001b\\\u001bP+q6b6c\u001b\\\u001bP+q2332\u001b\\\u001bP+q2334\u001b\\\u001bP+q2569\u001b\\\u001bP+q2a37\u001b\\\u001bP+q6b31\u001b\\\u001bP$q q\u001b\\\u001b[?12$p"]
[0.018, "o", "\u001bP+q6b32\u001b\\\u001bP+q6b33\u001b\\\u001bP+q6b34\u001b\\"]
[0.000, "o", "\u001b[?25l\u001b[30;93H7\u001b[15;38H\u001b[30;94H2\u001b[15;38H\u001b[30;95H=\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97HB\u001b[15;38H\u001b[30;98H4\u001b[15;38H\u001b[30;99HF\u001b[15;38H\u001b[30;100H4\u001b[15;38H\u001b[30;101H3\u001b[15;38H\u001b[30;93H2=1B4F43^[\u001b[15;38H"]
[0.000, "o", "\u001b[30;93H          \u001b[15;38H\u001bP+q6b35\u001b\\"]
[0.000, "o", "\u001bP+q6b36\u001b\\\u001bP+q6b37\u001b\\"]
[0.000, "o", "\u001b[30;93H^[\u001b[15;38H\u001b[30;95HP\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97H+\u001b[15;38H\u001b[30;93H     \u001b[15;38H\u001bP+q6b38\u001b\\\u001bP+q6b39\u001b\\"]
[0.000, "o", "\u001b[30;93H1\u001b[15;38H\u001b[30;94H+\u001b[15;38H\u001b[30;95Hr\u001b[15;38H\u001b[30;96H2\u001b[15;38H\u001b[30;97HA\u001b[15;38H\u001b[30;98H3\u001b[15;38H\u001b[30;99H7\u001b[15;38H\u001b[30;100H=\u001b[15;38H\u001b[30;101H1\u001b[15;38H\u001b[30;102HB\u001b[15;38H\u001b[30;93H          \u001b[15;38H\u001bP+q6b3b\u001b\\"]
[0.000, "o", "\u001bP+q4631\u001b\\"]
[0.000, "o", "\u001b[?25h"]
[0.017, "o", "\u001bP+q4632\u001b\\\u001bP+q2531\u001b\\\u001bP+q2638\u001b\\\u001b[?25l\u001b[30;93H^[\u001b[15;38H\u001b[30;95HP\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97H+\u001b[15;38H\u001b[30;98Hr\u001b[15;38H\u001b[30;93H      \u001b[15;38H\u001bP+q6b62\u001b\\"]
[0.000, "o", "\u001bP+q6b49\u001b\\\u001bP+q6b44\u001b\\"]
[0.000, "o", "\u001b[30;93H^[\u001b[15;38H\u001b[30;95HP\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97H+\u001b[15;38H\u001b[30;98Hr\u001b[15;38H\u001b[30;99H6\u001b[15;38H\u001b[30;100HB\u001b[15;38H\u001b[30;101H3\u001b[15;38H\u001b[30;93H         \u001b[15;38H\u001bP+q6b68\u001b\\"]
[0.000, "o", "\u001bP+q4037\u001b\\\u001bP+q6b50\u001b\\"]
[0.000, "o", "\u001b[30;93H^[\u001b[15;38H\u001b[30;95HP\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97H+\u001b[15;38H\u001b[30;98Hr\u001b[15;38H\u001b[30;99H4\u001b[15;38H\u001b[30;100H6\u001b[15;38H\u001b[30;101H3\u001b[15;38H\u001b[30;102H1\u001b[15;38H\u001b[30;93H[P1+r4631=\u001b[15;38H\u001b[30;93H          \u001b[15;38H\u001bP+q6b4e\u001b\\\u001b[?25h"]
[0.016, "o", "\u001bP+q4b31\u001b\\\u001bP+q4b33\u001b\\\u001bP+q4b34\u001b\\\u001bP+q4b35\u001b\\"]
[0.026, "o", "\u001bP+q6b42\u001b\\\u001bP+q5053\u001b\\\u001bP+q5045\u001b\\"]
[0.000, "o", "\u001b[?25l\u001b[30;93H^[\u001b[15;38H\u001b[30;95HP\u001b[15;38H\u001b[30;96H1\u001b[15;38H\u001b[30;97H+\u001b[15;38H\u001b[30;98Hr\u001b[15;38H\u001b[30;99H6\u001b[15;38H\u001b[30;100HB\u001b[15;38H\u001b[30;101H5\u001b[15;38H"]
[0.000, "o", "\u001b[30;93H         \u001b[15;38H\u001b[?25h"]
[0.898, "o", "\u001b[?25l\u001b[30;93Hj\u001b[15;38H"]
[0.001, "o", "\u001b[30;93H \u001b[16;28H\u001b[15;23H\u001b[35m[\u001b[14C]\u001b[m\u001b[30;104H6,2\u001b[16;28H\u001b[?25h"]
[0.364, "o", "\u001b[?25l\u001b[30;93Hk\u001b[16;28H"]
[0.002, "o", "\u001b[30;93H \u001b[15;38H\u001b[15;23H\u001b[35m\u001b[106m[\u001b[14C]\u001b[m\u001b[30;104H5,3\u001b[15;38H\u001b[?25h"]
[0.259, "o", "\u001b[?25l\u001b[30;93Hk\u001b[15;38H"]
[0.001, "o", "\u001b[30;93H \u001b[14;38H\u001b[15;23H\u001b[35m[\u001b[14C]\u001b[m\u001b[30;104H4\u001b[14;38H\u001b[?25h"]
[0.041, "o", "\u001b[?25l\u001b[30;93Hk\u001b[14;38H"]
[0.000, "o", "\u001b[30;93H \u001b[13;38H\u001b[30;104H3\u001b[13;38H\u001b[?25h"]
[0.023, "o", "\u001b[?25l\u001b[30;93Hk\u001b[13;38H"]
[0.000, "o", "\u001b[30;93H \u001b[12;11H\u001b[30;104H2,11\u001b[12;11H\u001b[?25h"]
[0.048, "o", "\u001b[?25l\u001b[30;93Hk\u001b[12;11H"]
[0.000, "o", "\u001b[30;93H \u001b[11;38H\u001b[30;104H1,38\u001b[11;38H\u001b[?25h"]
[0.021, "o", "\u001b[?25l\u001b[30;93Hk\u001b[11;38H"]
[0.000, "o", "\u001b[30;93H \u001b[10;38H\u001b[30;104H0\u001b[10;38H\u001b[?25h"]
[0.515, "o", "\u001b[?25l\u001b[30;93Hj\u001b[10;38H"]
[0.001, "o", "\u001b[30;93H \u001b[11;38H\u001b[30;104H1\u001b[11;38H\u001b[?25h"]
[1.420, "o", "\u001b[?25l\u001b[30;93Hh\u001b[11;38H"]
[0.000, "o", "\u001b[30;93H \u001b[11;37H\u001b[30;107H7\u001b[11;37H\u001b[?25h"]
[0.309, "o", "\u001b[?25l\u001b[30;93Hd\u001b[11;37H"]
[0.000, "o", "\u001b[?25h"]
[0.116, "o", "\u001b[?25l\u001b[30;94Hd\u001b[11;37H"]
[0.001, "o", "\u001b[30;93H  \u001b[11;7H\u001b[11;29r\u001b[29;1H\r\n\u001b[1;30r\u001b[30;1H\u001b[K\u001b[30;103H71,7\u001b[10C39%\u001b[11;7H\u001b[?25h"]
[0.563, "o", "\u001b[?25l\u001b[30;93Hu\u001b[11;7H"]
[0.001, "o", "\u001b[30;1H1 more line; before #1  1 second ago\u001b[30;93H\u001b[K"]
[0.001, "o", "\u001b[11;9H\u001b[11;29r\u001b[11;1H\u001b[L\u001b[1;30r\u001b[11;9H\u001b[36m10.10.10.13\u001b[m\u001b[35m:\u001b[m \u001b[35m{\u001b[m \u001b[36mpg_seq\u001b[m\u001b[35m:\u001b[m \u001b[31m3\u001b[m, \u001b[36mpg_role\u001b[m\u001b[35m:\u001b[m replica, \u001b[36mpg_offline_query\u001b[m\u001b[35m:\u001b[m \u001b[31mtrue\u001b[m \u001b[35m}\u001b[m\u001b[34m # replica with offline access\u001b[m\u001b[30;1H\u001b[K\u001b[30;103H71,9\u001b[10C39%\r1 more line; before #1  1 second ago\u001b[30;103H\u001b[K\u001b[30;103H71,9\u001b[10C39%\u001b[11;9H\u001b[?25h"]
[0.306, "o", "\u001b[?25l\u001b[30;93Hh\u001b[11;9H"]
[0.000, "o", "\u001b[30;93H \u001b[11;8H\u001b[30;106H8\u001b[11;8H\u001b[?25h"]
[0.317, "o", "\u001b[?25l\u001b[30;93Hl\u001b[11;8H"]
[0.000, "o", "\u001b[30;93H \u001b[11;9H\u001b[30;106H9\u001b[11;9H\u001b[?25h"]
[0.142, "o", "\u001b[?25l\u001b[30;93Hi\u001b[11;9H"]
[0.000, "o", "\u001b[30;93H \u001b[11;9H\u001b[30;1H\u001b[1m-- INSERT --\u001b[m\u001b[30;14H\u001b[K\u001b[30;103H71,9\u001b[10C39%\u001b[11;9H\u001b[?25h"]
[0.287, "o", "\u001b[?25l \u001b[34m #10.10.10.13: { pg_seq: 3, pg_role: replica, pg_offline_query: true } # replica with offline access\u001b[m\u001b[30;106H12\u001b[11;12H\u001b[?25h"]
[0.245, "o", "\u001b[30;1H\u001b[K\u001b[11;11H\u001b[?25l\u001b[30;93H^[\u001b[11;11H"]
[0.100, "o", "\u001b[30;93H  \u001b[11;12H"]
[0.000, "o", "\u001b[30;103H71,11\u001b[9C39%\u001b[11;11H\u001b[?25h"]
[0.497, "o", "\u001b[?25l\u001b[30;93H~@k\u001b[11;11H"]
[0.001, "o", "\u001b[30;93H   \u001b[11;10H\u001b[30;107H0\u001b[11;10H\u001b[?25h"]
[0.398, "o", "\u001b[?25l\u001b[30;93H~@k\u001b[11;10H"]
[0.000, "o", "\u001b[30;93H   \u001b[11;9H\u001b[30;106H9 \u001b[11;9H\u001b[?25h"]
[0.256, "o", "\u001b[?25l\u001b[30;93Hx\u001b[11;9H\u001b[30;93H \u001b[11;9H\u001b[30;93Hdl\u001b[11;9H"]
[0.000, "o", "\u001b[30;93H  \u001b[11;9H\u001b[34m #10.10.10.13: { pg_seq: 3, pg_role: replica, pg_offline_query: true } # replica with offline acces\u001b[m\u001b[11;109H\u001b[K\u001b[11;9H\u001b[?25h"]
[0.109, "o", "\u001b[?25l\u001b[30;93Hx\u001b[11;9H\u001b[30;93H \u001b[11;9H\u001b[30;93Hdl\u001b[11;9H"]
[0.001, "o", "\u001b[30;93H  \u001b[11;9H\b\u001b[34m #10.10.10.13: { pg_seq: 3, pg_role: replica, pg_offline_query: true } # replica with offline acces\u001b[m\u001b[11;108H\u001b[K\u001b[11;9H\u001b[?25h"]
[0.264, "o", "\u001b[?25l\u001b[30;93H^[\u001b[11;9H"]
[0.100, "o", "\u001b[30;93H  \u001b[11;9H\u001b[30;93H^[\u001b[11;9H\u0007\u001b[30;93H  \u001b[11;9H\u001b[?25h"]
[0.273, "o", "\u001b[?25l\u001b[30;93H:\u001b[11;9H"]
[0.000, "o", "\u001b[30;93H\u001b[K\u001b[30;1H:\u001b[?25h"]
[0.175, "o", "w"]
[0.073, "o", "q"]
[0.048, "o", "\r"]
[0.000, "o", "\u001b[?25l\u001b[?2004l\u001b[>4;m"]
[0.000, "o", "\"pigsty.yml\""]
[0.002, "o", " 180L, 9816B written"]
[0.001, "o", "\r\u001b[23;2t\u001b[23;1t\r\r\n\u001b[?1004l\u001b[?2004l\u001b[?1l\u001b>\u001b[?1049l\u001b[23;0;0t\u001b[?25h\u001b[>4;m"]
[0.001, "o", "\u001b[?2004h\u001b]0;vonng@vonng-aimax: ~/pigsty\u0007\u001b[01;32mvonng@vonng-aimax\u001b[00m:\u001b[01;34m~/pigsty\u001b[00m$ "]
[1.392, "o", "b"]
[0.067, "o", "i"]
[0.068, "o", "n"]
[0.092, "o", "/"]
[0.256, "o", "p"]
[0.318, "o", "g"]
[0.189, "o", "s"]
[0.247, "o", "q"]
[0.042, "o", "l"]
[0.205, "o", "-"]
[0.146, "o", "s"]
[0.165, "o", "v"]
[0.254, "o", "c"]
[0.218, "o", " "]
[0.189, "o", "t"]
[0.129, "o", "e"]
[0.048, "o", "s"]
[0.063, "o", "t"]
[0.448, "o", "\b"]
[0.143, "o", "\b"]
[0.120, "o", "\b"]
[0.163, "o", "\b"]
[0.140, "o", "ptest\b\b\b\b"]
[0.114, "o", "gtest\b\b\b\b"]
[0.090, "o", "-test\b\b\b\b"]
[0.111, "o", "\r\n\u001b[?2004l\r"]
[0.005, "o", "\u001b[0;35m[EXECUTE] ===========================================\u001b[0m\r\n[\u001b[0;33mWARN\u001b[0m] \u001b[0;33mreload pgsql services for 'pg-test'\u001b[0m\r\n\u001b[0;34m$ ./pgsql.yml -l 'pg-test' -t pg_service\u001b[0m\r\n"]
[0.269, "o", "\r\nPLAY [PGSQL] ***********************************************************************************************************\r\n"]
[0.019, "o", "\r\nTASK [node_id : get node fact] *****************************************************************************************\r\n"]
[0.643, "o", "\u001b[0;33mchanged: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;33mchanged: [10.10.10.12]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : set node fact] *****************************************************************************************\r\n"]
[0.018, "o", "\u001b[0;32mok: [10.10.10.11]\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;32mok: [10.10.10.12]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : fill empty nodename with hostname] *********************************************************************\r\n"]
[0.016, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [node_id : build node identity] ***********************************************************************************\r\n"]
[0.022, "o", "\u001b[0;32mok: [10.10.10.11]\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;32mok: [10.10.10.12]\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [node_id : load roles/node_id/vars/u24.x86_64.yml] ****************************************************************\r\n"]
[0.016, "o", "\u001b[0;32mok: [10.10.10.12]\u001b[0m\r\n"]
[0.003, "o", "\u001b[0;32mok: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : fallback to u24.x86_64.yml if u24.x86_64.yml not exists] ***********************************************\r\n"]
[0.008, "o", "\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [node_id : print node identity] ***********************************************************************************\r\n"]
[0.018, "o", "\u001b[0;32mok: [10.10.10.11] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"nodename: pg-test-1, node_cluster: pg-test, spec: c4m8, os: ubuntu.24.x86_64 u24:deb,   [PGSQL: pg-test] [REDIS: redis-meta]    \"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;32mok: [10.10.10.12] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"nodename: pg-test-2, node_cluster: pg-test, spec: c4m8, os: ubuntu.24.x86_64 u24:deb,   [PGSQL: pg-test] [REDIS: redis-test]    \"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_id : get pgsql identity] **************************************************************************************\r\n"]
[0.090, "o", "\u001b[0;32mok: [10.10.10.12]\u001b[0m\r\n"]
[0.004, "o", "\u001b[0;32mok: [10.10.10.11]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pg_id : build pgsql identity] ************************************************************************************\r\n"]
[0.082, "o", "\u001b[0;32mok: [10.10.10.12]\u001b[0m\r\n"]
[0.002, "o", "\u001b[0;32mok: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pg_id : print pgsql identity] ************************************************************************************\r\n"]
[0.074, "o", "\u001b[0;32mok: [10.10.10.11] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"  [primary] pg-test-1 @ 10.10.10.11 , ins = pg-test-1 , cls = pg-test ,  CLUSTER LEADER @ pg-test-1    , postgres://10.10.10.11:5432/postgres\"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;32mok: [10.10.10.12] => {\u001b[0m\r\n\u001b[0;32m    \"msg\": \"  [replica] pg-test-2 @ 10.10.10.12 , ins = pg-test-2 , cls = pg-test , REPLICATE PRIMARY pg-test-1 @ 10.10.10.11 -> pg-test-2   , postgres://10.10.10.12:5432/postgres\"\u001b[0m\r\n\u001b[0;32m}\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pgsql : wipe existing postgres haproxy service from local haproxy] ***********************************************\r\n"]
[0.122, "o", "\u001b[0;33mchanged: [10.10.10.12]\u001b[0m\r\n"]
[0.003, "o", "\u001b[0;33mchanged: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pgsql : render haproxy service config on local haproxy] **********************************************************\r\n"]
[0.414, "o", "\u001b[0;33mchanged: [10.10.10.12] => (item={'name': 'primary', 'port': 5433, 'dest': 'default', 'check': '/primary', 'selector': '[]'})\u001b[0m\r\n"]
[0.002, "o", "\u001b[0;33mchanged: [10.10.10.11] => (item={'name': 'primary', 'port': 5433, 'dest': 'default', 'check': '/primary', 'selector': '[]'})\u001b[0m\r\n"]
[0.273, "o", "\u001b[0;33mchanged: [10.10.10.12] => (item={'name': 'replica', 'port': 5434, 'dest': 'default', 'check': '/read-only', 'selector': '[]', 'backup': '[? pg_role == `primary` || pg_role == `offline` ]'})\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;33mchanged: [10.10.10.11] => (item={'name': 'replica', 'port': 5434, 'dest': 'default', 'check': '/read-only', 'selector': '[]', 'backup': '[? pg_role == `primary` || pg_role == `offline` ]'})\u001b[0m\r\n"]
[0.268, "o", "\u001b[0;33mchanged: [10.10.10.11] => (item={'name': 'default', 'port': 5436, 'dest': 'postgres', 'check': '/primary', 'selector': '[]'})\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;33mchanged: [10.10.10.12] => (item={'name': 'default', 'port': 5436, 'dest': 'postgres', 'check': '/primary', 'selector': '[]'})\u001b[0m\r\n"]
[0.271, "o", "\u001b[0;33mchanged: [10.10.10.11] => (item={'name': 'offline', 'port': 5438, 'dest': 'postgres', 'check': '/replica', 'selector': '[? pg_role == `offline` || pg_offline_query ]', 'backup': '[? pg_role == `replica` && !pg_offline_query]'})\u001b[0m\r\n"]
[0.000, "o", "\u001b[0;33mchanged: [10.10.10.12] => (item={'name': 'offline', 'port': 5438, 'dest': 'postgres', 'check': '/replica', 'selector': '[? pg_role == `offline` || pg_offline_query ]', 'backup': '[? pg_role == `replica` && !pg_offline_query]'})\u001b[0m\r\n"]
[0.002, "o", "\r\nTASK [pgsql : check local haproxy config before reload] ****************************************************************\r\n"]
[0.165, "o", "\u001b[0;33mchanged: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;33mchanged: [10.10.10.12]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pgsql : reload local haproxy] ************************************************************************************\r\n"]
[0.591, "o", "\u001b[0;33mchanged: [10.10.10.12]\u001b[0m\r\n"]
[0.004, "o", "\u001b[0;33mchanged: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pgsql : wipe existing postgres service from remote haproxy] ******************************************************\r\n"]
[0.006, "o", "\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.002, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n"]
[0.001, "o", "\r\nTASK [pgsql : render haproxy service on remote haproxy] ****************************************************************\r\n"]
[0.006, "o", "\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.001, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pgsql : check remote haproxy config before reload] ***************************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.002, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n"]
[0.000, "o", "\r\nTASK [pgsql : reload remote haproxy] ***********************************************************************************\r\n"]
[0.005, "o", "\u001b[0;36mskipping: [10.10.10.11]\u001b[0m\r\n"]
[0.002, "o", "\u001b[0;36mskipping: [10.10.10.12]\u001b[0m\r\n"]
[0.004, "o", "\r\nPLAY RECAP *************************************************************************************************************\r\n"]
[0.000, "o", "\u001b[0;33m10.10.10.11\u001b[0m                : \u001b[0;32mok=12  \u001b[0m \u001b[0;33mchanged=5   \u001b[0m unreachable=0    failed=0    \u001b[0;36mskipped=6   \u001b[0m rescued=0    ignored=0   \r\n"]
[0.000, "o", "\u001b[0;33m10.10.10.12\u001b[0m                : \u001b[0;32mok=12  \u001b[0m \u001b[0;33mchanged=5   \u001b[0m unreachable=0    failed=0    \u001b[0;36mskipped=6   \u001b[0m rescued=0    ignored=0   \r\n\r\n"]
[0.051, "o", "\u001b[0;35m[SUMMARY] ===========================================\u001b[0m\r\n[\u001b[0;32m OK \u001b[0m] \u001b[0;32mreload pgsql services for pg-test complete!\u001b[0m\r\n\u001b[0;34mcheck haproxy admin page: http://i.pigsty/haproxy/pg-test-n/\u001b[0m\r\n"]
[0.000, "o", "\u001b[?2004h\u001b]0;vonng@vonng-aimax: ~/pigsty\u0007\u001b[01;32mvonng@vonng-aimax\u001b[00m:\u001b[01;34m~/pigsty\u001b[00m$ "]
[2.004, "o", "\u001b[?2004l\r\r\n"]
[0.000, "o", "exit\r\n"]
[0.001, "x", "0"]
